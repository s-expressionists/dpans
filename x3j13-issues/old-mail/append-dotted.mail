*start*03155 00024 USaReturn-Path: <@SAIL.STANFORD.EDU:KMP@STONY-BROOK.SCRC.Symbolics.COM>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.STANFORD.EDU by Xerox.COM ; 27 JUL 87 10:06:49 PDTReceived: from SCRC-STONY-BROOK.ARPA by SAIL.STANFORD.EDU with TCP; 27 Jul 87  10:05:12 PDTReceived: from RIO-DE-JANEIRO.SCRC.Symbolics.COM by STONY-BROOK.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 199647; Mon 27-Jul-87 13:02:54 EDTDate: Mon, 27 Jul 87 13:02 EDTFrom: Kent M Pitman <KMP@STONY-BROOK.SCRC.Symbolics.COM>Subject: APPEND-DOTTEDTo: CL-Cleanup@SAIL.STANFORD.EDUMessage-ID: <870727130240.6.KMP@RIO-DE-JANEIRO.SCRC.Symbolics.COM>Issue:        APPEND-DOTTEDReferences:   APPEND (p268)Category:     CHANGE/CLARIFICATIONEdit history: 27-Jul-87, Version 1 by PitmanStatus:	      For Internal DiscussionProblem Description:  The description of APPEND on p268 is not adequately clear on the issue of  what happens if an argument to APPEND is a dotted list.Proposal (APPEND-DOTTED:REPLACE):  Define that the cdr of the last cons in any but the last list given to  append is discarded (whether NIL or not) when constructing the new list.  Remove any text which suggests that (APPEND x '()) and (COPY-LIST x) are  the same, since these two might legitimately differ in situations involving  dotted lists. As such, deciding which to use is not just a stylistic issue.Test Case:  (APPEND '(A B C . D) '()) => (A B C)		;Proposed  [Note that (COPY-LIST '(A B C . D)) would still return (A B C . D).]Rationale:   This function is used a lot and its behavior should be well-defined across  implementations. This proposal upholds the apparent status quo in a number  of implementations.Current Practice:  Symbolics Lisp, Vaxlisp, and Lucid Lisp appear to implement the proposed  interpretation (at least in the interpreter).Adoption Cost:  Technically, the change should be relatively small for those  implementations which don't already implement it. However:  If there are any implementations which have microcoded APPEND incompatibly,  the small change may nevertheless be somewhat painful.  Some implementations may have optimized their APPEND to expect only NIL  when SAFETY is 0. In this case, depending on implementation details,   requiring an ATOM check rather than a NULL check may slow things down.Benefits:  Since non-lists are allowed as a last argument and since APPEND can  therefore produce dotted lists, some readers may have (incorrectly)  assumed that APPEND can reliably deal in general with dotted lists,   something that doesn't appear to be guaranteed by a strict reading. The  proposed extension would happen to legitimize such assumptions.Conversion Cost:  This change is "upward compatible".Aesthetics:  Whether or not users will think this improves the aesthetics of the  language will depend largely on how they view the relation between  lists and dotted lists. Those who view dotted lists as a special kind  of list may feel differently than those who view lists as a special  kind of dotted list.Discussion:  KMP supports the proposed extension.*start*00734 00024 US Return-Path: <@SAIL.STANFORD.EDU:FAHLMAN@C.CS.CMU.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.STANFORD.EDU by Xerox.COM ; 27 JUL 87 17:57:14 PDTReceived: from C.CS.CMU.EDU by SAIL.STANFORD.EDU with TCP; 27 Jul 87  17:54:08 PDTReceived: ID <FAHLMAN@C.CS.CMU.EDU>; Mon 27 Jul 87 20:54:00-EDTDate: Mon, 27 Jul 87 20:53 EDTMessage-ID: <FAHLMAN.12321826393.BABYL@C.CS.CMU.EDU>Sender: FAHLMAN@C.CS.CMU.EDUFrom: "Scott E. Fahlman" <Fahlman@C.CS.CMU.EDU>To: Kent M Pitman <KMP@SCRC-STONY-BROOK.ARPA>Cc: CL-Cleanup@SAIL.STANFORD.EDUSubject: APPEND-DOTTEDIn-reply-to: Msg of 27 Jul 1987  13:02-EDT from Kent M Pitman <KMP at STONY-BROOK.SCRC.Symbolics.COM>This looks good to me.-- Scott*start*00721 00024 US Return-Path: <@SAIL.STANFORD.EDU:Moon@STONY-BROOK.SCRC.Symbolics.COM>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.STANFORD.EDU by Xerox.COM ; 05 AUG 87 19:32:37 PDTReceived: from SCRC-STONY-BROOK.ARPA by SAIL.STANFORD.EDU with TCP; 5 Aug 87  19:30:53 PDTReceived: from EUPHRATES.SCRC.Symbolics.COM by STONY-BROOK.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 207665; Wed 5-Aug-87 21:35:47 EDTDate: Wed, 5 Aug 87 21:35 EDTFrom: David A. Moon <Moon@STONY-BROOK.SCRC.Symbolics.COM>Subject: APPEND-DOTTEDTo: CL-Cleanup@SAIL.STANFORD.EDUIn-Reply-To: <870727130240.6.KMP@RIO-DE-JANEIRO.SCRC.Symbolics.COM>Message-ID: <870805213544.6.MOON@EUPHRATES.SCRC.Symbolics.COM>I approve.*start*01189 00024 US Return-Path: <@SAIL.STANFORD.EDU:Masinter.pa@Xerox.COM>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.STANFORD.EDU by Xerox.COM ; 22 SEP 87 12:56:15 PDTReceived: from XEROX.COM by SAIL.STANFORD.EDU with TCP; 22 Sep 87  12:53:55 PDTReceived: from Cabernet.ms by ArpaGateway.ms ; 22 SEP 87 12:52:21 PDTDate: 22 Sep 87 12:52 PDTFrom: Masinter.paSubject: [remailed] Re: APPEND-DOTTEDIn-reply-to: Kent M Pitman <KMP@STONY-BROOK.SCRC.Symbolics.COM>'s message of Mon, 27 Jul 87 13:02 EDTTo: CL-Cleanup@SAIL.STANFORD.EDUline-fold: noMessage-ID: <870922-125221-12440@Xerox>(I'm *finally* back on CL-Cleanup related work; we must hustle to get stuff out for the meeting. Sorry.)In current practice, Xerox Common Lisp and Kyoto Common Lisp signal errors on the proposed test case (both interpreted and compiled.)There are notes in the ISSUES.TXT file:Page 268:The doc for APPEND should be clarified to warn the user that APPENDcan return a non-list, e.g. (append '() t) => t.Also, the doc for NCONC should be clarified so that NCONC behavesanalogously to APPEND when its last argument is an atom.Should this be added to this proposal?*start*04235 00024 USfReturn-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU by Xerox.COM ; 29 OCT 87 21:06:08 PSTReceived: from SCRC-STONY-BROOK.ARPA by SAIL.STANFORD.EDU with TCP; 29 Oct 87  21:02:09 PSTReceived: from RIO-DE-JANEIRO.SCRC.Symbolics.COM by STONY-BROOK.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 267934; Fri 30-Oct-87 00:02:04 ESTDate: Fri, 30 Oct 87 00:01 ESTFrom: Kent M Pitman <KMP@STONY-BROOK.SCRC.Symbolics.COM>Subject: APPEND-DOTTED (Version 2)To: CL-Cleanup@SAIL.STANFORD.EDUReferences: <870727130240.6.KMP@RIO-DE-JANEIRO.SCRC.Symbolics.COM>,            <870922-125221-12440@Xerox>Message-ID: <871030000121.1.KMP@RIO-DE-JANEIRO.SCRC.Symbolics.COM>I think this takes care of the loose ends for APPEND-DOTTED. * Added information about Kyoto CL and Xerox CL current practice. * Added discussion of (APPEND '() T). * Added parallel mention of NCONC.-----Issue:        APPEND-DOTTEDReferences:   APPEND (p268)Category:     CHANGE/CLARIFICATIONEdit history: 27-Jul-87, Version 1 by Pitman,	      29-Oct-87, Version 2 by Pitman (loose ends)Status:	      For Internal DiscussionProblem Description:  The description of APPEND on p268 is not adequately clear on the issue of  what happens if an argument to APPEND is a dotted list.Proposal (APPEND-DOTTED:REPLACE):  Define that the cdr of the last cons in any but the last list given to  APPEND or NCONC is discarded (whether NIL or not) when preparing the  list to be returned.  In the degenerate case where there is no last cons (i.e., the argument  is NIL) in any but the last list argument, clarify that the entire argument  is effectively ignored. Point out that in this situation, if the last  argument is a non-list, the result of APPEND or NCONC can be a non-list.  Remove any text which suggests that (APPEND x '()) and (COPY-LIST x) are  the same, since these two might legitimately differ in situations involving  dotted lists. As such, deciding which to use is not just a stylistic issue.Test Case:  (APPEND '(A B C . D) '())       => (A B C)	;Proposed  (NCONC (LIST* 'A 'B 'C 'D) '()) => (A B C)	;Proposed  Note that (COPY-LIST '(A B C . D)) would still return (A B C . D).  (APPEND '(A B . C) '() 3)       => (A B . 3)	;Proposed  (NCONC (LIST* 'A 'B 'C) '() 3)  => (A B . 3)	;Proposed  (APPEND '() 17)   => 17			;Proposed  (NCONC (LIST) 17) => 17			;ProposedRationale:   This function is used a lot and its behavior should be well-defined across  implementations. This proposal upholds the apparent status quo in a number  of implementations.Current Practice:  Symbolics Lisp, Vaxlisp, and Lucid Lisp appear to implement the proposed  interpretation (at least in the interpreter).  Xerox Common Lisp and Kyoto Common Lisp signal errors when using APPEND  or NCONC on a dotted list.Adoption Cost:  Technically, the change should be relatively small for those  implementations which don't already implement it. However:  If there are any implementations which have microcoded APPEND or NCONC  incompatibly, the small change may nevertheless be somewhat painful.  Some implementations may have optimized their APPEND or NCONC to expect  only NIL when SAFETY is 0. In this case, depending on implementation  details, requiring an ATOM check rather than a NULL check may slow  things down.Benefits:  Since non-lists are allowed as a last argument and since APPEND and   NCONC can therefore produce dotted lists, some readers may have  (incorrectly) assumed that APPEND and NCONC can reliably deal in  general with dotted lists, something that doesn't appear to be guaranteed  by a strict reading. The proposed extension would happen to legitimize  such assumptions.Conversion Cost:  This change is "upward compatible".Aesthetics:  Whether or not users will think this improves the aesthetics of the  language will depend largely on how they view the relation between  lists and dotted lists. Those who view dotted lists as a special kind  of list may feel differently than those who view lists as a special  kind of dotted list.Discussion:  Pitman supports the proposed extension.*start*00727 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU by Xerox.COM ; 29 OCT 87 22:05:38 PSTReceived: from C.CS.CMU.EDU by SAIL.STANFORD.EDU with TCP; 29 Oct 87  22:03:08 PSTReceived: ID <FAHLMAN@C.CS.CMU.EDU>; Fri 30 Oct 87 01:05:21-ESTDate: Fri, 30 Oct 87 01:05 ESTMessage-ID: <FAHLMAN.12346524608.BABYL@C.CS.CMU.EDU>Sender: FAHLMAN@C.CS.CMU.EDUFrom: "Scott E. Fahlman" <Fahlman@C.CS.CMU.EDU>To: Kent M Pitman <KMP@SCRC-STONY-BROOK.ARPA>Cc: CL-Cleanup@SAIL.STANFORD.EDUSubject: APPEND-DOTTED (Version 2)In-reply-to: Msg of 30 Oct 1987  00:01-EST from Kent M Pitman <KMP at STONY-BROOK.SCRC.Symbolics.COM>Looks fine to me.*start*00655 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU by Xerox.COM ; 30 OCT 87 11:19:44 PSTReceived: from XEROX.COM by SAIL.STANFORD.EDU with TCP; 30 Oct 87  11:16:39 PSTReceived: from Cabernet.ms by ArpaGateway.ms ; 30 OCT 87 11:17:16 PSTDate: 30 Oct 87 11:16 PSTFrom: Daniels.paSubject: Re: APPEND-DOTTED (Version 2)In-reply-to: Kent M Pitman <KMP@STONY-BROOK.SCRC.Symbolics.COM>'s message of Fri, 30 Oct 87 00:01 ESTTo: KMP@STONY-BROOK.SCRC.Symbolics.COMcc: CL-Cleanup@SAIL.STANFORD.EDUMessage-ID: <871030-111716-5825@Xerox>Looks OK.		-- Andy. --*start*00781 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU by Xerox.COM ; 30 OCT 87 12:09:07 PSTReceived: from SCRC-STONY-BROOK.ARPA by SAIL.STANFORD.EDU with TCP; 30 Oct 87  12:06:41 PSTReceived: from EUPHRATES.SCRC.Symbolics.COM by STONY-BROOK.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 268580; Fri 30-Oct-87 15:07:12 ESTDate: Fri, 30 Oct 87 15:07 ESTFrom: David A. Moon <Moon@STONY-BROOK.SCRC.Symbolics.COM>Subject: APPEND-DOTTED (Version 2)To: Kent M Pitman <KMP@STONY-BROOK.SCRC.Symbolics.COM>cc: CL-Cleanup@SAIL.STANFORD.EDUIn-Reply-To: <871030000121.1.KMP@RIO-DE-JANEIRO.SCRC.Symbolics.COM>Message-ID: <19871030200707.6.MOON@EUPHRATES.SCRC.Symbolics.COM>Looks fine to me.*start*03791 00024 USfDate: 14 Nov 87 15:38 PSTFrom: Masinter.pato: cl-cleanup@Sail.stanford.educc: MasinterSubject: Issue: APPEND-DOTTED (Version 3)I fixed a nit in current practice, added an endorsement, and formatted for release. This issue had somehow gotten dropped from the list of open issues. The only mail after the last note were several "looks OK" messages. I think this issue is ready for release.Issue:        APPEND-DOTTEDReferences:   APPEND (p268)Category:     CHANGE/CLARIFICATIONEdit history: 27-Jul-87, Version 1 by Pitman              29-Oct-87, Version 2 by Pitman (loose ends)              14-Nov-87, Version 3 by MasinterProblem Description:The description of APPEND on p268 is not adequately clear on the issue of what happens if an argument to APPEND is a dotted list.Proposal (APPEND-DOTTED:REPLACE):Define that the cdr of the last cons in any but the last list given to APPEND or NCONC is discarded (whether NIL or not) when preparing the list to be returned.In the degenerate case where there is no last cons (i.e., the argument is NIL) in any but the last list argument, clarify that the entire argument is effectively ignored. Point out that in this situation, if the last argument is a non-list, the result of APPEND or NCONC can be a non-list.Remove any text which suggests that (APPEND x '()) and (COPY-LIST x) are the same, since these two might legitimately differ in situations involving dotted lists. As such, deciding which to use is not just a stylistic issue.Test Case:(APPEND '(A B C . D) '())       => (A B C)	;Proposed(NCONC (LIST* 'A 'B 'C 'D) '()) => (A B C)	;ProposedNote that (COPY-LIST '(A B C . D)) would still return (A B C . D).(APPEND '(A B . C) '() 3)       => (A B . 3)	;Proposed(NCONC (LIST* 'A 'B 'C) '() 3)  => (A B . 3)	;Proposed(APPEND '() 17)   => 17			;Proposed(NCONC (LIST) 17) => 17			;ProposedRationale: This function is used a lot and its behavior should be well-defined across implementations. This proposal upholds the apparent status quo in a number of implementations.Current Practice:Symbolics Lisp, Vaxlisp, and Lucid Lisp appear to implement the proposed interpretation (at least in the interpreter).Kyoto Common Lisp signal an error when using APPEND or NCONC on a dotted list. Xerox Common Lisp signals an error on APPEND and implements the proposed interpretation on NCONC.Adoption Cost:Technically, the change should be relatively small for those implementations which don't already implement it. However:If there are any implementations which have microcoded APPEND or NCONC incompatibly, the small change may nevertheless be somewhat painful.Some implementations may have optimized their APPEND or NCONC to expect only NIL when SAFETY is 0. In this case, depending on implementation details, requiring an ATOM check rather than a NULL check may slow things down.Benefits:Since non-lists are allowed as a last argument and since APPEND and  NCONC can therefore produce dotted lists, some readers may have (incorrectly) assumed that APPEND and NCONC can reliably deal in general with dotted lists, something that doesn't appear to be guaranteed by a strict reading. The proposed extension would happen to legitimize such assumptions.Conversion Cost:This change is upward compatible.Aesthetics:Whether or not users will think this improves the aesthetics of the language will depend largely on how they view the relation between lists and dotted lists. Those who view dotted lists as a special kind of list may feel differently than those who view lists as a special kind of dotted list.Discussion:The cleanup committee supports this extension.TITANTITAN‹‰„"¨h®+åk$(2^zº*start*04051 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU by Xerox.COM ; 14 NOV 87 15:41:57 PSTReceived: from XEROX.COM by SAIL.STANFORD.EDU with TCP; 14 Nov 87  15:39:23 PSTReceived: from Cabernet.ms by ArpaGateway.ms ; 14 NOV 87 15:39:03 PSTDate: 14 Nov 87 15:38 PSTFrom: Masinter.pato: cl-cleanup@Sail.stanford.educc: Masinter.paSubject: Issue: APPEND-DOTTED (Version 3)Message-ID: <871114-153903-3484@Xerox>I fixed a nit in current practice, added an endorsement, and formattedfor release. This issue had somehow gotten dropped from the list of openissues. The only mail after the last note were several "looks OK"messages. I think this issue is ready for release.!Issue:        APPEND-DOTTEDReferences:   APPEND (p268)Category:     CHANGE/CLARIFICATIONEdit history: 27-Jul-87, Version 1 by Pitman              29-Oct-87, Version 2 by Pitman (loose ends)              14-Nov-87, Version 3 by MasinterProblem Description:The description of APPEND on p268 is not adequately clear on the issueof what happens if an argument to APPEND is a dotted list.Proposal (APPEND-DOTTED:REPLACE):Define that the cdr of the last cons in any but the last list given toAPPEND or NCONC is discarded (whether NIL or not) when preparing thelist to be returned.In the degenerate case where there is no last cons (i.e., the argumentis NIL) in any but the last list argument, clarify that the entireargument is effectively ignored. Point out that in this situation, ifthe last argument is a non-list, the result of APPEND or NCONC can be anon-list.Remove any text which suggests that (APPEND x '()) and (COPY-LIST x) arethe same, since these two might legitimately differ in situationsinvolving dotted lists. As such, deciding which to use is not just astylistic issue.Test Case:(APPEND '(A B C . D) '())       => (A B C)	;Proposed(NCONC (LIST* 'A 'B 'C 'D) '()) => (A B C)	;ProposedNote that (COPY-LIST '(A B C . D)) would still return (A B C . D).(APPEND '(A B . C) '() 3)       => (A B . 3)	;Proposed(NCONC (LIST* 'A 'B 'C) '() 3)  => (A B . 3)	;Proposed(APPEND '() 17)   => 17			;Proposed(NCONC (LIST) 17) => 17			;ProposedRationale: This function is used a lot and its behavior should be well-definedacross implementations. This proposal upholds the apparent status quo ina number of implementations.Current Practice:Symbolics Lisp, Vaxlisp, and Lucid Lisp appear to implement the proposedinterpretation (at least in the interpreter).Kyoto Common Lisp signal an error when using APPEND or NCONC on a dottedlist. Xerox Common Lisp signals an error on APPEND and implements theproposed interpretation on NCONC.Adoption Cost:Technically, the change should be relatively small for thoseimplementations which don't already implement it. However:If there are any implementations which have microcoded APPEND or NCONCincompatibly, the small change may nevertheless be somewhat painful.Some implementations may have optimized their APPEND or NCONC to expectonly NIL when SAFETY is 0. In this case, depending on implementationdetails, requiring an ATOM check rather than a NULL check may slowthings down.Benefits:Since non-lists are allowed as a last argument and since APPEND andNCONC can therefore produce dotted lists, some readers may have(incorrectly) assumed that APPEND and NCONC can reliably deal in generalwith dotted lists, something that doesn't appear to be guaranteed by astrict reading. The proposed extension would happen to legitimize suchassumptions.Conversion Cost:This change is upward compatible.Aesthetics:Whether or not users will think this improves the aesthetics of thelanguage will depend largely on how they view the relation between listsand dotted lists. Those who view dotted lists as a special kind of listmay feel differently than those who view lists as a special kind ofdotted list.Discussion:The cleanup committee supports this extension.*start*04368 00024 US Date: 23 Nov 87 12:26 PSTFrom: Masinter.pato: cl-cleanup@Sail.stanford.educc: MasinterSubject: Issue: APPEND-DOTTED (Version 4)<Supercedes previous message; the version number wasn't in the proposal although in the Subject line.>At X3J13, Bekerly (sp?) expressed some concern that APPEND might in some circumstances return a non-list. I quoted more extensively from CLtL so that it would be more obvious that this was the only reasonable clarification that was compatible with the current description.Issue:        APPEND-DOTTEDReferences:   APPEND (p268)Category:     CHANGE/CLARIFICATIONEdit history: 27-Jul-87, Version 1 by Pitman              29-Oct-87, Version 2 by Pitman (loose ends)              14-Nov-87, Version 3 by Masinter              23-Nov-87, Version 4 by MasinterProblem Description:The description of APPEND on p268 is not adequately clear on the issue of what happens if an argument to APPEND is a dotted list. The only case explicitly mentioned is the last argument, viz:"The last argument [to APPEND] actually need not be a list but may be any LISP object, which becomes the tail end of the constructed list. For example, (append '(a b c) 'd) => (a b c . d)."While this specifies the behavior of APPEND when the last argument is not a list, the behavior when any of the other arguments are not lists.Proposal (APPEND-DOTTED:REPLACE):Define that the cdr of the last cons in any but the last argument given to APPEND or NCONC is discarded (whether NIL or not) when preparing the list to be returned.In the degenerate case where there is no last cons (i.e., the argument is NIL) in any but the last list argument, clarify that the entire argument is effectively ignored. Point out that in this situation, if the last argument is a non-list, the result of APPEND or NCONC can be a non-list.Remove any text which suggests that (APPEND x '()) and (COPY-LIST x) are the same, since these two might legitimately differ in situations involving dotted lists. As such, deciding which to use is not just a stylistic issue.Examples:(APPEND '(A B C . D) '())       => (A B C)	;Proposed(NCONC (LIST* 'A 'B 'C 'D) '()) => (A B C)	;ProposedNote that (COPY-LIST '(A B C . D)) would still return (A B C . D).(APPEND '(A B . C) '() 3)       => (A B . 3)	;Proposed(NCONC (LIST* 'A 'B 'C) '() 3)  => (A B . 3)	;Proposed(APPEND '() 17)   => 17			;Proposed(NCONC (LIST) 17) => 17			;ProposedRationale: This function is used a lot and its behavior should be well-defined across implementations. This proposal upholds the apparent status quo in a number of implementations.Current Practice:Symbolics Lisp, Vaxlisp, and Lucid Lisp appear to implement the proposed interpretation (at least in the interpreter).Kyoto Common Lisp signal an error when using APPEND or NCONC on a dotted list. Xerox Common Lisp signals an error on APPEND and implements the proposed interpretation on NCONC.Cost to implementors:Technically, the change should be relatively small for those implementations which don't already implement it. However:If there are any implementations which have microcoded APPEND or NCONC incompatibly, the small change may nevertheless be somewhat painful.Some implementations may have optimized their APPEND or NCONC to expect only NIL when SAFETY is 0. In this case, depending on implementation details, requiring an ATOM check rather than a NULL check may slow things down.Cost to users:This change is upward compatible.Benefits:Since non-lists are allowed as a last argument and since APPEND and  NCONC can therefore produce dotted lists, some readers may have (incorrectly) assumed that APPEND and NCONC can reliably deal in general with dotted lists, something that doesn't appear to be guaranteed by a strict reading. The proposed extension would happen to legitimize such assumptions.Aesthetics:Whether or not users will think this improves the aesthetics of the language will depend largely on how they view the relation between lists and dotted lists. Those who view dotted lists as a special kind of list may feel differently than those who view lists as a special kind of dotted list.Discussion:The cleanup committee supports this proposal.TITANTITANTIMESROMANÿ¸"¬h¬+å$k(0‘zº*start*00900 00024 US Return-Path: <franz!akbar!layer@ucbarpa.Berkeley.EDU>Received: from ucbarpa.Berkeley.EDU by Xerox.COM ; 23 NOV 87 14:18:00 PSTReceived: by ucbarpa.Berkeley.EDU (5.58/1.25)	id AA11723; Mon, 23 Nov 87 14:18:08 PSTReceived: from akbar by franz (5.5/3.14)	id AA03067; Mon, 23 Nov 87 14:03:51 PSTReceived: by akbar (5.5/3.14)	id AA02970; Mon, 23 Nov 87 14:00:39 PSTFrom: franz!akbar!layer@ucbarpa.Berkeley.EDU (Kevin Layer)Return-Path: <akbar!layer>Message-Id: <8711232200.AA02970@akbar>To: Masinter.paSubject: Re: Issue: APPEND-DOTTED (Version 4) In-Reply-To: Your message of 23 Nov 87 12:26:00 PST.             <871123-122650-2514@Xerox> Date: Mon, 23 Nov 87 14:00:38 PSTAs for Franz's Allegro Common Lisp current practice, we conform to theproposed behaviour, except in the case of:	(NCONC (LIST) 17) => 17			;Proposedwhere we return `nil' instead of 17.*start*00978 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU by Xerox.COM ; 23 NOV 87 18:16:59 PSTReceived: from SCRC-STONY-BROOK.ARPA by SAIL.STANFORD.EDU with TCP; 23 Nov 87  18:15:17 PSTReceived: from EUPHRATES.SCRC.Symbolics.COM by STONY-BROOK.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 287393; Mon 23-Nov-87 21:14:56 ESTDate: Mon, 23 Nov 87 21:14 ESTFrom: David A. Moon <Moon@STONY-BROOK.SCRC.Symbolics.COM>Subject: Issue: APPEND-DOTTED (Version 4)To: cl-cleanup@SAIL.STANFORD.EDUIn-Reply-To: <871123-122650-2514@Xerox>Message-ID: <19871124021458.4.MOON@EUPHRATES.SCRC.Symbolics.COM>  Bekerly(sp?)That's Baeckerle I believe.Typo in Problem Description:  While this specifies the behavior of APPEND when the last argument is  not a list, the behavior when any of the other arguments are not lists.is not a sentence.  Needs "is unspecified" at the end?Otherwise okay.*start*00734 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU by Xerox.COM ; 02 DEC 87 15:32:12 PSTReceived: from THINK.COM by SAIL.STANFORD.EDU with TCP; 2 Dec 87  14:20:51 PSTReturn-Path: <gls@Think.COM>Received: from kali.think.com by Think.COM; Wed, 2 Dec 87 17:20:07 ESTReceived: by kali.think.com; Wed, 2 Dec 87 17:20:03 ESTDate: Wed, 2 Dec 87 17:20:03 ESTFrom: gls@Think.COMMessage-Id: <8712022220.AA04837@kali.think.com>To: cl-cleanup@sail.stanford.eduIn-Reply-To: Masinter.pa@xerox.com's message of 23 Nov 87 12:25 PST <871123-122535-2508@Xerox>Subject: Issue: APPEND-DOTTED (Version 4)I support APPEND-DOTTED:REPLACE, version 4.*start*04829 00024 US Date:  3 Feb 89 22:06 PSTFrom: masinter.paSubject: Issue: APPEND-DOTTED (Version 5)To: cl-cleanup@sail.stanford.educc: masinter.paThis issue was withdrawn, along with the ones it spawned: APPEND-ATOM and BACKQUOTE-ATOM-ATSIGN-DOT. At the time, I believe I said we would consider whether we wanted to submit a more comprehensive set of proposals that would address all of the issues simultaneously.I personally have no desire to do so.I believe that the sentence Problem Description that claims that CLtL is not adequately clear is incorrect, namely, that elsewhere in CLtL it states that if an argument is supposed to be a LIST, it means a PROPER LIST unless otherwise stated. In the case of APPEND, the only case that otherwise states so is the last argument, and thus, CLtL does specify that it "is an error" to pass an atom or a dotted list to APPEND as any argument except the last.Issue:        APPEND-DOTTEDReferences:   APPEND (p268)Category:     CHANGE/CLARIFICATIONEdit history: 27-Jul-87, Version 1 by Pitman              29-Oct-87, Version 2 by Pitman (loose ends)              14-Nov-87, Version 3 by Masinter              23-Nov-87, Version 4 by Masinter              14-Jan-88, Version 5 by MasinterProblem Description:The description of APPEND on p268 is not adequately clear on the issue of what happens if an argument to APPEND is a dotted list. The only case explicitly mentioned is the last argument, viz:"The last argument [to APPEND] actually need not be a list but may be any LISP object, which becomes the tail end of the constructed list. For example, (append '(a b c) 'd) => (a b c . d)."While this specifies the behavior of APPEND when the last argument is not a list, the behavior when any of the other arguments are not lists is not specified.Proposal (APPEND-DOTTED:REPLACE):Define that the cdr of the last cons in any but the last argument given to APPEND or NCONC is discarded (whether NIL or not) when preparing the list to be returned.In the degenerate case where there is no last cons (i.e., the argument is NIL) in any but the last list argument, clarify that the entire argument is effectively ignored. Point out that in this situation, if the last argument is a non-list, the result of APPEND or NCONC can be a non-list.Remove any text which suggests that (APPEND x '()) and (COPY-LIST x) are the same, since these two might legitimately differ in situations involving dotted lists. As such, deciding which to use is not just a stylistic issue.Examples:(APPEND '(A B C . D) '())       => (A B C)	;Proposed(NCONC (LIST* 'A 'B 'C 'D) '()) => (A B C)	;ProposedNote that (COPY-LIST '(A B C . D)) would still return (A B C . D).(APPEND '(A B . C) '() 3)       => (A B . 3)	;Proposed(NCONC (LIST* 'A 'B 'C) '() 3)  => (A B . 3)	;Proposed(APPEND '() 17)   => 17			;Proposed(NCONC (LIST) 17) => 17			;ProposedRationale: This function is used a lot and its behavior should be well-defined across implementations. This proposal upholds the apparent status quo in a number of implementations.Current Practice:Symbolics Lisp, Vaxlisp, and Lucid Lisp appear to implement the proposed interpretation (at least in the interpreter). Franz's Allegro Common Lisp conforms to the proposed behavior except in the case of (NCONC (LIST) 17) => 17, where it returns NIL instead of 17.Kyoto Common Lisp signal an error when using APPEND or NCONC on a dotted list. Xerox Common Lisp signals an error on APPEND and implements the proposed interpretation on NCONC.Cost to implementors:Technically, the change should be relatively small for those implementations which don't already implement it. However, implementations which have microcoded APPEND or NCONC incompatibly may find the small change somewhat painful.Some implementations may have optimized their APPEND or NCONC to expect only NIL when SAFETY is 0. In this case, depending on implementation details, requiring an ATOM check rather than a NULL check may slow things down.Cost to users:This change is upward compatible.Benefits:Since non-lists are allowed as a last argument and since APPEND and NCONC can therefore produce dotted lists, some readers may have (incorrectly) assumed that APPEND and NCONC can reliably deal in general with dotted lists, something that doesn't appear to be guaranteed by a strict reading. The proposed extension would happen to legitimize such assumptions.Aesthetics:Whether or not users will think this improves the aesthetics of the language will depend largely on how they view the relation between lists and dotted lists. Those who view dotted lists as a special kind of list may feel differently than those who view lists as a special kind of dotted list.Discussion:The cleanup committee supports this proposal.*start*05191 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 03 FEB 89 22:11:00 PSTReceived: from Xerox.COM by SAIL.Stanford.EDU with TCP; 3 Feb 89  22:10:49 PSTReceived: from Semillon.ms by ArpaGateway.ms ; 03 FEB 89 22:08:43 PSTDate: 3 Feb 89 22:06 PSTFrom: masinter.paSubject: Issue: APPEND-DOTTED (Version 5)To: cl-cleanup@sail.stanford.educc: masinter.paMessage-ID: <890203-220843-2771@Xerox>This issue was withdrawn, along with the ones it spawned: APPEND-ATOM andBACKQUOTE-ATOM-ATSIGN-DOT. At the time, I believe I said we would consider whether we wanted to submita more comprehensive set of proposals that would address all of the issuessimultaneously.I personally have no desire to do so.I believe that the sentence Problem Description that claims that CLtL isnot adequately clear is incorrect, namely, that elsewhere in CLtL it statesthat if an argument is supposed to be a LIST, it means a PROPER LIST unlessotherwise stated. In the case of APPEND, the only case that otherwisestates so is the last argument, and thus, CLtL does specify that it "is anerror" to pass an atom or a dotted list to APPEND as any argument exceptthe last.!Issue:        APPEND-DOTTEDReferences:   APPEND (p268)Category:     CHANGE/CLARIFICATIONEdit history: 27-Jul-87, Version 1 by Pitman              29-Oct-87, Version 2 by Pitman (loose ends)              14-Nov-87, Version 3 by Masinter              23-Nov-87, Version 4 by Masinter              14-Jan-88, Version 5 by MasinterProblem Description:The description of APPEND on p268 is not adequately clear on the issue ofwhat happens if an argument to APPEND is a dotted list. The only caseexplicitly mentioned is the last argument, viz:"The last argument [to APPEND] actually need not be a list but may be anyLISP object, which becomes the tail end of the constructed list. Forexample, (append '(a b c) 'd) => (a b c . d)."While this specifies the behavior of APPEND when the last argument is not alist, the behavior when any of the other arguments are not lists is notspecified.Proposal (APPEND-DOTTED:REPLACE):Define that the cdr of the last cons in any but the last argument given toAPPEND or NCONC is discarded (whether NIL or not) when preparing the listto be returned.In the degenerate case where there is no last cons (i.e., the argument isNIL) in any but the last list argument, clarify that the entire argument iseffectively ignored. Point out that in this situation, if the last argumentis a non-list, the result of APPEND or NCONC can be a non-list.Remove any text which suggests that (APPEND x '()) and (COPY-LIST x) arethe same, since these two might legitimately differ in situations involvingdotted lists. As such, deciding which to use is not just a stylistic issue.Examples:(APPEND '(A B C . D) '())       => (A B C)	;Proposed(NCONC (LIST* 'A 'B 'C 'D) '()) => (A B C)	;ProposedNote that (COPY-LIST '(A B C . D)) would still return (A B C . D).(APPEND '(A B . C) '() 3)       => (A B . 3)	;Proposed(NCONC (LIST* 'A 'B 'C) '() 3)  => (A B . 3)	;Proposed(APPEND '() 17)   => 17			;Proposed(NCONC (LIST) 17) => 17			;ProposedRationale: This function is used a lot and its behavior should be well-defined acrossimplementations. This proposal upholds the apparent status quo in a numberof implementations.Current Practice:Symbolics Lisp, Vaxlisp, and Lucid Lisp appear to implement the proposedinterpretation (at least in the interpreter). Franz's Allegro Common Lispconforms to the proposed behavior except in the case of (NCONC (LIST) 17)=> 17, where it returns NIL instead of 17.Kyoto Common Lisp signal an error when using APPEND or NCONC on a dottedlist. Xerox Common Lisp signals an error on APPEND and implements theproposed interpretation on NCONC.Cost to implementors:Technically, the change should be relatively small for thoseimplementations which don't already implement it. However, implementationswhich have microcoded APPEND or NCONC incompatibly may find the smallchange somewhat painful.Some implementations may have optimized their APPEND or NCONC to expectonly NIL when SAFETY is 0. In this case, depending on implementationdetails, requiring an ATOM check rather than a NULL check may slow thingsdown.Cost to users:This change is upward compatible.Benefits:Since non-lists are allowed as a last argument and since APPEND and NCONCcan therefore produce dotted lists, some readers may have (incorrectly)assumed that APPEND and NCONC can reliably deal in general with dottedlists, something that doesn't appear to be guaranteed by a strict reading.The proposed extension would happen to legitimize such assumptions.Aesthetics:Whether or not users will think this improves the aesthetics of thelanguage will depend largely on how they view the relation between listsand dotted lists. Those who view dotted lists as a special kind of list mayfeel differently than those who view lists as a special kind of dottedlist.Discussion:The cleanup committee supports this proposal.*start*00542 00024 US Date:  3 Feb 89 22:15 PSTFrom: masinter.paSubject: Re: Issue: APPEND-DOTTED (Version 5)In-reply-to: masinter.pa's message of 3 Feb 89 22:06 PSTTo: masinter.pacc: cl-cleanup@sail.stanford.eduI had forgotten and misplaced the mail that KMP sent (during the last flurry) titled APPEND-FIASCO.  It certainly lays out the proposals & alternatives in some detail.Nevertheless, I'm concerned that we don't have time to really examine the ramifications, and that we need not and probably shouldn't pursue this now.*start*00903 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 03 FEB 89 22:17:36 PSTReceived: from Xerox.COM by SAIL.Stanford.EDU with TCP; 3 Feb 89  22:18:01 PSTReceived: from Cabernet.ms by ArpaGateway.ms ; 03 FEB 89 22:15:40 PSTDate: 3 Feb 89 22:15 PSTFrom: masinter.paSubject: Re: Issue: APPEND-DOTTED (Version 5)In-reply-to: masinter.pa's message of 3 Feb 89 22:06 PSTTo: masinter.pacc: cl-cleanup@sail.stanford.eduMessage-ID: <890203-221540-2781@Xerox>I had forgotten and misplaced the mail that KMP sent (during the lastflurry) titled APPEND-FIASCO.  It certainly lays out the proposals &alternatives in some detail.Nevertheless, I'm concerned that we don't have time to really examine theramifications, and that we need not and probably shouldn't pursue this now.