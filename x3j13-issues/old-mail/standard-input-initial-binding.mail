*start*03738 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU by Xerox.COM ; 19 JAN 88 15:42:00 PSTReceived: from multimax.ARPA by SAIL.Stanford.EDU with TCP; 19 Jan 88  15:38:50 PSTReceived:  by multimax.ARPA (5.51/25-eef)	id AA02319; Tue, 19 Jan 88 18:38:04 ESTReceived: from localhost by mist.UUCP (3.2/4.7)	id AA20676; Tue, 19 Jan 88 18:39:06 ESTMessage-Id: <8801192339.AA20676@mist.UUCP>To: cl-cleanup%sail.stanford.edu@multimax.ARPACc: franz!smh%berkeley.edu@multimax.ARPASubject: Issue: STANDARD-INPUT-INITIAL-BINDING (version 1)Date: Tue, 19 Jan 88 18:39:04 ESTFrom: Dan L. Pierson <pierson@mist.ARPA>Issue:         STANDARD-INPUT-INITIAL-BINDINGReferences:    Standard streams (pp. 327-329)Category:      CHANGEEdit history:  Version 1 by Pierson and Haflich 1/19/87Status:        For Internal DiscussionProblem description:CLtL requires that *STANDARD-INPUT*, *STANDARD-OUTPUT*,*ERROR-OUTPUT*, *TRACE-OUTPUT*, *QUERY-IO*, and *DEBUG-IO* areinitially bound to synonym streams to *TERMINAL-IO*.  This requirementhampers the integration of Common Lisp with operating systems such asUnix which support input-output redirection.  Proposal (STANDARD-INPUT-INITIAL-BINDING:TERMINAL-IO-OPTIONAL):The initial bindings of *STANDARD-INPUT*, *STANDARD-OUTPUT*,*ERROR-OUTPUT*, *TRACE-OUTPUT*, *QUERY-IO*, *DEBUG-IO*, and*TERMINAL-IO* are undefined.  Implementors are encouraged to make themall refer to the user's console (possibly via *TERMINAL-IO*) if itmakes sense in the current invocation of Common Lisp.Test Cases/Examples:A Unix implementation is currently unable to legally support standarderror output even though Common Lisp defines *ERROR-OUTPUT* because*ERROR-OUTPUT* is required to start out bound to the same stream as*STANDARD-OUTPUT*.A workstation environnment which provides stream access to windows asan extension is currently forbidden to make trace output appear in aseparate window by default.Rationale:The language is CLtL prevents implementations from doing sensiblethings.Current practice:Lucid binds *TERMINAL-IO* to a special internal stream type.  Franzbinds *TERMINAL-IO* to a special internal stream type for terminalstreams which reads from Unix standard input and writes to Unixstandard output.  KCL binds *TERMINAL-IO* to a standard two-way-streamwith input from Unix standard input and output to Unix standardoutput.Cost to Implementors:None required, implementors would be given more freedom to tailortheir implementations to the target harware and operating system.Cost to Users:No direct costs because this proposal doesn't require anyimplementation to change.Cost of non-Adoption:Many implementations will have to continue to choose betweenconforming to the standard and providing a superior user environment.Benefits:Implementations will be more able to match their IO behavior to theirenvironment and their user's expectations.  Aesthetics:While the aesthetics of the language won't change much, the aestheticsof environments would be allowed to improve.Discussion:This proposal carefully tries not to answer questions like thefollowing: When is and isn't real access to the terminal via*TERMINAL-IO* desired?  It certainly isn't for batch programs.  ForUnix which of different std{in,out,err} is *TERMINAL-IO* bound to?The KCL binding of *TERMINAL-IO* is a stream with no associatedpathname(s).  CLtL makes this more likely than not, which is not agood thing in the Unix environment.  Do we need another proposal todetermine stream types and access components of two-way streams?  DoesSTREAM-CLASS-ACCESS cover this area?*start*00806 00024 US Return-Path: <@multimax.ARPA:pierson@mist>Received: from multimax.ARPA by Xerox.COM ; 15 JAN 88 08:08:48 PSTReceived:  by multimax.ARPA (5.51/25-eef)	id AA10829; Fri, 15 Jan 88 11:12:33 ESTReceived: from localhost by mist.UUCP (3.2/4.7)	id AA24767; Fri, 15 Jan 88 11:09:33 ESTMessage-Id: <8801151609.AA24767@mist.UUCP>To: masinter.pa%xerox.com@multimax.ARPASubject: STANDARD-INPUT-INITIAL-BINDINGDate: Fri, 15 Jan 88 11:09:31 ESTFrom: Dan L. Pierson <pierson@mist.ARPA>I've volunteered to do this in November.  A draft was sent to SteveHaflich for review in early December because he said that he wanted tobe involved.  I'll call him today and submit it to the whole committeesoon unless he has very good objections.                                            dan*start*01585 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU by Xerox.COM ; 08 FEB 88 10:44:32 PSTReceived: from STONY-BROOK.SCRC.Symbolics.COM (SCRC-STONY-BROOK.ARPA) by SAIL.Stanford.EDU with TCP; 8 Feb 88  10:42:44 PSTReceived: from EUPHRATES.SCRC.Symbolics.COM by STONY-BROOK.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 338725; Mon 8-Feb-88 13:41:39 ESTDate: Mon, 8 Feb 88 13:41 ESTFrom: David A. Moon <Moon@STONY-BROOK.SCRC.Symbolics.COM>Subject: Issue: STANDARD-INPUT-INITIAL-BINDING (version 1)To: Kent M Pitman <KMP@STONY-BROOK.SCRC.Symbolics.COM>cc: pierson@MULTIMAX.ARPA, CL-Cleanup@SAIL.STANFORD.EDU, franz!smh@BERKELEY.EDUIn-Reply-To: <880208133005.2.KMP@RIO-DE-JANEIRO.SCRC.Symbolics.COM>Message-ID: <19880208184148.7.MOON@EUPHRATES.SCRC.Symbolics.COM>Kent, I agree with your comments, however you did not address yourselfto the issue that Unix requires *STANDARD-OUTPUT* and *ERROR-OUTPUT* togo to different output destinations, while Common Lisp requires*STANDARD-OUTPUT* and *ERROR-OUTPUT* to be initially bound to synonymsfor the same stream.I don't know precisely what the "correct fix" to Common Lisp is here, butI don't think it involves either making all the stream variables' bindingsinitially undefined, nor leaving all but *TERMINAL-IO* defined to besynonym streams to *TERMINAL-IO*.  Maybe the variables should be definedin terms of their contracts rather than their implementations.I think the proposal needs another iteration based on a new idea.*start*03245 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU by Xerox.COM ; 08 FEB 88 11:14:45 PSTReceived: from STONY-BROOK.SCRC.Symbolics.COM (SCRC-STONY-BROOK.ARPA) by SAIL.Stanford.EDU with TCP; 8 Feb 88  11:12:12 PSTReceived: from RIO-DE-JANEIRO.SCRC.Symbolics.COM by STONY-BROOK.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 338778; Mon 8-Feb-88 14:10:25 ESTDate: Mon, 8 Feb 88 14:10 ESTFrom: Kent M Pitman <KMP@STONY-BROOK.SCRC.Symbolics.COM>Subject: Issue: STANDARD-INPUT-INITIAL-BINDING (version 1)To: Moon@STONY-BROOK.SCRC.Symbolics.COMcc: KMP@STONY-BROOK.SCRC.Symbolics.COM, pierson@MULTIMAX.ARPA, CL-Cleanup@SAIL.STANFORD.EDU, franz!smh@BERKELEY.EDUIn-Reply-To: <19880208184148.7.MOON@EUPHRATES.SCRC.Symbolics.COM>Message-ID: <880208141018.7.KMP@RIO-DE-JANEIRO.SCRC.Symbolics.COM>    Date: Mon, 8 Feb 88 13:41 EST    From: David A. Moon <Moon@STONY-BROOK.SCRC.Symbolics.COM>    Kent, I agree with your comments, however you did not address yourself    to the issue that Unix requires *STANDARD-OUTPUT* and *ERROR-OUTPUT* to    go to different output destinations, while Common Lisp requires    *STANDARD-OUTPUT* and *ERROR-OUTPUT* to be initially bound to synonyms    for the same stream.Ah, somehow I missed this issue. It should have been in the problem description, not in the test case/example section.    I don't know precisely what the "correct fix" to Common Lisp is here, but    I don't think it involves either making all the stream variables' bindings    initially undefined, nor leaving all but *TERMINAL-IO* defined to be    synonym streams to *TERMINAL-IO*.  Maybe the variables should be defined    in terms of their contracts rather than their implementations.Sounds like a plausible avenue to pursue.    I think the proposal needs another iteration based on a new idea.Agreed. I'm certainly willing to continue entertaining discussion on the issue.If it helps the Unix guys putting together the next round of proposals,I'm willing to have relax the requirement that *ERROR-OUTPUT* be boundto a synonym stream to *TERMINAL-IO*. It's mainly the -IO* variables and*STANDARD-INPUT* and *STANDARD-OUTPUT* that I'm concerned about havingpoint to *TERMINAL-IO* initially. *ERROR-OUTPUT* and *TRACE-OUTPUT* areless important to me as long as the issues are clearly documented.In fact, though, I think that many supposedly portable programs are -extremely-sloppy about distinguishing *ERROR-OUTPUT* and *TERMINAL-IO* and that lots ofdumb problems like (FORMAT *ERROR-OUTPUT* "You did something bad: ...") (YES-OR-NO-P "Continue anyway? ")will be shown up if *ERROR-OUTPUT* and *TERMINAL-IO* do not initially point tothe same stream. Maybe it's just as well that such bugs do get shown up, but Ithink there should be a guide to what kinds of things belong on *ERROR-OUTPUT*and what belongs on *QUERY-IO* and what on *TERMINAL-IO* and what on*STANDARD-OUTPUT*. We're still way too vague about all this. Any proposal tofix things must be more specific, not more vague, since systems cannot come up with "creative" solutions to the Unix problem in the absence ofcooperation from the users.*start*02944 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU by Xerox.COM ; 08 FEB 88 10:33:05 PSTReceived: from STONY-BROOK.SCRC.Symbolics.COM (SCRC-STONY-BROOK.ARPA) by SAIL.Stanford.EDU with TCP; 8 Feb 88  10:31:29 PSTReceived: from RIO-DE-JANEIRO.SCRC.Symbolics.COM by STONY-BROOK.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 338697; Mon 8-Feb-88 13:30:18 ESTDate: Mon, 8 Feb 88 13:30 ESTFrom: Kent M Pitman <KMP@STONY-BROOK.SCRC.Symbolics.COM>Subject: Issue: STANDARD-INPUT-INITIAL-BINDING (version 1)To: pierson@MULTIMAX.ARPAcc: CL-Cleanup@SAIL.Stanford.EDU, KMP@STONY-BROOK.SCRC.Symbolics.COM, franz!smh@BERKELEY.EDUIn-Reply-To: <8801192339.AA20676@mist.UUCP>Message-ID: <880208133005.2.KMP@RIO-DE-JANEIRO.SCRC.Symbolics.COM>I can't support this proposal.I believe that the correct fix is for wording to be added that explainsthat *TERMINAL-IO* might be a bidirectional stream which directs inputfrom and to a virtual and not necessarily a physical terminal. As such,*TERMINAL-IO* should properly be initialized to (MAKE-TWO-WAY-STREAM SYSTEM-INTERNALS:*UNIX-STANDARD-INPUT*		      SYSTEM-INTERNALS:*UNIX-STANDARD-OUTPUT*)If it were, then *STANDARD-INPUT* and *STANDARD-OUTPUT* would behavecorrectly with no relaxation of the requirements on their initial values.I think it is important that *STANDARD-INPUT*, *STANDARD-OUTPUT*, etc.be defined to be bound to synonym streams initially. Here are some reasons: * It may be important to the programmer to recover the value of this   virtual terminal. There is already a restriction on binding   *TERMINAL-IO* in Common Lisp, so the virtual terminal will always   be accessible from *TERMINAL-IO*. If the virtual terminal were in   *STANDARD-INPUT* and *STANDARD-OUTPUT*, the user might bind himself   into a corner where he could no longer recover the value of the   virtual terminal. * I think the initial I/O pairing should be available as a unit rather   than in two different places. * If there is no physical console, the value of *TERMINAL-IO* will   have garbage. There is no reason that input/output from/to programs to   *TERMINAL-IO* should fail just because an alternate input or output   stream was provided. You cannot make *TERMINAL-IO* indirect via synonym   stream to *STANDARD-INPUT*,etc. without risking complete disaster.   If it did, the user might do:   (LET ((*STANDARD-INPUT* (MAKE-SYNONYM-STREAM '*TERMINAL-IO*))) ...)   and get a circular synonym stream. In order to make sure that programs   can portably use synonym streams at all, it is extremely important that   the directionality of synonym streams be well-defined (ie, from    *STANDARD-INPUT* to *TERMINAL-IO* and not vice versa) and that there be   a known bottoming out point, *TERMINAL-IO*, which cannot be a synonym   stream to anything the user can get his hands on.*start*08269 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU by Xerox.COM ; 29 FEB 88 15:55:35 PSTReceived: from multimax.ARPA by SAIL.Stanford.EDU with TCP; 29 Feb 88  15:52:45 PSTReceived:  by multimax.ARPA (5.51/25-eef)	id AA04746; Mon, 29 Feb 88 18:54:32 ESTReceived: from localhost by mist.UUCP (3.2/4.7)	id AA19855; Mon, 29 Feb 88 18:55:17 ESTMessage-Id: <8802292355.AA19855@mist.UUCP>To: cl-cleanup%sail.stanford.edu@multimax.ARPASubject: Issue: STANDARD-INPUT-INITIAL-BINDING (version 2)Date: Mon, 29 Feb 88 18:55:14 ESTFrom: Dan L. Pierson <pierson@mist.ARPA>Issue:         STANDARD-INPUT-INITIAL-BINDINGReferences:    Standard streams (pp. 327-329)Category:      CHANGEEdit history:  Version 1 by Pierson and Haflich 1/19/87    	       Version 2 by Pierson 2/29/88Status:        For Internal DiscussionThis is a complete rewrite.  I hope the added complexity is worth it,I don't see anyway to both hide the hair and do better than CLtL.Problem description:CLtL requires that *STANDARD-INPUT*, *STANDARD-OUTPUT*,*ERROR-OUTPUT*, *TRACE-OUTPUT*, *QUERY-IO*, and *DEBUG-IO* areinitially bound to synonym streams to *TERMINAL-IO*.  This requirementhampers the integration of Common Lisp with many existing andpotential operating environments.For example, a Unix implementation is currently unable to legallysupport Unix standard error output even though Common Lisp defines*ERROR-OUTPUT* because *ERROR-OUTPUT* is required to start out boundto the same stream as *STANDARD-OUTPUT*.  A workstation environnmentwhich provides stream access to windows as an extension is currentlyforbidden to make trace output appear in a separate window by defaultbecause *TRACE-OUTPUT* is required to start out bound to the samestream as *STANDARD-OUTPUT*.Proposal (STANDARD-INPUT-INITIAL-BINDING:DEFINED-CONTRACTS):A Common Lisp implementation is required to provide two sets of openstreams, Primitive Streams, and User Streams.  Most user programsshould only use the User Streams; each User Stream has a specificpurpose as defined in CLtL. [[ If this proposal is accepted I can bepersuaded to retype the page and a half of definitions here.]]  ThePrimitive Streams are the initial defined interfaces between Lisp andthe non-Lisp world.  The primary purpose of the Primitive Streams isto make it possible to portably recover from a stream-binding error onany User Stream, for this reason it is an error to rebind or set anyPrimitive Stream.  Implementations are encouraged, but not required tosignal a correctable error if a Primitive Stream is rebound.Primitive Streams:    *INITIAL-INPUT*    	This stream is bound to the primary default input of the Lisp	system (e.g. standard input on Unix, SYS$INPUT on VMS).  While	this will probably be an interactive terminal or window during	program development, it may well be a data file for a	non-interactive application.    *INITIAL-OUTPUT*    	This stream is bound to the primary default output of the Lisp	system (e.g. standard output on Unix, SYS$OUTPUT on VMS).  While	this will probably be an interactive terminal or window during	program development, it may well be a data file for a	non-interactive application.    *INITIAL-QUERY-INPUT*    	Whenever possible, this stream is bound to an interactive	input source.  This may be the same as *initial-input* in a	development environment, or it may be a separate window, or	terminal.  If the Lisp system is running under an operating	system such as Aegis which provides a separate error input	source, this stream should probably be bound to that source.	In a non-interactive environment for which no interactive input	is available, reading this stream will always result in EOF.    *INITIAL-ERROR-OUTPUT*    	If *initial-query-input* is bound to an interactive input source,	this stream should be bound to the cooresponding interactive output	destination such that *query-io* will work in the expected way if	bound to a two-way stream between these two streams.  If the Lisp	system is running under an operating system such as Aegis, Unix,	or VMS which provides a separate error output destination, this	stream should be bound to that destination.  In a non-interactive	environment without a separate error destination, this stream should	be bound to the same destination as *initial-output*.User Streams:    *TERMINAL-IO*    	The initial binding of *terminal-io* is a two-way stream between	*initial-input* and *initial-output* unless these streams can be	determined to be non-interactive and *initial-query-input* and	*initial-error-output* can both be determined to be real interactive	streams (e.g. reading *initial-query-input* does not always result	in EOF), in which case *terminal-io* is bound to a two-way stream	between them.  In a windowing environment, *terminal-io* may refer	to a different window than *query-io* (and therefore than any of	the *initial-foo* streams) as long as all of these streams refer	to windows.    *STANDARD-INPUT*    	The initial binding of *standard-input* is *initial-input*.    *STANDARD-OUTPUT*    	The initial binding of *standard-output* is *initial-output*.    *ERROR-OUTPUT*    	The initial binding of *error-output* is *initial-error-output*.    *TRACE-OUTPUT*    	The initial binding of *trace-output* is  *initial-error-output*	in a non-windowed environment.  In a windowed environment,    	*trace-output* may start out bound in some other way (e.g. to	a non-existant trace output window which will be automagically	created when output is first done to *trace-output*).    *QUERY-IO*    	Initially bound to a two way stream between *initial-query-input*	and *initial-error-output*.    *DEBUG-IO*    	The initial binding of *debug-io* is  *initial-error-output* in a	non-windowed environment.  In a windowed environment, *debug-io*	may start out bound in some other way.Test Cases/Examples:(PROGN   (PRINT "Output" *STANDARD-OUTPUT*)   (PRINT "Error" *STANDARD-ERROR*))In current Common Lisp will write:------OutputError------With proposal *might* write:------Output------and "Error" appears somewhere else.Rationale:This proposal attempts to provide a balance between over-specifyingbehavior to the point that Lisp programs can't behave like otherprograms in conventional operating systems and providing enoughspecification that Common Lisp programs can perform portable input andoutput including safe rebinding of the standard streams.Current practice:Lucid binds *TERMINAL-IO* to a special internal stream type.  Franzbinds *TERMINAL-IO* to a special internal stream type for terminalstreams which reads from Unix standard input and writes to Unixstandard output.  KCL binds *TERMINAL-IO* to a standard two-way-streamwith input from Unix standard input and output to Unix standardoutput.Cost to Implementors:All implementations will have to change to some degree but the changeswill probably be simple and localized.  Most implementations alreadyinclude some or all of the initial streams as internal stream types sothis is largely a documentation and initialization task.Cost to Users:User code which depends on the strict binding hierarchy in CLtL mayhave to change.  Cost of non-Adoption:It will continue to be difficult or impossible to integrate portableCommon Lisp progams in conventional operating system environments.Many implementations will have to continue to choose betweenconforming to the standard and providing a superior user environment.Benefits:Implementations will be more able to match their IO behavior to theirenvironment and their user's expectations.  Aesthetics:The four new streams appear to add complexity but they also separatethe previous intermixed concepts of initial bindings and standardpurpose streams.Discussion:The repeated mention of windowing environments above seems to begetting dangerously close to the environmental issues this standard issupposed to avoid, but Pierson feels that if we have to do more thanleave these areas undefined, we also have to give advancedenvironments official permission to do their thing.*start*03701 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU by Xerox.COM ; 01 MAR 88 11:26:41 PSTReceived: from STONY-BROOK.SCRC.Symbolics.COM (SCRC-STONY-BROOK.ARPA) by SAIL.Stanford.EDU with TCP; 1 Mar 88  11:24:14 PSTReceived: from EUPHRATES.SCRC.Symbolics.COM by STONY-BROOK.SCRC.Symbolics.COM via INTERNET with SMTP id 353802; 1 Mar 88 14:23:46 ESTDate: Tue, 1 Mar 88 14:23 ESTFrom: David A. Moon <Moon@STONY-BROOK.SCRC.Symbolics.COM>Subject: Issue: STANDARD-INPUT-INITIAL-BINDING (version 2)To: Dan L. Pierson <pierson%mist@MULTIMAX.ARPA>, Pierson@MULTIMAX.ARPAcc: cl-cleanup@SAIL.STANFORD.EDUIn-Reply-To: <8802292355.AA19855@mist.UUCP>Message-ID: <19880301192344.0.MOON@EUPHRATES.SCRC.Symbolics.COM>There are actually three parts to this proposal, and perhaps itshould be written in a way that makes the distinction even clearer.First, the specification of *STANDARD-INPUT* etc. is changed tospecify them in terms of what they do, rather than in terms ofhow they are implemented.  I wholeheartedly support this.  I thinkthe proposal needs to go a little farther in this direction.  Forinstance, it seems to apply that the initial binding of *TERMINAL-IO*will be a value returned by the MAKE-TWO-WAY-STREAM function.  That'simplementation.  Instead it should say only that the initial bindingof *TERMINAL-IO* behaves in such a way that input comes from, andoutput goes to, an interactive place, if there is one.  If no interactiveplaces exist, I think you say (the wording is a bit confusing) that*TERMINAL-IO* is bound to (MAKE-TWO-WAY-STREAM *STANDARD-INPUT**STANDARD-OUTPUT*), even though it's not a terminal.  I'm not sure, butI think it might be better for *TERMINAL-IO* to be unbound, or a streamthat signals an error if used, in this case, since anything that explicitlyuses *TERMINAL-IO* is trying to do something that simply can't be done.I suspect that the alignment of the *TERMINAL-IO* interactive place withthe *STANDARD-INPUT* and *QUERY-IO* interactive places should be left upto the implementation, rather than trying to say (as you do) it goeshere if that's interactive, else it goes there.  There is probably agreat deal of variation among implementations on this point, and I don'tsee that a portable program needs to know whether *TERMINAL-IO* is thesame as *STANDARD-INPUT*, the same as *QUERY-IO*, or the same as neitherof them; a portable program should use whichever stream is the one itreally means, not use some different one on the assumption that it'sreally the same.Second, you propose to add the variable *INITIAL-QUERY-INPUT*, whichdoesn't quite correspond to *QUERY-IO*.  This gives access to a primitivestream that hadn't been identified as primitive before, but that existsin some implementations.  Although I don't understand how an applicationprogram would use an input-only query stream, I see no harm in makingthis change.  No one is forced to use it if they don't want to.  I'ddrop the word "initial" from the variable name.Third, you propose to add three new variables that retain the initialvalues of three of the existing stream variables, in case the existingvariables are rebound.  I don't see any value in this, except that ithelps you describe the meanings of the other streams.  A program thatwished to portably recover from a stream-binding error on any UserStream could start by saving the values of the existing variables.We don't need to add new variables for this.This sounds a bit critical, but I think this is basically a very goodproposal.  I hope you find my suggested improvements constructive.*start*07065 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU by Xerox.COM ; 23 MAY 88 16:15:39 PDTReceived: from multimax.ARPA by SAIL.Stanford.EDU with TCP; 23 May 88  16:13:31 PDTReceived:  by multimax.ARPA (5.51/25-eef)	id AA09358; Mon, 23 May 88 19:12:05 EDTReceived: from localhost by mist.UUCP (3.2/4.7)	id AA13961; Mon, 23 May 88 19:15:06 EDTMessage-Id: <8805232315.AA13961@mist.UUCP>To: cl-cleanup%sail.stanford.edu@multimax.ARPASubject: Issue: STANDARD-INPUT-INITIAL-BINDING (version 3)Date: Mon, 23 May 88 19:15:04 EDTFrom: Dan L. Pierson <pierson%mist@multimax.ARPA>Issue:         STANDARD-INPUT-INITIAL-BINDINGReferences:    Standard streams (pp. 327-329)Category:      CHANGEEdit history:  Version 1 by Pierson and Haflich 1/19/87    	       Version 2 by Pierson 2/29/88	       Version 3 by Pierson 5/23/88, per comments by MoonStatus:        For Internal DiscussionThe primitive streams have been removed.Problem description:CLtL requires that *STANDARD-INPUT*, *STANDARD-OUTPUT*,*ERROR-OUTPUT*, *TRACE-OUTPUT*, *QUERY-IO*, and *DEBUG-IO* areinitially bound to synonym streams to *TERMINAL-IO*.  This requirementhampers the integration of Common Lisp with many existing andpotential operating environments.For example, a Unix implementation is currently unable to legallysupport Unix standard error output even though Common Lisp defines*ERROR-OUTPUT* because *ERROR-OUTPUT* is required to start out boundto the same stream as *STANDARD-OUTPUT*.  A workstation environnmentwhich provides stream access to windows as an extension is currentlyforbidden to make trace output appear in a separate window by defaultbecause *TRACE-OUTPUT* is required to start out bound to the samestream as *STANDARD-OUTPUT*.Proposal (STANDARD-INPUT-INITIAL-BINDING:DEFINED-CONTRACTS):A Common Lisp implementation is required to provide the followinginitial streams.  Each initial stream has a specific purpose as definedin CLtL.    *STANDARD-INPUT*    	This stream is bound to the primary default input of the Lisp	system (e.g. standard input on Unix, SYS$INPUT on VMS).  While	this will probably be an interactive terminal or window during	program development, it may well be a data file for a	non-interactive application.    *STANDARD-OUTPUT*    	This stream is bound to the primary default output of the Lisp	system (e.g. standard output on Unix, SYS$OUTPUT on VMS).  While	this will probably be an interactive terminal or window during	program development, it may well be a data file for a	non-interactive application.    *QUERY-INPUT*    	Whenever possible, this stream is bound to an interactive	input source.  This may be the same as *initial-input* in a	development environment, or it may be a separate window, or	terminal.  If the Lisp system is running under an operating	system such as Aegis which provides a separate error input	source, this stream should probably be bound to that source.	In a non-interactive environment for which no interactive input	is available, reading this stream will always result in EOF.    *ERROR-OUTPUT*    	If *initial-query-input* is bound to an interactive input source,	this stream should be bound to the cooresponding interactive output	destination such that *query-io* will work in the expected way if	bound to a two-way stream between these two streams.  If the Lisp	system is running under an operating system such as Aegis, Unix,	or VMS which provides a separate error output destination, this	stream should be bound to that destination.  In a non-interactive	environment without a separate error destination, this stream should	be bound to the same destination as *initial-output*.    *TRACE-OUTPUT*    	The initial binding of *trace-output* is *initial-error-output*	in a non-windowed environment.  In a windowed environment,    	*trace-output* may start out bound in some other way (e.g. to	a non-existant trace output window which will be automagically	created when output is first done to *trace-output*).    *QUERY-IO*        In a non-windowed environment, the initial binding of    	*query-io* is a stream that reads from *initial-query-input*        and writes to *initial-error-output*.    *TERMINAL-IO*    	The initial binding of *terminal-io* is the same as *query-io*	in a non-windowed environment.  In a windowed environment,	*terminal-io* may refer to a different window than *query-io*	as long as all of these streams refer to windows.    *DEBUG-IO*    	The initial binding of *debug-io* is the same as *query-io* in	a non-windowed environment.  In a windowed environment,	*debug-io* may refer to a different window than *query-io*	as long as all of these streams refer to windows.Test Cases/Examples:(PROGN   (PRINT "Output" *STANDARD-OUTPUT*)   (PRINT "Error" *STANDARD-ERROR*))In current Common Lisp will write:------OutputError------With proposal *might* write:------Output------and "Error" appears somewhere else.Rationale:This proposal attempts to provide a balance between over-specifyingbehavior to the point that Lisp programs can't behave like otherprograms in conventional operating systems and providing enoughspecification that Common Lisp programs can perform portable input andoutput.Current practice:Lucid binds *TERMINAL-IO* to a special internal stream type.  Franzbinds *TERMINAL-IO* to a special internal stream type for terminalstreams which reads from Unix standard input and writes to Unixstandard output.  KCL binds *TERMINAL-IO* to a standard two-way-streamwith input from Unix standard input and output to Unix standardoutput.Cost to Implementors:All implementations will have to change to some degree but the changeswill probably be simple and localized.Cost to Users:User code which depends on the strict binding hierarchy in CLtL mayhave to change.  Cost of non-Adoption:It will continue to be difficult or impossible to integrate portableCommon Lisp progams in conventional operating system environments.Many implementations will have to continue to choose betweenconforming to the standard and providing a superior user environment.Benefits:Implementations will be more able to match their IO behavior to theirenvironment and their user's expectations.  Aesthetics:Slightly improved because this area becomes better defined.Discussion:The repeated mention of windowing environments above seems to begetting dangerously close to the environmental issues this standard issupposed to avoid, but Pierson feels that if we have to do more thanleave these areas undefined, we also have to give advancedenvironments official permission to do their thing.Pitman was concerned that the initial version of this proposal didn'tprovide a guaranteed way to get back the initial streams afterrebinding, e.g. *standard-io*.  The second version of this proposaloffered a solution to that problem which was generally considered toocomplex.*start*01254 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU by Xerox.COM ; 27 MAY 88 08:16:14 PDTReceived: from Think.COM by SAIL.Stanford.EDU with TCP; 27 May 88  08:14:08 PDTReturn-Path: <gls@Think.COM>Received: from kali.think.com by Think.COM; Fri, 27 May 88 11:11:35 EDTReceived: by kali.think.com; Fri, 27 May 88 11:11:31 EDTDate: Fri, 27 May 88 11:11:31 EDTFrom: gls@Think.COMMessage-Id: <8805271511.AA14847@kali.think.com>To: edsel!jlm@labrea.stanford.eduCc: pierson@multimax.arpa, cl-cleanup@sail.stanford.eduIn-Reply-To: Jim McDonald's message of Thu, 26 May 88 16:10:07 PDT <8805262310.AA06041@bhopal.lucid.com>Subject: Issue: STANDARD-INPUT-INITIAL-BINDING (version 4)   Date: Thu, 26 May 88 16:10:07 PDT   From: Jim McDonald <edsel!jlm@labrea.stanford.edu>   >  Moon says that *TERMINAL-IO* (and, by extension, *QUERY-IO*, and   >  *DEBUG-IO*) should fail to work in a non-interactive environment where   >  nothing like a terminal exists.     That seems like a needless restriction that could be rather painful   in particular instances.Suppose we define an "interactive environment" to be one in which*TERMINAL-IO* works?--Guy*start*06399 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU by Xerox.COM ; 13 APR 88 13:37:48 PDTReceived: from multimax.ARPA by SAIL.Stanford.EDU with TCP; 13 Apr 88  13:34:39 PDTReceived:  by multimax.ARPA (5.51/25-eef)	id AA03790; Wed, 13 Apr 88 16:34:43 EDTReceived: from localhost by mist.UUCP (3.2/4.7)	id AA00898; Wed, 13 Apr 88 16:35:51 EDTMessage-Id: <8804132035.AA00898@mist.UUCP>To: cl-cleanup%sail.stanford.edu@multimax.ARPASubject: [Jim McDonald: Issue: STANDARD-INPUT-INITIAL-BINDING (version 2)]Date: Wed, 13 Apr 88 16:35:45 EDTFrom: Dan L. Pierson <pierson%mist@multimax.ARPA>Jim asked me to forward this to the cleanup committee a while ago.  Ithink that it has some interesting ideas, but delves too much intospecifying implmentation for standards proposal.------- Forwarded MessageReturn-Path: @multimax.ARPA:edsel!jlm@labrea.Stanford.EDUReceived: from multimax.ARPA by mist.UUCP (3.2/4.7)	id AA23038; Wed, 2 Mar 88 10:00:47 ESTReceived:  by multimax.ARPA (5.51/25-eef)	id AA15330; Wed, 2 Mar 88 10:00:47 ESTReceived: by labrea.Stanford.EDU; Tue, 1 Mar 88 12:37:31 PSTReceived: from bhopal.lucid.com by edsel id AA06372g; Tue, 1 Mar 88 11:47:41 PSTReceived: by bhopal id AA05626g; Tue, 1 Mar 88 11:53:43 PSTDate: Tue, 1 Mar 88 11:53:43 PSTFrom: Jim McDonald <edsel!jlm@labrea.Stanford.EDU>Message-Id: <8803011953.AA05626@bhopal.lucid.com>To: pierson@multimax.arpaIn-Reply-To: Dan L. Pierson's message of Mon, 29 Feb 88 18:55:14 EST <8802292355.AA19855@mist.UUCP>Subject: Issue: STANDARD-INPUT-INITIAL-BINDING (version 2)Cc: edsel!eb@labrea.Stanford.EDU, edsel!jonl@labrea.Stanford.EDU,        edsel!lnz@labrea.Stanford.EDU, edsel!kdo@labrea.Stanford.EDUDan -- you might want to consider these comments I drafted a few weeksago.  They're not quite in proposal format (the header is just foryour reference), but if you like the sense of this I can clean it up.I think this is basically a generalization of your proposal (or atleast is more open-ended):- -----Issue:         STANDARD-INPUT-INITIAL-BINDINGReferences:    Standard streams (pp. 327-329)Category:      CHANGEEdit history:  Version 1 by Pierson and Haflich 1/19/87    	       Version 2 by Pierson 2/29/88    	       Version 3 by McDonald 3/01/88Status:        For Internal DiscussionA number of primitive streams are instantiated when lisp starts(via the function primitive-streams), and the results of that function are then used to build the higher level streams seen byusers.- ------primitive-streams &optional create-streams-p [function]  If create-streams-p is true, creates and opens primitive streams in  an implementation-dependant manner.  Data associated with any  previously existing streams may be lost, and the effects of previous  calls to add-primitive-stream and delete-primitive-stream may be  lost.  Normally, create-streams-p will be true for just a single   call made when lisp starts.    Always returns a list of triples of the form:    (<keyword> <input-stream or nil> <output-stream or nil>).  The following triples must be included in this list, but more are  allowed, and various of the stream objects may be eq:   ((:terminal-input   #<input-stream>  nil)    (:terminal-output  nil              #<output-stream>)    (:standard-input   #<input-stream>  nil)    (:standard-output  nil              #<output-stream>)    (:error-output     nil              #<output-stream>)    (:query-input      #<input-stream>  nil)    (:query-output     nil              #<output-stream>))  It is an error to destructively modify this list or any of the  triples within it.  Different calls to primitive-streams are free to  return eq lists or not, as convenient.- ------  add-primitive-stream (keyword input-stream-or-nil output-stream-or-nil)  Causes a three element list of the arguments to be prepended to the   list of triples returned by subsequent calls to (primitive-streams).    Signals an error if the first argument is not a keyword, if the  second argument is not nil or an input-stream, or if the third  argument is not nil or an output-stream.  Returns NIL.  Note that this can be used to "shadow" :terminal-input, etc.- ------  delete-primitive-stream (keyword)  The first triple starting with keyword which would otherwise have  been returned by (primitive-streams) will no longer appear in the  list of triples returned by (primitive-streams).    Signals an error if the argument is not a keyword.  Returns the triple which is deleted, or NIL if none existed, or  :ERROR if the triple selected may not be removed.  Note that this can be used to remove shadowing triples for   :terminal-input, e.g., but not all triples for it.- ------During lisp startup, two forms are executed: (primitive-streams t)  (initialize-stream-variables)Initialize-stream-variables is defined by default as follows, butimplementations and/or users, applications, etc., can redefine it orsimply reset or rebind the stream variables as they choose. (defun initialize-stream-variables ()  (let ((primitive-streams (primitive-streams)))    (setq *terminal-io* 	  (make-two-way-stream	    (second (assoc :terminal-input  primitive-streams))	    (third  (assoc :terminal-output primitive-streams))))    (setq *standard-input*  	  (second (assoc :standard-input  primitive-streams)))    (setq *standard-output* 	  (third  (assoc :standard-output primitive-streams)))    (setq *error-output*    	  (third  (assoc :error-output    primitive-streams)))    (setq *query-io*        	  (make-two-way-stream 	    (second (assoc :query-input  primitive-streams))	    (third  (assoc :query-output primitive-streams))))    ))- ------Rather than mandating portability via some least common denominator,this proposal makes stream initialization more of an open system, easyto tailor to individual situations.The rules are also intended to enable user code to be able to restore *terminal-io*, *standard-input*, *standard-output*, *error-output*,and *query-io* to reasonable values, even if all of them have beenset to NIL or other undesirable values.The functional interface to the triples is designed to discourage random tampering with sensitive data.------- End of Forwarded Message*start*02893 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU by Xerox.COM ; 23 MAY 88 17:25:30 PDTReceived: from Xerox.COM by SAIL.Stanford.EDU with TCP; 23 May 88  17:23:34 PDTReceived: from Cabernet.ms by ArpaGateway.ms ; 23 MAY 88 17:21:56 PDTDate: 23 May 88 17:21 PDTFrom: masinter.paSubject: Re: Issue: STANDARD-INPUT-INITIAL-BINDING (version 3)In-reply-to: Dan L. Pierson <pierson%mist@multimax.ARPA>'s message of Mon, 23 May 88 19:15:04 EDTTo: pierson%mist@multimax.ARPAcc: cl-cleanup@sail.stanford.eduMessage-ID: <880523-172156-5777@Xerox>Wow. I was about to button "Deliver" on a message poking you on this one...I must admit that I didn't read earlier versions with much attention.  I amuncomfortable with the imperative style of this proposal (and of CLtL). I caneasily imagine implimentations conforming to the spirit but not conforming tothe letter of this proposal. Suppose, for example, I have a program that recordsuser input and is able to duplicate it later. The second time I run it, it isn'tan "interactive" input stream, but does this mean I can't legally attach it to*QUERY-INPUT* because reading from *QUERY-INPUT* must result in end-of-file? In many multi-processing multi-window environments, the "initial binding" for*STANDARD-INPUT*, *QUERY-INPUT*  differs for each process. Your latest VERSION makes reference to *INITIAL-INPUT* and *INITIAL-OUTPUT*still, even though you removed those items from the definition.    *ERROR-OUTPUT*    	If *initial-query-input* is bound to an interactive input source,	this stream should be bound to the cooresponding interactive output	destination such that *query-io* will work in the expected way if	bound to a two-way stream between these two streams.  If the Lisp	system is running under an operating system such as Aegis, Unix,	or VMS which provides a separate error output destination, this	stream should be bound to that destination.  In a non-interactive	environment without a separate error destination, this stream should	be bound to the same destination as *initial-output*.a) what is *initial-query-input*?b) what is "the expected way"?c) what if "*initial-query-input* is bound to an interactive input source" andalso "If the Lisp	system is running under an operating system such as Aegis, Unix,	or VMS which provides a separate error output destination"? 	This section gives conflicting requirements, does it not? If you are runningwith an operating system that has error output streams but the initial queryinput stream isn't it?    *TRACE-OUTPUT*    	The initial binding of *trace-output* is *initial-error-output*what is *initial-error-output*?what is "automagically"?etc. etc.I don't know how to say it more kindly, but I think this is a step backward fromversion 2.*start*03076 00024 US Return-Path: <@multimax.ARPA:pierson%mist@multimax.ARPA>Received: from multimax.ARPA by Xerox.COM ; 26 MAY 88 11:47:07 PDTReceived:  by multimax.ARPA (5.51/25-eef)	id AA01485; Thu, 26 May 88 14:44:59 EDTReceived: from localhost by mist.UUCP (3.2/4.7)	id AA18493; Thu, 26 May 88 11:40:05 EDTMessage-Id: <8805261540.AA18493@mist.UUCP>To: masinter.pa%Xerox.COM@multimax.ARPACc: cl-cleanup%sail.stanford.edu@multimax.ARPASubject: Re: Issue: STANDARD-INPUT-INITIAL-BINDING (version 3) In-Reply-To: Your message of 23 May 88 17:21:00 -0700.Date: Thu, 26 May 88 11:40:03 EDTFrom: Dan L. Pierson <pierson%mist@multimax.ARPA>    Wow. I was about to button "Deliver" on a message poking you on this one...    Yes, well, there seem to be a lot of holes around nowdays...    I must admit that I didn't read earlier versions with much attention.    I am uncomfortable with the imperative style of this proposal (and of    CLtL). I can easily imagine implimentations conforming to the spirit    but not conforming to the letter of this proposal. Suppose, for    example, I have a program that records user input and is able to    duplicate it later. The second time I run it, it isn't an    "interactive" input stream, but does this mean I can't legally attach    it to *QUERY-INPUT* because reading from *QUERY-INPUT* must result in    end-of-file?    This seems to be what Moon wanted at the March meeting.  I sort ofdoubt that it will meet universal acceptance, but promised to moveback in this direction for the third draft.    In many multi-processing multi-window environments, the "initial    binding" for *STANDARD-INPUT*, *QUERY-INPUT* differs for each    process.    This is not specifically addressed, though you could stretch a point andclaim that all of the window loopholes cover it.  I'll think aboutadding something, but probably not to today's draft.  The problem isthat the original goal of supporting the "standard streams" of theunderlying environment breaks down completely in a multi-window,multi-process Lisp, if only because you don't bring up all that hairjust to run a shell-level batch job.    Your latest VERSION makes reference to *INITIAL-INPUT* and *INITIAL-OUTPUT*    still, even though you removed those items from the definition.        ...        etc. etc.Sorry about all that, it'll teach me to re-edit a proposal quickly.  Anew version will be going out today with all of that garbage fixed up.    I don't know how to say it more kindly, but I think this is a step    backward from version 2.    The cleanliness of the proposal certainly was a step backward, sorry.The content is harder.  I've never expected this version to beaccepted unchanged, so I've saved a copy of version 2.  Should I putout a new draft with both versions as alternate proposals?  I'm reallyreluctant to cop out that way without a very good reason.It sounds to me like you would be happier with the original "specifyas little as possible" approach which was rejected in the firstproposal.*start*07872 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU by Xerox.COM ; 26 MAY 88 11:49:04 PDTReceived: from multimax.ARPA by SAIL.Stanford.EDU with TCP; 26 May 88  11:46:33 PDTReceived:  by multimax.ARPA (5.51/25-eef)	id AA01497; Thu, 26 May 88 14:45:19 EDTReceived: from localhost by mist.UUCP (3.2/4.7)	id AA18524; Thu, 26 May 88 11:55:13 EDTMessage-Id: <8805261555.AA18524@mist.UUCP>To: cl-cleanup%sail.stanford.edu@multimax.ARPASubject: Issue: STANDARD-INPUT-INITIAL-BINDING (version 4)Date: Thu, 26 May 88 11:55:11 EDTFrom: Dan L. Pierson <pierson%mist@multimax.ARPA>Issue:         STANDARD-INPUT-INITIAL-BINDINGReferences:    Standard streams (pp. 327-329)Category:      CHANGEEdit history:  Version 1 by Pierson and Haflich 1/19/87    	       Version 2 by Pierson 2/29/88	       Version 3 by Pierson 5/23/88, per comments by Moon               Version 4 by Pierson 5/26/88, clean upStatus:        For Internal DiscussionThe primitive streams have been removed, completely this time.Problem description:CLtL requires that *STANDARD-INPUT*, *STANDARD-OUTPUT*,*ERROR-OUTPUT*, *TRACE-OUTPUT*, *QUERY-IO*, and *DEBUG-IO* areinitially bound to synonym streams to *TERMINAL-IO*.  This requirementhampers the integration of Common Lisp with many existing andpotential operating environments.For example, a Unix implementation is currently unable to legallysupport Unix standard error output even though Common Lisp defines*ERROR-OUTPUT* because *ERROR-OUTPUT* is required to start out boundto the same stream as *STANDARD-OUTPUT*.  A workstation environnmentwhich provides stream access to windows as an extension is currentlyforbidden to make trace output appear in a separate window by defaultbecause *TRACE-OUTPUT* is required to start out bound to the samestream as *STANDARD-OUTPUT*.Proposal (STANDARD-INPUT-INITIAL-BINDING:DEFINED-CONTRACTS):A Common Lisp implementation is required to provide the followinginitial streams.  Each initial stream has a specific purpose as definedin CLtL.    *STANDARD-INPUT*    	This stream is bound to the primary default input of the Lisp	process (e.g. standard input on Unix, SYS$INPUT on VMS).  While	this will probably be an interactive terminal or window during	program development, it may well be a data file for a	non-interactive application.    *STANDARD-OUTPUT*    	This stream is bound to the primary default output of the Lisp	process (e.g. standard output on Unix, SYS$OUTPUT on VMS).  While	this will probably be an interactive terminal or window during	program development, it may well be a data file for a	non-interactive application.    *QUERY-INPUT*    	Whenever possible, this stream is bound to an interactive	input source.  This may be the same as *STANDARD-INPUT* in a	development environment, or it may be a separate window, or	terminal.  If the Lisp system is running under an operating	system such as Aegis which provides a separate error input	source, this stream should probably be bound to that source.	In a non-interactive environment for which no interactive input	is available, reading this stream will always result in EOF.    *ERROR-OUTPUT*    	If *QUERY-INPUT* is bound to an interactive input source, this	stream should be bound to the cooresponding interactive output	destination.  If the Lisp system is running under an operating	system such as Aegis, Unix, or VMS which provides a separate	error output destination, this stream should be bound to that	destination.  In a non-interactive environment without a	separate error destination, this stream should be bound to the	same destination as *STANDARD-OUTPUT*.    *TRACE-OUTPUT*    	The initial binding of *TRACE-OUTPUT* is *ERROR-OUTPUT*	in a non-windowed environment.  In a windowed environment,    	*TRACE-OUTPUT* may start out bound in some other way (e.g. to	a non-existant trace output window which will be automatically	created when output is first done to *TRACE-OUTPUT*).    *QUERY-IO*        In a non-windowed environment, the initial binding of    	*QUERY-IO* is a stream that reads from *QUERY-INPUT*        and writes to *ERROR-OUTPUT*.    *TERMINAL-IO*    	The initial binding of *TERMINAL-IO* is the same as *QUERY-IO*	in a non-windowed environment.  In a windowed environment,	*TERMINAL-IO* may refer to a different window than *QUERY-IO*	as long as all of these streams refer to windows.    *DEBUG-IO*    	The initial binding of *DEBUG-IO* is the same as *QUERY-IO* in	a non-windowed environment.  In a windowed environment,	*DEBUG-IO* may refer to a different window than *QUERY-IO*	as long as all of these streams refer to windows.Test Cases/Examples:(PROGN   (PRINT "Output" *STANDARD-OUTPUT*)   (PRINT "Error" *STANDARD-ERROR*))In current Common Lisp will write:------OutputError------With proposal *might* write:------Output------and "Error" appears somewhere else.Rationale:This proposal attempts to provide a balance between over-specifyingbehavior to the point that Lisp programs can't behave like otherprograms in conventional operating systems and providing enoughspecification that Common Lisp programs can perform portable input andoutput.Current practice:Lucid binds *TERMINAL-IO* to a special internal stream type.  Franzbinds *TERMINAL-IO* to a special internal stream type for terminalstreams which reads from Unix standard input and writes to Unixstandard output.  KCL binds *TERMINAL-IO* to a standard two-way-streamwith input from Unix standard input and output to Unix standardoutput.Cost to Implementors:All implementations will have to change to some degree but the changeswill probably be simple and localized.Cost to Users:User code which depends on the strict binding hierarchy in CLtL mayhave to change.  Cost of non-Adoption:It will continue to be difficult or impossible to integrate portableCommon Lisp progams in conventional operating system environments.Many implementations will have to continue to choose betweenconforming to the standard and providing a superior user environment.Benefits:Implementations will be more able to match their IO behavior to theirenvironment and their user's expectations.  Aesthetics:Slightly improved because this area becomes better defined.Discussion:The repeated mention of windowing environments above seems to begetting dangerously close to the environmental issues this standard issupposed to avoid, but Pierson feels that if we have to do more thanleave these areas undefined, we also have to give advancedenvironments official permission to do their thing.Pitman was concerned that the initial version of this proposal didn'tprovide a guaranteed way to get back the initial streams afterrebinding, e.g. *standard-io*.  The second version of this proposaloffered a solution to that problem which was generally considered toocomplex.Moon says that *TERMINAL-IO* (and, by extension, *QUERY-IO*, and*DEBUG-IO*) should fail to work in a non-interactive environment wherenothing like a terminal exists.  While this version partiallyimplements Moon's view by expressing all of these in terms of*QUERY-INPUT* and *ERROR-OUTPUT* and requiring *QUERY-INPUT* to returnEOF in a non-interactive environment, this view is controversial.Pierson is currently neutral on this question.Masinter notes that:    ``In many multi-processing multi-window environments,      the "initial binding" for *STANDARD-INPUT*, *QUERY-INPUT*      differs for each process.''  This proposal provides very weak support for such environments byrefering to "the Lisp process" rather than "the Lisp system" whendefining *STANDARD-OUTPUT* and *STANDARD-INPUT*.  Some additionalverbiage may be needed to cover this case.*start*01756 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU by Xerox.COM ; 26 MAY 88 16:49:04 PDTReceived: from labrea.stanford.edu by SAIL.Stanford.EDU with TCP; 26 May 88  16:47:20 PDTReceived: by labrea.stanford.edu; Thu, 26 May 88 16:47:37 PDTReceived: from bhopal.lucid.com by edsel id AA19011g; Thu, 26 May 88 16:06:03 PDTReceived: by bhopal id AA06041g; Thu, 26 May 88 16:10:07 PDTDate: Thu, 26 May 88 16:10:07 PDTFrom: Jim McDonald <edsel!jlm@labrea.stanford.edu>Message-Id: <8805262310.AA06041@bhopal.lucid.com>To: pierson@multimax.arpaIn-Reply-To: Dan L. Pierson's message of Thu, 26 May 88 11:55:11 EDT <8805261555.AA18524@mist.UUCP>Cc: cl-cleanup@sail.stanford.eduSubject: Issue: STANDARD-INPUT-INITIAL-BINDING (version 4)>  Moon says that *TERMINAL-IO* (and, by extension, *QUERY-IO*, and>  *DEBUG-IO*) should fail to work in a non-interactive environment where>  nothing like a terminal exists.  That seems like a needless restriction that could be rather painfulin particular instances.What if I'm running a test suite that is trying to verify thebehavior of the debugger?   What if I want to redirect *termainal-io* through files to evadelimitations imposed by a given environment?  (E.g., simulating TENEXdetach/attach in Unix, or running on a box with NFS but no terminal.) What if I have a complex applications that started life being highlyinteractive via *query-io*, and now has stabilized to the point wherepeople want to invoke it via canned scripts?I'm having trouble imagining a situation where I would want*terminal-io* to fail simply because Lisp was guessing that the environment wasn't interactive.   jlm*start*05276 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU by Xerox.COM ; 31 MAY 88 14:24:08 PDTReceived: from STONY-BROOK.SCRC.Symbolics.COM (SCRC-STONY-BROOK.ARPA) by SAIL.Stanford.EDU with TCP; 31 May 88  14:21:53 PDTReceived: from PEWEE.SCRC.Symbolics.COM by STONY-BROOK.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 412704; Tue 31-May-88 17:21:28 EDTDate: Tue, 31 May 88 17:21 EDTFrom: Kent M Pitman <KMP@STONY-BROOK.SCRC.Symbolics.COM>Subject: Issue: STANDARD-INPUT-INITIAL-BINDING (Version 4)To: Dan L. Pierson <pierson%mist@MULTIMAX.ARPA>cc: CL-Cleanup@SAIL.Stanford.EDUIn-Reply-To: <8805261555.AA18524@mist.UUCP>Message-ID: <880531172117.5.KMP@PEWEE.SCRC.Symbolics.COM>Well, I'm still sympathetic to somethinga along these lines, but I don'tfind this current proposal to be "convincing" yet...For one thing, I think it's essential that a proposal of this sortinsist on a FOLLOW-SYNONYM-STREAM primitive (or the equivalentfunctionality).  It's critical that issues of which variablesmay/must/mustn't hold primitive streams and which may/must/mustn't holdsynonym streams be discussed clearly. Otherwise, the potential forsupposedly portable code to construct circular streams in someimplementations seems very high.I don't think the implications of this proposal are adequatelyexpressed. There are massive volumes of code which make subtleassumptions about the relationships between these streams which are(justifiably or otherwise) supported in most current implementations andwhich might be violated in the future. The potential cost to users is therefore high.A typical example is:  (WHEN (PROGN	  (FORMAT T "~&There are too many frobs.~%")	  (YES-OR-NO-P "~&Go ahead and lose? "))    (LOSE))When users use functions such as YES-OR-NO-P which implicitly use*QUERY-IO* or other streams, they do not see that they are doing streammismatches. Presumably they should sometimes be writing  (WHEN (PROGN	  (FORMAT *QUERY-IO* "~&There are too many frobs.~%")	  (YES-OR-NO-P "~&Go ahead and lose? "))    (LOSE))In the current state of affairs, they tend to win because implementationsare encouraged to make *STANDARD-OUTPUT* and *QUERY-IO* defaultly go to thesame place, but in the proposed state of affairs, it's easier for these todrift apart and the consequences of writing sloppy code such as the firstexample above are more noticeable.I basically agree with your claim that the new regime you're proposing mightbe better defined, but I'm not yet comfortable with how that better-defineduniverse feels. Not to put down your proposal, but there are many things Icould do to make the language simpler and better defined, yet not all of thosethings would make the language better. Before doing any, I would like tounderstand the consequences.I see your proposal, but I do not have a definite sense of the consequencesof it, and I assert that they are quite sweeping. I would like to see someexamples of programs taking "proper advantage" of each of these streams sothat I could assure myself that I was happy writing code in that style. Couldyou perhaps conjure some examples of code which takes advantage of each ofthese variables in some way? The code can be sketchy -- I don't need to run it-- I just want to understand what idioms arise, etc. I'd like examples whichshowed how the code behaved when various different valid/expected combinationsof interactive and non-interactive initial streams became involved.For example, questions I don't see obvious answers to are: - what would be an appropriate way to print a message/warning/error   on a given stream, can/may/must i expect to have seen it already on   *query-io*? i don't want to have to type it twice thinking i'm going   to different streams only to find out i'm really not. - Are any of these streams permitted to be bound to null streams in an   interactive environment? in a non-interactive one? (i.e., should we   assume that the information which comes out of them is always available   to the interactive user, or might he have to enable something   in some contexts to see what's going to certain streams?) - What variable bindings might a debugger make? Would it bind *TERMINAL-IO*   to *DEBUG-IO*? Could/should it also bind *STANDARD-INPUT* and    *STANDARD-OUTPUT* to *DEBUG-IO* or to a syn stream to that or to something   else? What about *QUERY-IO*?I'm afraid I don't have any sense that this list is exhaustive. I'm just tryingto sketch the nature of my concerns since in fact I can't be much more specific.About the best I can say is that your proposal does not fill me with a sense oftrust that you have really got this issue under control. Instead, it sounds likeso much legalese aimed at making a few more implementations conform yet withoutmaking portable programs much easier to write.Also, on an unrelated matter, I'm not sure I see the motivation for having*QUERY-IO* couple *QUERY-INPUT* with *ERROR-OUTPUT*. This seems like somethingof a kludge. Can you motivate why *QUERY-OUTPUT* isn't a separate stream andwhy *ERROR-OUTPUT* is not simply permitted to be directed to the same place as*ERROR-OUTPUT*?*start*01562 00024 US Return-Path: <KMP@STONY-BROOK.SCRC.Symbolics.COM>Received: from STONY-BROOK.SCRC.Symbolics.COM ([128.81.41.144]) by Xerox.COM ; 30 JUN 88 07:46:11 PDTReceived: from RIO-DE-JANEIRO.SCRC.Symbolics.COM by STONY-BROOK.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 427066; Thu 30-Jun-88 10:46:03 EDTDate: Thu, 30 Jun 88 10:45 EDTFrom: Kent M Pitman <KMP@STONY-BROOK.SCRC.Symbolics.COM>Subject: Re: Issue: STANDARD-INPUT-INITIAL-BINDING (Version 5)To: masinter.pacc: pierson%mist@MULTIMAX.ARPA, KMP@STONY-BROOK.SCRC.Symbolics.COMIn-Reply-To: <880629-165206-3594@Xerox>Message-ID: <880630104556.3.KMP@RIO-DE-JANEIRO.SCRC.Symbolics.COM>    Date: 29 Jun 88 16:51:34 PDT    From: masinter.pa@Xerox.COM    I don't think we need two proposals for one issue. We might need two issues.That's what I meant. Sorry about the mixed up the wording.    There's one issue that the book is wrong about initial bindings for the streams.While we're changing issue names anyway, something that didn't have STANDARD-INPUTin it at all would be nice. I suggest a new issue name STREAM-VARIABLE-INITIAL-BINDINGS.    The other issue is that there's some useful functionality that users can't write    because it is implementation dependent that we'd like the standard to provide.Maybe even two issues here: STREAM-CAPABILITIES - INTERACTIVE-STREAM-P and/or whatever it evolves into. STREAM-SHARING or STREAM-OVERLAP - Whether streams overlap in interesting ways   (have same source and/or sink, are encapsulations of each other, etc.)*start*05025 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([10.0.0.11]) by Xerox.COM ; 28 JUN 88 11:38:45 PDTReceived: from STONY-BROOK.SCRC.Symbolics.COM (SCRC-STONY-BROOK.ARPA) by SAIL.Stanford.EDU with TCP; 28 Jun 88  11:37:00 PDTReceived: from RIO-DE-JANEIRO.SCRC.Symbolics.COM by STONY-BROOK.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 425928; Tue 28-Jun-88 14:34:26 EDTDate: Tue, 28 Jun 88 14:34 EDTFrom: Kent M Pitman <KMP@STONY-BROOK.SCRC.Symbolics.COM>Subject: Issue: STANDARD-INPUT-INITIAL-BINDING (version 5)To: pierson%mist@MULTIMAX.ARPAcc: CL-Cleanup@SAIL.Stanford.EDUIn-Reply-To: <8806281742.AA08214@mist.UUCP>Message-ID: <880628143405.4.KMP@RIO-DE-JANEIRO.SCRC.Symbolics.COM>[Lest anyone become confused with all these issue names being so similar,I note that the issue name is STANDARD-INPUT-INITIAL-BINDING as in thebody of your message, not STANDARD-OUTPUT-INITIAL-BINDING as inyour subject line.]The proposal's wording is somewhat too vague for my taste. For example,it first says htat the streams are as per CLtL and then it lists a bunchof streams with commentary after some and not others. Does it mean to saythey are as per CLtL except as indicated? When indicated, does the infoaugment or replace what is in CLtL?There is no such thing as "returning EOF". I think you want to say that*TERMINAL-IO* can be an empty stream. In the case that it is indeed empty,it must behave like any other empty file (e.g., signalling an error whenthe ERROR-P argument to the read function used is not NIL). I'm not surewhy the issue of an empty *TERMINAL-IO* input stream is addressed, but theissue of a bit-sink output stream (output being discarded) is not addressed.Is there a natural asymmetry that I'm not seeing?The wording "The initial bindings of these streams are undefined" alsodoesn't suffice. Streams don't have bindings, variables have bindings.We must say that the stream variables are bound and that the initialvalues of these stream variables are streams. It is the kind of streamwhich they are which we can leave unspecified.In the phrase "the same implemntation-specific stream", "same" has noantecedent. I think you mean to be drawing some correspondence betweenLisp's *ERROR-OUTPUT* and some Unix/Vax/...-specific error output stream,but you haven't said that clearly.It is critical that it say somewhere that *TERMINAL-IO* may not initiallybe a synonym stream to *STANDARD-OUTPUT*, *STANDARD-INPUT*. (Don't say thatit may not be a synonym stream at all; it's ok for it to be a synonym tosome internal stream, for example, it's just not ok for it to be a synonymto one of the other stream variables.)In place of STREAM-SAME-DESTINATION-P and STREAM-SAME-SOURCE-P, I happen toprefer the following: STREAM-SOURCE-ID-LIST stream				[Function] STREAM-DESTINATION-ID-LIST stream			[Function] Returns a list of tokens which identify the source or destination of the stream at the current time. The tokens may be any lisp objects distinguishable using EQL. The only valid operation on the list of tokens are non-desctructive set operations. A synonym stream always returns the same id list as the stream to which it is indirected. An encapsulated stream (such as an echo stream or a broadcast stream) always returns at least the union of the tokens which would be returned by each of the encapsulated streams.Your STREAM-SAME-DESTINATION-P and STREAM-SAME-SOURCE-P would be possibleto write using set intersection operators, but it would be possible todetect some other useful relationships as well.STREAM-INTERACTIVE-P is definitely a good idea, though I would have calledit INTERACTIVE-STREAM-P for symmetry with INPUT-STREAM-P.You've got a reference to *STANDARD-ERROR* in there where I think youwant *ERROR-OUTPUT*.Under "cost to implementors", why do you say all implementations will haveto change? Additions are not traditionally counted as changes. Separatethings out so you don't scare people reading casually. The basic structureof the streams is not changed by this proposal. The restrictions on whatthose streams can be is in fact weakened so that if anything, some non-conforming implementations might become conforming. Make this twoparagraphs, I think, separating the issue of the stream hierarchy from theissue of the new streams.[In fact, I would very much prefer to see this go as two separateproposals since they're really separable issues. That way, if we getbogged down in the set of functions operating on streams and that takeslonger to get voted in (or never gets voted in), we'll still have theimportant changes to the stream bindings taken care of -- I don't expectthat issue to be nearly so controversial now that this proposal is simplifiedas you have it here.]I'll reserve specific statements of approval until I see a redraft orreplies to these comments. I think it's getting better, though.*start*03256 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([10.0.0.11]) by Xerox.COM ; 29 JUN 88 11:16:10 PDTReceived: from STONY-BROOK.SCRC.Symbolics.COM (SCRC-STONY-BROOK.ARPA) by SAIL.Stanford.EDU with TCP; 29 Jun 88  11:14:15 PDTReceived: from RIO-DE-JANEIRO.SCRC.Symbolics.COM by STONY-BROOK.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 426591; Wed 29-Jun-88 14:12:03 EDTDate: Wed, 29 Jun 88 14:11 EDTFrom: Kent M Pitman <KMP@STONY-BROOK.SCRC.Symbolics.COM>Subject: Issue: STANDARD-INPUT-INITIAL-BINDING (Version 5)To: vanroggen%aitg.decnet@hudson.dec.comcc: cl-cleanup@sail.stanford.edu, KMP@STONY-BROOK.SCRC.Symbolics.COMIn-Reply-To: The message of 29 Jun 88 13:04 EDT from "AITG::VANROGGEN" <vanroggen%aitg.decnet@hudson.dec.com>Message-ID: <880629141141.9.KMP@RIO-DE-JANEIRO.SCRC.Symbolics.COM>    Date: 29 Jun 88 13:04:00 EDT    From: "AITG::VANROGGEN" <vanroggen%aitg.decnet@hudson.dec.com>    ... I don't understand the reason for the restriction that the predefined    streams other than *TERMINAL-IO* can't be synonym streams for each other.    Is it really necessary to disallow some implementation initially binding    *ERROR-OUTPUT* to a synonym stream for *DEBUG-IO*, for example?I believe it is. People write programs that do things like: (LET ((*STANDARD-OUTPUT* *DEBUG-IO*))   ...)but if *DEBUG-IO* is a synonym stream for a two-way stream which is madeup of synonym streams to *STANDARD-INPUT* and *STANDARD-OUTPUT*, then youget a circular stream and massive lossage results.Once the STREAM-CLASS-ACCESS issue goes through and it is possible to detecta synonym stream, it will finally be possible to at least write cautiouscode, but I would hate to think that every time I bound one of these streamsto another, that I must first check to make sure that a synonym circularityis not being introduced.As I recall, the current wording neither precludes synonym streams to two-waystreams which are synonym streams nor does it preclude later bindings of thesestreams in ways that might introduce circularities, so I agree that the intentof that text might want to be clarified.Fyi, I've been screwed rather badly by doing the following seemingly harmlessthing: (LET ((*STANDARD-INPUT*  *TERMINAL-IO*)       (*STANDARD-OUTPUT* *TERMINAL-IO*))   ...)on some implementations only to find out that *TERMINAL-IO* was implementedas a two-way stream to synonym streams to *STANDARD-INPUT* and *STANDARD-OUTPUT*. The fireworks that result can be quite messy...    I don't see the need for adding three more predicates...Heh,heh. This is why I suggested this should be two proposals, Dan.    Furthermore the descriptions of those predicates seem controversial.    What is STREAM-INTERACTIVE-P really trying to establish?  ...These are good points that I think should get nailed down. Among other thingsto add to the list of things interactiveness might want to include are: * Should I prompt for input? * Is input editing (ie, rubout handling) something that should   be dealt with? * Should I expect that READ-CHAR might hang waiting for input   (vs returning an eof if no chars are available).*start*02440 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([10.0.0.11]) by Xerox.COM ; 29 JUN 88 11:37:21 PDTReceived: from multimax.ARPA by SAIL.Stanford.EDU with TCP; 29 Jun 88  11:35:43 PDTReceived:  by multimax.ARPA (5.51/25-eef)	id AA12718; Wed, 29 Jun 88 14:33:28 EDTReceived: from localhost by mist.UUCP (3.2/4.7)	id AA11220; Wed, 29 Jun 88 14:37:26 EDTMessage-Id: <8806291837.AA11220@mist.UUCP>To: Kent M Pitman <KMP%STONY-BROOK.SCRC.Symbolics.COM@multimax.ARPA>Cc: cl-cleanup%sail.stanford.edu@multimax.ARPASubject: Re: Issue: STANDARD-INPUT-INITIAL-BINDING (Version 5) In-Reply-To: Your message of Wed, 29 Jun 88 14:11:00 -0400.             <880629141141.9.KMP@RIO-DE-JANEIRO.SCRC.Symbolics.COM> Date: Wed, 29 Jun 88 14:37:21 EDTFrom: Dan L. Pierson <pierson%mist@multimax.ARPA>    As I recall, the current wording neither precludes synonym streams    to two-way streams which are synonym streams nor does it preclude    later bindings of these streams in ways that might introduce    circularities, so I agree that the intent of that text might want    to be clarified.    I'll try to clean this up.  The intent is that the streams in questioncan all be synonyms for the same internal stream, but not for eachother, two-way-streams for each other, etc.        I don't see the need for adding three more predicates...        Heh,heh. This is why I suggested this should be two proposals, Dan.    I thought this might happen, but decided to wait and see.  The nextversion will have two proposals if that's what people want.  If anyonestrongly opposes two proposals, speak now or...        Furthermore the descriptions of those predicates seem controversial.        What is STREAM-INTERACTIVE-P really trying to establish?  ...        These are good points that I think should get nailed down. Among    other things to add to the list of things interactiveness might    want to include are:     * Should I prompt for input?     * Is input editing (ie, rubout handling) something that should       be dealt with?     * Should I expect that READ-CHAR might hang waiting for input       (vs returning an eof if no chars are available).    Good questions.  I'll really rework this one.  I thinks thatSTREAM-INTERACTIVE-P is the shakiest of the new predicates justbecause it's the hardest to nail down.*start*07514 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([10.0.0.11]) by Xerox.COM ; 05 JUL 88 14:56:36 PDTReceived: from multimax.ARPA by SAIL.Stanford.EDU with TCP; 5 Jul 88  14:54:00 PDTReceived:  by multimax.ARPA (5.51/25-eef)	id AA00116; Tue, 5 Jul 88 17:51:23 EDTReceived: from localhost by mist.UUCP (3.2/4.7)	id AA19983; Tue, 5 Jul 88 17:55:34 EDTMessage-Id: <8807052155.AA19983@mist.UUCP>To: cl-cleanup%sail.stanford.edu@multimax.ARPASubject: Issue: STANDARD-INPUT-INITIAL-BINDING (version 6)Date: Tue, 05 Jul 88 17:55:32 EDTFrom: Dan L. Pierson <pierson%mist@multimax.ARPA>Issue:         STANDARD-INPUT-INITIAL-BINDINGReferences:    Standard streams (pp. 327-329)Category:      CHANGEEdit history:  Version 1 by Pierson and Haflich 1/19/87    	       Version 2 by Pierson 2/29/88	       Version 3 by Pierson 5/23/88, per comments by Moon               Version 4 by Pierson 5/26/88, clean up    	       Version 5 by Pierson 6/28/88, simple design per Masinter    	       Version 6 by Pierson 7/ 5/88, clean up and split issueStatus:        For Internal DiscussionThe new inquiry functions have been split off into a new issue:STREAM-CAPABILITIES.  The proposal name has been changed back toDEFINED-CONTRACTS to reflect this.Problem description:CLtL requires that *STANDARD-INPUT*, *STANDARD-OUTPUT*,*ERROR-OUTPUT*, *TRACE-OUTPUT*, *QUERY-IO*, and *DEBUG-IO* areinitially bound to synonym streams to *TERMINAL-IO*.  This requirementhampers the integration of Common Lisp with many existing andpotential operating environments.For example, a Unix implementation is currently unable to legallysupport Unix standard error output even though Common Lisp defines*ERROR-OUTPUT* because *ERROR-OUTPUT* is required to start out boundto the same stream as *STANDARD-OUTPUT*.  A workstation environnmentwhich provides stream access to windows as an extension is currentlyforbidden to make trace output appear in a separate window by defaultbecause *TRACE-OUTPUT* is required to start out bound to the samestream as *STANDARD-OUTPUT*.Proposal (STANDARD-INPUT-INITIAL-BINDING:DEFINED-CONTRACTS):A Common Lisp implementation is required to provide the followinginitial streams.  Each initial stream has a specific purpose asdefined in CLtL.  This proposal redefines the initial bindings ofthe streams and leaves the rest of the CLtL description unchanged.    *TERMINAL-IO*    	Is always bound to a writable two-way stream that is not a	synonym for any of the the other streams mentioned in this	proposal.  It is legal for input from *TERMINAL-IO* be a	permanently empty stream because there may be no convenient	place to read input from (it is also legal for output to	*TERMINAL-IO* to go to a bit-sink; there is no portable way	for a program to detect this case).    *STANDARD-INPUT*    *STANDARD-OUTPUT*    *ERROR-OUTPUT*    *TRACE-OUTPUT*    *QUERY-IO*    *DEBUG-IO*    	The initial bindings of these variables are undefined except	that:	    1. They are all initially bound to streams.	    2. The streams must support input and/or output as	       indicated by the variable name.	    3. None of the streams may be synonym-streams for another	       one of the streams, whether directly or by indirection	       via some composite stream type such as a two-way	       stream.	    4. Any or all of these streams may be synonym streams for	       *TERMINAL-IO*.	    5. Any or all of these streams may be synonyms for the a	       common implementation dependent stream.  For example,	       in an interactive Common Lisp invocation running on a	       character terminal, all of the streams mentioned here	       might be synonym streams (or two-way streams to synonym	       streams) to a pair of hidden terminal input/output	       streams maintained by the implementation.	The intent of the above rules is to ensure that it is always	safe to bind any of the above variables to another of the	above variables without unduly restricting implementation	flexibility.Test Cases/Examples:(PROGN   (PRINT "Output" *STANDARD-OUTPUT*)   (PRINT "Error" *ERROR-OUTPUT*))In current Common Lisp will write:    ------    Output    Error    ------With proposal *might* write:    ------    Output    ------    and "Error" appears somewhere else.(LET ((*STANDARD-OUTPUT* *DEBUG-IO*))  ...)In current Common Lisp:     Might cause a circular stream reference because *DEBUG-IO* was    bound to a two-way stream made up of synonym streams to    *STANDARD-INPUT* and *STANDARD-OUTPUT*.With this proposal:    Would be guaranteed not to cause a circular stream reference.(LET ((*STANDARD-INPUT*  *TERMINAL-IO*)      (*STANDARD-OUTPUT* *TERMINAL-IO*))  ...)In current Common Lisp:     Might cause a circular stream reference because *TERMINAL-IO* was    bound to a two-way stream made up of synonym streams to    *STANDARD-INPUT* and *STANDARD-OUTPUT*.With this proposal:    Would be guaranteed not to cause a circular stream reference.Rationale:This proposal attempts to provide a balance between over-specifyingbehavior to the point that Lisp programs can't behave like otherprograms in conventional operating systems and providing enoughspecification that Common Lisp programs can perform portable input andoutput.Current practice:Lucid binds *TERMINAL-IO* to a special internal stream type.  Franzbinds *TERMINAL-IO* to a special internal stream type for terminalstreams which reads from Unix standard input and writes to Unixstandard output.  KCL binds *TERMINAL-IO* to a standard two-way-streamwith input from Unix standard input and output to Unix standardoutput.Cost to Implementors:All implementations will have to change to some degree but the changeswill probably be simple and localized.  All known implementationsalready support the underlying streams required to implement thisproposal.Cost to Users:User code which depends on the strict binding hierarchy in CLtL mayhave to change.  Cost of non-Adoption:It will continue to be difficult or impossible to integrate portableCommon Lisp progams in conventional operating system environments.Many implementations will have to continue to choose betweenconforming to the standard and providing a superior user environment.Benefits:Implementations will be more able to match their IO behavior to theirenvironment and their user's expectations.Aesthetics:Improved because this area becomes better defined.Discussion:Pitman was concerned that the initial version of this proposal didn'tprovide a guaranteed way to get back the initial streams afterrebinding, e.g. *standard-io*.  The second version of this proposaloffered a solution to that problem which was generally considered toocomplex.  This problem should now be solved.Moon says that *TERMINAL-IO* (and, by extension, *QUERY-IO*, and*DEBUG-IO*) should fail to work in a non-interactive environment wherenothing like a terminal exists.Masinter notes that:    ``In many multi-processing multi-window environments,      the "initial binding" for *STANDARD-INPUT*, *QUERY-INPUT*      differs for each process.''  Pitman suggests that this issue be renamed to remove "STANDARD-INPUT"from the name.  Pierson hasn't done this for fear of further confusingpeople's archives.Pierson supports STANDARD-OUTPUT-INITIAL-BINDING:DEFINED-CONTRACTS.*start*07871 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([10.0.0.11]) by Xerox.COM ; 28 JUN 88 10:44:57 PDTReceived: from multimax.ARPA by SAIL.Stanford.EDU with TCP; 28 Jun 88  10:41:05 PDTReceived:  by multimax.ARPA (5.51/25-eef)	id AA01118; Tue, 28 Jun 88 13:38:40 EDTReceived: from localhost by mist.UUCP (3.2/4.7)	id AA08214; Tue, 28 Jun 88 13:42:36 EDTMessage-Id: <8806281742.AA08214@mist.UUCP>To: cl-cleanup%sail.stanford.edu@multimax.ARPASubject: Issue: STANDARD-OUTPUT-INITIAL-BINDING (version 5)Date: Tue, 28 Jun 88 13:42:30 EDTFrom: Dan L. Pierson <pierson%mist@multimax.ARPA>Issue:         STANDARD-INPUT-INITIAL-BINDINGReferences:    Standard streams (pp. 327-329)Category:      CHANGEEdit history:  Version 1 by Pierson and Haflich 1/19/87    	       Version 2 by Pierson 2/29/88	       Version 3 by Pierson 5/23/88, per comments by Moon               Version 4 by Pierson 5/26/88, clean up    	       Version 5 by Pierson 6/28/88, simple design per MasinterStatus:        For Internal DiscussionProblem description:CLtL requires that *STANDARD-INPUT*, *STANDARD-OUTPUT*,*ERROR-OUTPUT*, *TRACE-OUTPUT*, *QUERY-IO*, and *DEBUG-IO* areinitially bound to synonym streams to *TERMINAL-IO*.  This requirementhampers the integration of Common Lisp with many existing andpotential operating environments.For example, a Unix implementation is currently unable to legallysupport Unix standard error output even though Common Lisp defines*ERROR-OUTPUT* because *ERROR-OUTPUT* is required to start out boundto the same stream as *STANDARD-OUTPUT*.  A workstation environnmentwhich provides stream access to windows as an extension is currentlyforbidden to make trace output appear in a separate window by defaultbecause *TRACE-OUTPUT* is required to start out bound to the samestream as *STANDARD-OUTPUT*.Proposal (STANDARD-INPUT-INITIAL-BINDING:CONTRACTS-AND-FUNCTIONS):A Common Lisp implementation is required to provide the followinginitial streams.  Each initial stream has a specific purpose as definedin CLtL.    *TERMINAL-IO*    	Is always bound to a writable two-way stream.  It is legal for	input from *TERMINAL-IO* to always return EOF.    *STANDARD-INPUT*    *STANDARD-OUTPUT*    *ERROR-OUTPUT*    *TRACE-OUTPUT*    *QUERY-IO*    *DEBUG-IO*    	The initial bindings of these streams are undefined except	that none of these streams may be synonym-streams for another	one of these streams.  Any or all of these streams may be	synonym streams for *TERMINAL-IO*.  Any or all of these	streams may be synonyms for the same implementation-sepcific	stream. Add the following inquiry functions to Common Lisp:    STREAM-SAME-DESTINATION-P stream1 stream2	    	    [Function]      Returns T if the Lisp can prove that the two streams send their      output to the same "destination".  For example, this function      would return true for two streams that output to Unix files iff      the streams resulted either in output to the same file      descriptor or in output to two different file descriptors for      the same inode.    STREAM-SAME-SOURCE-P stream1 stream2    	    	    [Function]      Returns T if the Lisp can prove that the two streams receive      their input from the same "source", where same source mans that      input on one stream will change what the other stream would next      read.  For example, this function would return true for two      streams that read from Unix files iff the streams resulted in      input from the same file descriptor but not if the streams      resulted in in input from two different file descriptors for the      same inode because then reading one stream would not change what      the other stream saw.    STREAM-INTERACTIVE-P stream	    	    	    	    [Function]      Returns T if the Lisp can prove that the stream is interactive,      where interactive means that the stream is a two way stream      connected in such a way that output can result in a change in      succeeding input.Test Cases/Examples:(PROGN   (PRINT "Output" *STANDARD-OUTPUT*)   (PRINT "Error" *STANDARD-ERROR*))In current Common Lisp will write:------OutputError------With proposal *might* write:------Output------and "Error" appears somewhere else.(LET* ((IN1 (OPEN "foo" :DIRECTION :INPUT))       (IN2 (OPEN "foo" :DIRECTION :INPUT))       (OUT1 (OPEN "foo" :DIRECTION :OUTPUT))       (OUT2 (OPEN "foo" :DIRECTION :OUTPUT))       (STREAM1 (MAKE-TWO-WAY-STREAM IN1 OUT1))       (STREAM2 (MAKE-TWO-WAY-STREAM IN2 OUT2)))  (LIST (STREAM-SAME-DESTINATION-P STREAM1 OUT1)        (STREAM-SAME-DESTINATION-P STREAM1 STREAM2)	(STREAM-SAME-SOURCE-P STREAM1 IN1)	(STREAM-SAME-SOURCE-P STREAM1 STREAM2)	(STREAM-INTERACTIVE-P STREAM1)	(STREAM-INTERACTIVE-P *TERMINAL-IO*)))==> (T T T NIL NIL ?) ; *TERMINAL-IO* might or might not be interactiveRationale:This proposal attempts to provide a balance between over-specifyingbehavior to the point that Lisp programs can't behave like otherprograms in conventional operating systems and providing enoughspecification that Common Lisp programs can perform portable input andoutput.  The inquiry functions answer questions that portable Lispprograms can't answer on their own because the information isfrequently only maintained at an operating system level.Current practice:Lucid binds *TERMINAL-IO* to a special internal stream type.  Franzbinds *TERMINAL-IO* to a special internal stream type for terminalstreams which reads from Unix standard input and writes to Unixstandard output.  KCL binds *TERMINAL-IO* to a standard two-way-streamwith input from Unix standard input and output to Unix standardoutput.Cost to Implementors:All implementations will have to change to some degree but the changeswill probably be simple and localized.  All known implementationsalready support the underlying streams required to implement thisproposal.  The new inquiry functions will require some work to writecorrectly for each environment.Cost to Users:User code which depends on the strict binding hierarchy in CLtL mayhave to change.  Cost of non-Adoption:It will continue to be difficult or impossible to integrate portableCommon Lisp progams in conventional operating system environments.Many implementations will have to continue to choose betweenconforming to the standard and providing a superior user environment.Benefits:Implementations will be more able to match their IO behavior to theirenvironment and their user's expectations.  Portable programs willhave more tools for reasoning about stream relationships.Aesthetics:Improved because this area becomes better defined.Discussion:Pitman was concerned that the initial version of this proposal didn'tprovide a guaranteed way to get back the initial streams afterrebinding, e.g. *standard-io*.  The second version of this proposaloffered a solution to that problem which was generally considered toocomplex.  This problem should now be solved.Moon says that *TERMINAL-IO* (and, by extension, *QUERY-IO*, and*DEBUG-IO*) should fail to work in a non-interactive environment wherenothing like a terminal exists.Masinter notes that:    ``In many multi-processing multi-window environments,      the "initial binding" for *STANDARD-INPUT*, *QUERY-INPUT*      differs for each process.''  Masinter doesn't believe that STREAM-SAME-SOURCE-P is needed; Piersondisagrees.The definition of STREAM-INTERACTIVE-P is intentionally vague becauseit is not reasonable for the Lisp to try and distinguish between, say,a terminal connection to a human and a pseudo terminal connection toanother program.Pierson supports STANDARD-OUTPUT-INITIAL-BINDING:CONTRACTS-AND-FUNCTIONS.*start*05747 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([10.0.0.11]) by Xerox.COM ; 06 JUL 88 07:22:08 PDTReceived: from multimax.ARPA by SAIL.Stanford.EDU with TCP; 6 Jul 88  07:20:19 PDTReceived:  by multimax.ARPA (5.51/25-eef)	id AA01125; Wed, 6 Jul 88 10:17:35 EDTReceived: from PEWEE.SCRC.Symbolics.COM by STONY-BROOK.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 429040; Wed 6-Jul-88 10:19:18 EDTDate: Wed, 6 Jul 88 10:19 EDTFrom: Kent M Pitman <KMP@STONY-BROOK.SCRC.Symbolics.COM>Subject: Issue: STANDARD-INPUT-INITIAL-BINDING (version 6)To: pierson%mist@MULTIMAX.ARPACc: cl-cleanup%sail.stanford.edu@MULTIMAX.ARPAIn-Reply-To: <8807052155.AA19983@mist.UUCP>Message-Id: <880706101913.3.KMP@PEWEE.SCRC.Symbolics.COM>    Date: Tue, 05 Jul 88 17:55:32 EDT    From: Dan L. Pierson <pierson%mist@multimax.ARPA>    Issue:         STANDARD-INPUT-INITIAL-BINDING    ...    Proposal (STANDARD-INPUT-INITIAL-BINDING:DEFINED-CONTRACTS):    ...	*DEBUG-IO*	    The initial bindings of these variables are undefined except	    that:		1. They are all initially bound to streams.		2. The streams must support input and/or output as		   indicated by the variable name.		3. None of the streams may be synonym-streams for another		   one of the streams, whether directly or by indirection		   via some composite stream type such as a two-way		   stream.I would say something more like: "None of the standard streams (including *TERMINAL-IO*) may be directed  by synonym stream to another of these stream variables (except *TERMINAL-IO*),  whether directly or by indirection via some composite stream such as a  two-way stream with one of the arms being a synonym stream."The reason being that you need to restrict *TERMINAL-IO*, and also thatyou don't want to restrict people pointing at the contents of one ofthese variables, you just don't want them actually being synonyms for thevariable itself.		4. Any or all of these streams may be synonym streams for		   *TERMINAL-IO*.		5. Any or all of these streams may be synonyms for the aI believe the "the" here is spurious.		   common implementation dependent stream.  For example,    ...    Test Cases/Examples:    ...    (LET ((*STANDARD-OUTPUT* *DEBUG-IO*))      ...)    In current Common Lisp: 	Might cause a circular stream reference because *DEBUG-IO* wasI'd say "if" not "because" here.	bound to a two-way stream made up of synonym streams to	*STANDARD-INPUT* and *STANDARD-OUTPUT*.Maybe also note that this could happen only if *DEBUG-IO* was not its originalsetting, since the original setting of *DEBUG-IO* is currently a synonym streamto *TERMINAL-IO*. So the example is in some sense more complicated than youshow. Maybe you could just change the example to be something that shows thebehavior. Eg, (DEFUN FOO ()    (LET ((*DEBUG-IO* (MAKE-TWO-WAY-STREAM (MAKE-SYNONYM-STREAM '*STANDARD-INPUT*)					  (MAKE-SYNONYM-STREAM '*STANDARD-OUTPUT*))))     (BAR))) (DEFUN BAR ()   (LET ((*STANDARD-OUTPUT* *DEBUG-IO*))     (PRINT 'FOO)))    With this proposal:	Would be guaranteed not to cause a circular stream reference.    (LET ((*STANDARD-INPUT*  *TERMINAL-IO*)	  (*STANDARD-OUTPUT* *TERMINAL-IO*))      ...)Well, not guaranteed not to cause a circular reference. Rather, users would bewarned that the code that led to a circular reference was an error.    In current Common Lisp: 	Might cause a circular stream reference because *TERMINAL-IO* was	bound to a two-way stream made up of synonym streams to	*STANDARD-INPUT* and *STANDARD-OUTPUT*.    With this proposal:	Would be guaranteed not to cause a circular stream reference.Right. Maybe mention that this could conceivably happen in the initialconfiguration of some implementations.    ...    Current practice:    Lucid binds *TERMINAL-IO* to a special internal stream type.  Franz    binds *TERMINAL-IO* to a special internal stream type for terminal    streams which reads from Unix standard input and writes to Unix    standard output.  KCL binds *TERMINAL-IO* to a standard two-way-stream    with input from Unix standard input and output to Unix standard    output.Symbolics Genera binds *TERMINAL-IO* as appropriate for each process,usually to a `window' for interactive applications or to a stream whichwill conjure an interaction window on demand for background tasks.    ...    Discussion:    Pitman was concerned that the initial version of this proposal didn't    provide a guaranteed way to get back the initial streams after    rebinding, e.g. *standard-io*.  The second version of this proposal    offered a solution to that problem which was generally considered too    complex.  This problem should now be solved.I'm not sure that this continues to be relevant enough to take up spacein the proposal. People can read the old proposal versions if they care.    Moon says that *TERMINAL-IO* (and, by extension, *QUERY-IO*, and    *DEBUG-IO*) should fail to work in a non-interactive environment where    nothing like a terminal exists.It might be well to plainly identify that this issue is not reallyaddressed by the above proposal.    Masinter notes that:	``In many multi-processing multi-window environments,	  the "initial binding" for *STANDARD-INPUT*, *QUERY-INPUT*	  differs for each process.''      Pitman suggests that this issue be renamed to remove "STANDARD-INPUT"    from the name.  Pierson hasn't done this for fear of further confusing    people's archives.    ...This doesn't need to be here either. If no one cares, I'll live with thefunny name. Brevity is most important, I think.*start*06825 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([10.0.0.11]) by Xerox.COM ; 08 JUL 88 14:22:53 PDTReceived: from multimax.ARPA by SAIL.Stanford.EDU with TCP; 8 Jul 88  14:16:21 PDTReceived:  by multimax.ARPA (5.51/25-eef)	id AA00143; Fri, 8 Jul 88 17:13:45 EDTReceived: from localhost by mist.UUCP (3.2/4.7)	id AA24313; Fri, 8 Jul 88 16:58:13 EDTMessage-Id: <8807082058.AA24313@mist.UUCP>To: cl-cleanup%sail.stanford.edu@multimax.ARPASubject: Issue: STANDARD-INPUT-INITIAL-BINDING (version 7)Date: Fri, 08 Jul 88 16:58:07 EDTFrom: Dan L. Pierson <pierson%mist@multimax.ARPA>Issue:         STANDARD-INPUT-INITIAL-BINDINGReferences:    Standard streams (pp. 327-329)Category:      CHANGEEdit history:  Version 1 by Pierson and Haflich 1/19/87    	       Version 2 by Pierson 2/29/88	       Version 3 by Pierson 5/23/88, per comments by Moon               Version 4 by Pierson 5/26/88, clean up    	       Version 5 by Pierson 6/28/88, simple design per Masinter    	       Version 6 by Pierson 7/ 5/88, clean up and split issue	       Version 7 by Pierson 7/ 8/88, clean up per PitmanStatus:        For Internal DiscussionProblem description:CLtL requires that *STANDARD-INPUT*, *STANDARD-OUTPUT*,*ERROR-OUTPUT*, *TRACE-OUTPUT*, *QUERY-IO*, and *DEBUG-IO* areinitially bound to synonym streams to *TERMINAL-IO*.  This requirementhampers the integration of Common Lisp with many existing andpotential operating environments.For example, a Unix implementation is currently unable to legallysupport Unix standard error output even though Common Lisp defines*ERROR-OUTPUT* because *ERROR-OUTPUT* is required to start out boundto the same stream as *STANDARD-OUTPUT*.  A workstation environnmentwhich provides stream access to windows as an extension is currentlyforbidden to make trace output appear in a separate window by defaultbecause *TRACE-OUTPUT* is required to start out bound to the samestream as *STANDARD-OUTPUT*.Proposal (STANDARD-INPUT-INITIAL-BINDING:DEFINED-CONTRACTS):A Common Lisp implementation is required to provide the followinginitial streams.  Each initial stream has a specific purpose asdefined in CLtL.  This proposal redefines the initial bindings ofthe streams and leaves the rest of the CLtL description unchanged.    *TERMINAL-IO*    *STANDARD-INPUT*    *STANDARD-OUTPUT*    *ERROR-OUTPUT*    *TRACE-OUTPUT*    *QUERY-IO*    *DEBUG-IO*    	The initial bindings of these variables are undefined except	that:	    1. They are all initially bound to open streams.	    2. The streams must support input and/or output as	       indicated by the variable name.    	    3. None of the standard streams (including *TERMINAL-IO*)	       may be directed by synonym streams to another of these	       stream variables (except *TERMINAL-IO*), whether	       directly or by indirection via some composite stream	       such as a two way stream with one of the arms being a	       synonym stream.	    4. Any or all of these streams may be synonyms for the a	       common implementation dependent stream.  For example,	       in an interactive Common Lisp invocation running on a	       character terminal, all of the streams mentioned here	       might be synonym streams (or two-way streams to synonym	       streams) to a pair of hidden terminal input/output	       streams maintained by the implementation.	The intent of the above rules is to ensure that it is always	safe to bind any of the above variables to another of the	above variables without unduly restricting implementation	flexibility.Test Cases/Examples:(PROGN   (PRINT "Output" *STANDARD-OUTPUT*)   (PRINT "Error" *ERROR-OUTPUT*))In current Common Lisp will write:    ------    Output    Error    ------With proposal *might* write:    ------    Output    ------    and "Error" appears somewhere else.(LET ((*STANDARD-OUTPUT* *DEBUG-IO*))  ...)In current Common Lisp:     Might cause a circular stream reference if *DEBUG-IO* was    bound to a two-way stream made up of synonym streams to    *STANDARD-INPUT* and *STANDARD-OUTPUT*.With this proposal:    Would be guaranteed not to cause a circular stream reference.(LET ((*STANDARD-INPUT*  *TERMINAL-IO*)      (*STANDARD-OUTPUT* *TERMINAL-IO*))  ...)In current Common Lisp:     Might cause a circular stream reference because *TERMINAL-IO* was    bound to a two-way stream made up of synonym streams to    *STANDARD-INPUT* and *STANDARD-OUTPUT*.With this proposal:    Would be guaranteed not to cause a circular stream reference.Rationale:This proposal attempts to provide a balance between over-specifyingbehavior to the point that Lisp programs can't behave like otherprograms in conventional operating systems and providing enoughspecification that Common Lisp programs can perform portable input andoutput.Current practice:Lucid binds *TERMINAL-IO* to a special internal stream type.  Franzbinds *TERMINAL-IO* to a special internal stream type for terminalstreams which reads from Unix standard input and writes to Unixstandard output.  KCL binds *TERMINAL-IO* to a standard two-way-streamwith input from Unix standard input and output to Unix standardoutput.  Symbolics Genera binds *TERMINAL-IO* as appropriate for eachprocess, usually to a window for interactive applications or to astream which will conjure an interaction window on demand forbackground tasks.Cost to Implementors:All implementations will have to change to some degree but the changeswill probably be simple and localized.  All known implementationsalready support the underlying streams required to implement thisproposal.Cost to Users:User code which depends on the strict binding hierarchy in CLtL mayhave to change.  Cost of non-Adoption:It will continue to be difficult or impossible to integrate portableCommon Lisp progams in conventional operating system environments.Many implementations will have to continue to choose betweenconforming to the standard and providing a superior user environment.Benefits:Implementations will be more able to match their IO behavior to theirenvironment and their user's expectations.Aesthetics:Improved because this area becomes better defined.Discussion:Moon says that *TERMINAL-IO* (and, by extension, *QUERY-IO*, and*DEBUG-IO*) should fail to work in a non-interactive environment wherenothing like a terminal exists.  This proposal fails to address this.Masinter notes that:    ``In many multi-processing multi-window environments,      the "initial binding" for *STANDARD-INPUT*, *QUERY-INPUT*      differs for each process.''  Pierson supports STANDARD-OUTPUT-INITIAL-BINDING:DEFINED-CONTRACTS.*start*01628 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([10.0.0.11]) by Xerox.COM ; 08 JUL 88 14:58:40 PDTReceived: from STONY-BROOK.SCRC.Symbolics.COM (SCRC-STONY-BROOK.ARPA) by SAIL.Stanford.EDU with TCP; 8 Jul 88  14:57:10 PDTReceived: from PEWEE.SCRC.Symbolics.COM by STONY-BROOK.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 430755; Fri 8-Jul-88 17:56:11 EDTDate: Fri, 8 Jul 88 17:56 EDTFrom: Kent M Pitman <KMP@STONY-BROOK.SCRC.Symbolics.COM>Subject: Issue: STANDARD-INPUT-INITIAL-BINDING (version 7)To: pierson%mist@MULTIMAX.ARPAcc: CL-Cleanup@SAIL.Stanford.EDUIn-Reply-To: <8807082058.AA24313@mist.UUCP>Message-ID: <880708175600.2.KMP@PEWEE.SCRC.Symbolics.COM>Minor residual nit picking... * In the Proposal section, numbered item 4, end of line 1, the   typo "the a" still appears. * In the second example, you are guaranteed that this works only   if you haven't changed the value of *DEBUG-IO*. Note that, unlike   the third example which uses the variable *TERMINAL-IO* which   users are forbidden to change, *DEBUG-IO* has no such restriction.   Since your proposal says clearly that these are constraints only   on the initial values, the claim on the second example is a bit   strong. [I would be ammenable to expanding the proposal to say that    it `is an error' (ie, has undefined effects) if you do any later   bindings or assignments which invalidates one of the assertions you   have listed.In spite of the above, it's ok to go ahead and start listing me as asupporter of this proposal.*start*07174 00024 USfReturn-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([10.0.0.11]) by Xerox.COM ; 08 JUL 88 15:23:55 PDTReceived: from multimax.ARPA by SAIL.Stanford.EDU with TCP; 8 Jul 88  15:22:13 PDTReceived:  by multimax.ARPA (5.51/25-eef)	id AA00490; Fri, 8 Jul 88 18:19:43 EDTReceived: from localhost by mist.UUCP (3.2/4.7)	id AA24471; Fri, 8 Jul 88 18:23:54 EDTMessage-Id: <8807082223.AA24471@mist.UUCP>To: cl-cleanup%sail.stanford.edu@multimax.ARPASubject: Issue: STANDARD-INPUT-INITIAL-BINDING (version 8)Date: Fri, 08 Jul 88 18:23:52 EDTFrom: Dan L. Pierson <pierson%mist@multimax.ARPA>I've finally changed the status to "Ready for Release?".  Does anyonedisagree? Issue:         STANDARD-INPUT-INITIAL-BINDINGReferences:    Standard streams (pp. 327-329)Category:      CHANGEEdit history:  Version 1 by Pierson and Haflich 1/19/87    	       Version 2 by Pierson 2/29/88	       Version 3 by Pierson 5/23/88, per comments by Moon               Version 4 by Pierson 5/26/88, clean up    	       Version 5 by Pierson 6/28/88, simple design per Masinter    	       Version 6 by Pierson 7/ 5/88, clean up and split issue	       Version 7 by Pierson 7/ 8/88, clean up per Pitman	       Version 8 by Pierson 7/ 8/88, yet more clean upStatus:        Ready for Release?Problem description:CLtL requires that *STANDARD-INPUT*, *STANDARD-OUTPUT*,*ERROR-OUTPUT*, *TRACE-OUTPUT*, *QUERY-IO*, and *DEBUG-IO* areinitially bound to synonym streams to *TERMINAL-IO*.  This requirementhampers the integration of Common Lisp with many existing andpotential operating environments.For example, a Unix implementation is currently unable to legallysupport Unix standard error output even though Common Lisp defines*ERROR-OUTPUT* because *ERROR-OUTPUT* is required to start out boundto the same stream as *STANDARD-OUTPUT*.  A workstation environnmentwhich provides stream access to windows as an extension is currentlyforbidden to make trace output appear in a separate window by defaultbecause *TRACE-OUTPUT* is required to start out bound to the samestream as *STANDARD-OUTPUT*.Proposal (STANDARD-INPUT-INITIAL-BINDING:DEFINED-CONTRACTS):A Common Lisp implementation is required to provide the followinginitial streams.  Each initial stream has a specific purpose asdefined in CLtL.  This proposal redefines the initial bindings ofthe streams and leaves the rest of the CLtL description unchanged.    *TERMINAL-IO*    *STANDARD-INPUT*    *STANDARD-OUTPUT*    *ERROR-OUTPUT*    *TRACE-OUTPUT*    *QUERY-IO*    *DEBUG-IO*    	The initial bindings of these variables are undefined except	that:	    1. They are all initially bound to open streams.	    2. The streams must support input and/or output as	       indicated by the variable name.    	    3. None of the standard streams (including *TERMINAL-IO*)	       may be directed by synonym streams to another of these	       stream variables (except *TERMINAL-IO*), whether	       directly or by indirection via some composite stream	       such as a two way stream with one of the arms being a	       synonym stream.	    4. Any or all of these streams may be synonyms for the	       common implementation dependent stream.  For example,	       in an interactive Common Lisp invocation running on a	       character terminal, all of the streams mentioned here	       might be synonym streams (or two-way streams to synonym	       streams) to a pair of hidden terminal input/output	       streams maintained by the implementation.	The intent of the above rules is to ensure that it is always	safe to bind any of the above variables to another of the	above variables without unduly restricting implementation	flexibility.Test Cases/Examples:(PROGN   (PRINT "Output" *STANDARD-OUTPUT*)   (PRINT "Error" *ERROR-OUTPUT*))In current Common Lisp will write:    ------    Output    Error    ------With proposal *might* write:    ------    Output    ------    and "Error" appears somewhere else.(LET ((*STANDARD-OUTPUT* *DEBUG-IO*))  ...)In current Common Lisp:     Might cause a circular stream reference if *DEBUG-IO* was    bound to a two-way stream made up of synonym streams to    *STANDARD-INPUT* and *STANDARD-OUTPUT*.With this proposal:    Would be guaranteed not to cause a circular stream reference    unless the initial value of *DEBUG-IO* had been changed to a value    that did not conform the restrictions in this proposal.  While no    Common Lisp implementation should do this, a user program might.(LET ((*STANDARD-INPUT*  *TERMINAL-IO*)      (*STANDARD-OUTPUT* *TERMINAL-IO*))  ...)In current Common Lisp:     Might cause a circular stream reference because *TERMINAL-IO* was    bound to a two-way stream made up of synonym streams to    *STANDARD-INPUT* and *STANDARD-OUTPUT*.With this proposal:    Would be guaranteed not to cause a circular stream reference.Rationale:This proposal attempts to provide a balance between over-specifyingbehavior to the point that Lisp programs can't behave like otherprograms in conventional operating systems and providing enoughspecification that Common Lisp programs can perform portable input andoutput.Current practice:Lucid binds *TERMINAL-IO* to a special internal stream type.  Franzbinds *TERMINAL-IO* to a special internal stream type for terminalstreams which reads from Unix standard input and writes to Unixstandard output.  KCL binds *TERMINAL-IO* to a standard two-way-streamwith input from Unix standard input and output to Unix standardoutput.  Symbolics Genera binds *TERMINAL-IO* as appropriate for eachprocess, usually to a window for interactive applications or to astream which will conjure an interaction window on demand forbackground tasks.Cost to Implementors:All implementations will have to change to some degree but the changeswill probably be simple and localized.  All known implementationsalready support the underlying streams required to implement thisproposal.Cost to Users:User code which depends on the strict binding hierarchy in CLtL mayhave to change.  Cost of non-Adoption:It will continue to be difficult or impossible to integrate portableCommon Lisp progams in conventional operating system environments.Many implementations will have to continue to choose betweenconforming to the standard and providing a superior user environment.Benefits:Implementations will be more able to match their IO behavior to theirenvironment and their user's expectations.Aesthetics:Improved because this area becomes better defined.Discussion:Moon says that *TERMINAL-IO* (and, by extension, *QUERY-IO*, and*DEBUG-IO*) should fail to work in a non-interactive environment wherenothing like a terminal exists.  This proposal fails to address this.Masinter notes that:    ``In many multi-processing multi-window environments,      the "initial binding" for *STANDARD-INPUT*, *QUERY-INPUT*      differs for each process.''  Pierson and Pitman support STANDARD-INPUT-INITIAL-BINDING:DEFINED-CONTRACTS.*start*01870 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([10.0.0.11]) by Xerox.COM ; 29 JUN 88 10:14:06 PDTReceived: from hudson.dec.com by SAIL.Stanford.EDU with TCP; 29 Jun 88  10:13:03 PDTDate: 29 Jun 88 13:04:00 EDTFrom: "AITG::VANROGGEN" <vanroggen%aitg.decnet@hudson.dec.com>To: "cl-cleanup" <cl-cleanup@sail.stanford.edu>Reply-To: "AITG::VANROGGEN" <vanroggen%aitg.decnet@hudson.dec.com>What's the name of this issue?  STANDARD-OUTPUT-xxx or STANDARD-INPUT-xxx?The problem description and proposal sound pretty good, except that Idon't understand the reason for the restriction that the predefinedstreams other than *TERMINAL-IO* can't be synonym streams for each other.Is it really necessary to disallow some implementation initially binding*ERROR-OUTPUT* to a synonym stream for *DEBUG-IO*, for example?I don't see the need for adding three more predicates.  Where is thejustification?  Most of the other sections of the proposal adequatelyjustify the need for loosening the initial binding requirements forpredefined streams, but not for the additional predicates.Furthermore the descriptions of those predicates seem controversial.What is STREAM-INTERACTIVE-P really trying to establish?  It seemsunlikely that output to a stream satisfying the predicate will reallychange the following input--there aren't any such streams in CommonLisp now, are there?  Or is it really trying to ask if there's someoneout there (human or not) that will provide (synchronously?) some inputafter there's been some output?  Or is something like TWO-WAY-STREAM-Psufficient?  Does this imply *TERMINAL-IO* must be a TWO-WAY-STREAM?Or is it just asking if it's bidirectional?I assume the use of *STANDARD-ERROR* is a typo in the Test Case.			---Walter------*start*01136 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([10.0.0.11]) by Xerox.COM ; 14 SEP 88 07:22:31 PDTReceived: from decwrl.dec.com by SAIL.Stanford.EDU with TCP; 14 Sep 88  07:21:29 PDTReceived: by decwrl.dec.com (5.54.5/4.7.34)	id AA02973; Wed, 14 Sep 88 07:20:09 PDTDate: Wed, 14 Sep 88 07:20:09 PDTMessage-Id: <8809141420.AA02973@decwrl.dec.com>From: vanroggen%aitg.DEC@decwrl.dec.comTo: pierson%mist@multimax.arpaSubject: RE: Issue: STANDARD-INPUT-INITIAL-BINDING (version 8)This looks pretty good, except I think many implementations wouldprefer not to have a requirement that *TERMINAL-IO* be a Common Lispstream.  Already most implementations bind *TERMINAL-IO* toimplementation dependent streams, and I think in this case it'sbest to continue the status quo.  Another way to look at this issueis that I don't see any advantage to forcing *TERMINAL-IO* tobe yet another synonym stream or a two-way-stream (or whatever CLstream type) which really just uses the implementation dependentstream after all.			---Walter*start*01464 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 19 SEP 88 15:13:03 PDTReceived: from multimax.ARPA by SAIL.Stanford.EDU with TCP; 19 Sep 88  15:11:53 PDTReceived:  by multimax.ARPA (5.51/25-eef)	id AA04485; Mon, 19 Sep 88 18:11:43 EDTReceived: from localhost by mist.UUCP (3.2/4.7)	id AA09183; Mon, 19 Sep 88 18:13:20 EDTMessage-Id: <8809192213.AA09183@mist.UUCP>To: "vanroggen%aitg.DEC@decwrl.dec.com"@multimax.ARPACc: cl-cleanup%sail.stanford.edu@multimax.ARPASubject: Re: Issue: STANDARD-INPUT-INITIAL-BINDING (version 8) In-Reply-To: Your message of Wed, 14 Sep 88 07:20:09 -0700.             <8809141420.AA02973@decwrl.dec.com> Date: Mon, 19 Sep 88 18:13:14 EDTFrom: Dan L. Pierson <pierson%mist@multimax.ARPA>    This looks pretty good, except I think many implementations would    prefer not to have a requirement that *TERMINAL-IO* be a Common Lisp    stream.  Already most implementations bind *TERMINAL-IO* to    implementation dependent streams, and I think in this case it's    best to continue the status quo.*TERMINAL-IO* obviously has to be bound to a Common Lisp stream inthat it has to work for all of the Common Lisp IO functions, etc. thattake stream arguments.  Other than that, I don't see that the proposalprevents *TERMINAL-IO* from being bound to an implementation dependentstream type.*start*06675 00024 USfDate:  7 Oct 88 21:50 PDTFrom: masinter.paSubject: Issue: STANDARD-INPUT-INITIAL-BINDING (version 8)To: x3j13@sail.stanford.eduREPLY-TO: cl-cleanup@sail.stanford.eduline-fold: NOcc: MasinterIssue:         STANDARD-INPUT-INITIAL-BINDINGReferences:    Standard streams (pp. 327-329)Category:      CHANGEEdit history:  Version 1 by Pierson and Haflich 1/19/87    	       Version 2 by Pierson 2/29/88	       Version 3 by Pierson 5/23/88, per comments by Moon               Version 4 by Pierson 5/26/88, clean up    	       Version 5 by Pierson 6/28/88, simple design per Masinter    	       Version 6 by Pierson 7/ 5/88, clean up and split issue	       Version 7 by Pierson 7/ 8/88, clean up per Pitman	       Version 8 by Pierson 7/ 8/88, yet more clean upStatus:        Ready for Release?Problem description:CLtL requires that *STANDARD-INPUT*, *STANDARD-OUTPUT*,*ERROR-OUTPUT*, *TRACE-OUTPUT*, *QUERY-IO*, and *DEBUG-IO* areinitially bound to synonym streams to *TERMINAL-IO*.  This requirementhampers the integration of Common Lisp with many existing andpotential operating environments.For example, a Unix implementation is currently unable to legallysupport Unix standard error output even though Common Lisp defines*ERROR-OUTPUT* because *ERROR-OUTPUT* is required to start out boundto the same stream as *STANDARD-OUTPUT*.  A workstation environnmentwhich provides stream access to windows as an extension is currentlyforbidden to make trace output appear in a separate window by defaultbecause *TRACE-OUTPUT* is required to start out bound to the samestream as *STANDARD-OUTPUT*.Proposal (STANDARD-INPUT-INITIAL-BINDING:DEFINED-CONTRACTS):A Common Lisp implementation is required to provide the followinginitial streams.  Each initial stream has a specific purpose asdefined in CLtL.  This proposal redefines the initial bindings ofthe streams and leaves the rest of the CLtL description unchanged.    *TERMINAL-IO*    *STANDARD-INPUT*    *STANDARD-OUTPUT*    *ERROR-OUTPUT*    *TRACE-OUTPUT*    *QUERY-IO*    *DEBUG-IO*    	The initial bindings of these variables are undefined except	that:	    1. They are all initially bound to open streams.	    2. The streams must support input and/or output as	       indicated by the variable name.    	    3. None of the standard streams (including *TERMINAL-IO*)	       may be directed by synonym streams to another of these	       stream variables (except *TERMINAL-IO*), whether	       directly or by indirection via some composite stream	       such as a two way stream with one of the arms being a	       synonym stream.	    4. Any or all of these streams may be synonyms for the	       common implementation dependent stream.  For example,	       in an interactive Common Lisp invocation running on a	       character terminal, all of the streams mentioned here	       might be synonym streams (or two-way streams to synonym	       streams) to a pair of hidden terminal input/output	       streams maintained by the implementation.	The intent of the above rules is to ensure that it is always	safe to bind any of the above variables to another of the	above variables without unduly restricting implementation	flexibility.Test Cases/Examples:(PROGN   (PRINT "Output" *STANDARD-OUTPUT*)   (PRINT "Error" *ERROR-OUTPUT*))In current Common Lisp will write:    ------    Output    Error    ------With proposal *might* write:    ------    Output    ------    and "Error" appears somewhere else.(LET ((*STANDARD-OUTPUT* *DEBUG-IO*))  ...)In current Common Lisp:     Might cause a circular stream reference if *DEBUG-IO* was    bound to a two-way stream made up of synonym streams to    *STANDARD-INPUT* and *STANDARD-OUTPUT*.With this proposal:    Would be guaranteed not to cause a circular stream reference    unless the initial value of *DEBUG-IO* had been changed to a value    that did not conform the restrictions in this proposal.  While no    Common Lisp implementation should do this, a user program might.(LET ((*STANDARD-INPUT*  *TERMINAL-IO*)      (*STANDARD-OUTPUT* *TERMINAL-IO*))  ...)In current Common Lisp:     Might cause a circular stream reference because *TERMINAL-IO* was    bound to a two-way stream made up of synonym streams to    *STANDARD-INPUT* and *STANDARD-OUTPUT*.With this proposal:    Would be guaranteed not to cause a circular stream reference.Rationale:This proposal attempts to provide a balance between over-specifyingbehavior to the point that Lisp programs can't behave like otherprograms in conventional operating systems and providing enoughspecification that Common Lisp programs can perform portable input andoutput.Current practice:Lucid binds *TERMINAL-IO* to a special internal stream type.  Franzbinds *TERMINAL-IO* to a special internal stream type for terminalstreams which reads from Unix standard input and writes to Unixstandard output.  KCL binds *TERMINAL-IO* to a standard two-way-streamwith input from Unix standard input and output to Unix standardoutput.  Symbolics Genera binds *TERMINAL-IO* as appropriate for eachprocess, usually to a window for interactive applications or to astream which will conjure an interaction window on demand forbackground tasks.Cost to Implementors:All implementations will have to change to some degree but the changeswill probably be simple and localized.  All known implementationsalready support the underlying streams required to implement thisproposal.Cost to Users:User code which depends on the strict binding hierarchy in CLtL mayhave to change.  Cost of non-Adoption:It will continue to be difficult or impossible to integrate portableCommon Lisp progams in conventional operating system environments.Many implementations will have to continue to choose betweenconforming to the standard and providing a superior user environment.Benefits:Implementations will be more able to match their IO behavior to theirenvironment and their user's expectations.Aesthetics:Improved because this area becomes better defined.Discussion:Moon says that *TERMINAL-IO* (and, by extension, *QUERY-IO*, and*DEBUG-IO*) should fail to work in a non-interactive environment wherenothing like a terminal exists.  This proposal fails to address this.Masinter notes that:    ``In many multi-processing multi-window environments,      the "initial binding" for *STANDARD-INPUT*, *QUERY-INPUT*      differs for each process.''  Pierson and Pitman support STANDARD-INPUT-INITIAL-BINDING:DEFINED-CONTRACTS.     ----- End Forwarded Messages -----*start*06999 00024 US Return-Path: <X3J13-mailer@SAIL.Stanford.EDU>Received: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 07 OCT 88 22:11:37 PDTReceived: from Xerox.COM by SAIL.Stanford.EDU with TCP; 7 Oct 88  21:51:58 PDTReceived: from Semillon.ms by ArpaGateway.ms ; 07 OCT 88 21:50:05 PDTDate: 7 Oct 88 21:50 PDTFrom: masinter.paSubject: Issue: STANDARD-INPUT-INITIAL-BINDING (version 8)To: x3j13@sail.stanford.eduREPLY-TO: cl-cleanup@sail.stanford.eduline-fold: NOcc: Masinter.paMessage-ID: <881007-215005-1749@Xerox>!Issue:         STANDARD-INPUT-INITIAL-BINDINGReferences:    Standard streams (pp. 327-329)Category:      CHANGEEdit history:  Version 1 by Pierson and Haflich 1/19/87    	       Version 2 by Pierson 2/29/88	       Version 3 by Pierson 5/23/88, per comments by Moon               Version 4 by Pierson 5/26/88, clean up    	       Version 5 by Pierson 6/28/88, simple design per Masinter    	       Version 6 by Pierson 7/ 5/88, clean up and split issue	       Version 7 by Pierson 7/ 8/88, clean up per Pitman	       Version 8 by Pierson 7/ 8/88, yet more clean upStatus:        Ready for Release?Problem description:CLtL requires that *STANDARD-INPUT*, *STANDARD-OUTPUT*,*ERROR-OUTPUT*, *TRACE-OUTPUT*, *QUERY-IO*, and *DEBUG-IO* areinitially bound to synonym streams to *TERMINAL-IO*.  This requirementhampers the integration of Common Lisp with many existing andpotential operating environments.For example, a Unix implementation is currently unable to legallysupport Unix standard error output even though Common Lisp defines*ERROR-OUTPUT* because *ERROR-OUTPUT* is required to start out boundto the same stream as *STANDARD-OUTPUT*.  A workstation environnmentwhich provides stream access to windows as an extension is currentlyforbidden to make trace output appear in a separate window by defaultbecause *TRACE-OUTPUT* is required to start out bound to the samestream as *STANDARD-OUTPUT*.Proposal (STANDARD-INPUT-INITIAL-BINDING:DEFINED-CONTRACTS):A Common Lisp implementation is required to provide the followinginitial streams.  Each initial stream has a specific purpose asdefined in CLtL.  This proposal redefines the initial bindings ofthe streams and leaves the rest of the CLtL description unchanged.    *TERMINAL-IO*    *STANDARD-INPUT*    *STANDARD-OUTPUT*    *ERROR-OUTPUT*    *TRACE-OUTPUT*    *QUERY-IO*    *DEBUG-IO*    	The initial bindings of these variables are undefined except	that:	    1. They are all initially bound to open streams.	    2. The streams must support input and/or output as	       indicated by the variable name.    	    3. None of the standard streams (including *TERMINAL-IO*)	       may be directed by synonym streams to another of these	       stream variables (except *TERMINAL-IO*), whether	       directly or by indirection via some composite stream	       such as a two way stream with one of the arms being a	       synonym stream.	    4. Any or all of these streams may be synonyms for the	       common implementation dependent stream.  For example,	       in an interactive Common Lisp invocation running on a	       character terminal, all of the streams mentioned here	       might be synonym streams (or two-way streams to synonym	       streams) to a pair of hidden terminal input/output	       streams maintained by the implementation.	The intent of the above rules is to ensure that it is always	safe to bind any of the above variables to another of the	above variables without unduly restricting implementation	flexibility.Test Cases/Examples:(PROGN   (PRINT "Output" *STANDARD-OUTPUT*)   (PRINT "Error" *ERROR-OUTPUT*))In current Common Lisp will write:    ------    Output    Error    ------With proposal *might* write:    ------    Output    ------    and "Error" appears somewhere else.(LET ((*STANDARD-OUTPUT* *DEBUG-IO*))  ...)In current Common Lisp:     Might cause a circular stream reference if *DEBUG-IO* was    bound to a two-way stream made up of synonym streams to    *STANDARD-INPUT* and *STANDARD-OUTPUT*.With this proposal:    Would be guaranteed not to cause a circular stream reference    unless the initial value of *DEBUG-IO* had been changed to a value    that did not conform the restrictions in this proposal.  While no    Common Lisp implementation should do this, a user program might.(LET ((*STANDARD-INPUT*  *TERMINAL-IO*)      (*STANDARD-OUTPUT* *TERMINAL-IO*))  ...)In current Common Lisp:     Might cause a circular stream reference because *TERMINAL-IO* was    bound to a two-way stream made up of synonym streams to    *STANDARD-INPUT* and *STANDARD-OUTPUT*.With this proposal:    Would be guaranteed not to cause a circular stream reference.Rationale:This proposal attempts to provide a balance between over-specifyingbehavior to the point that Lisp programs can't behave like otherprograms in conventional operating systems and providing enoughspecification that Common Lisp programs can perform portable input andoutput.Current practice:Lucid binds *TERMINAL-IO* to a special internal stream type.  Franzbinds *TERMINAL-IO* to a special internal stream type for terminalstreams which reads from Unix standard input and writes to Unixstandard output.  KCL binds *TERMINAL-IO* to a standard two-way-streamwith input from Unix standard input and output to Unix standardoutput.  Symbolics Genera binds *TERMINAL-IO* as appropriate for eachprocess, usually to a window for interactive applications or to astream which will conjure an interaction window on demand forbackground tasks.Cost to Implementors:All implementations will have to change to some degree but the changeswill probably be simple and localized.  All known implementationsalready support the underlying streams required to implement thisproposal.Cost to Users:User code which depends on the strict binding hierarchy in CLtL mayhave to change.  Cost of non-Adoption:It will continue to be difficult or impossible to integrate portableCommon Lisp progams in conventional operating system environments.Many implementations will have to continue to choose betweenconforming to the standard and providing a superior user environment.Benefits:Implementations will be more able to match their IO behavior to theirenvironment and their user's expectations.Aesthetics:Improved because this area becomes better defined.Discussion:Moon says that *TERMINAL-IO* (and, by extension, *QUERY-IO*, and*DEBUG-IO*) should fail to work in a non-interactive environment wherenothing like a terminal exists.  This proposal fails to address this.Masinter notes that:    ``In many multi-processing multi-window environments,      the "initial binding" for *STANDARD-INPUT*, *QUERY-INPUT*      differs for each process.''  Pierson and Pitman support STANDARD-INPUT-INITIAL-BINDING:DEFINED-CONTRACTS.     ----- End Forwarded Messages -----*start*01018 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 13 OCT 88 18:11:14 PDTReceived: from STONY-BROOK.SCRC.Symbolics.COM (SCRC-STONY-BROOK.ARPA) by SAIL.Stanford.EDU with TCP; 13 Oct 88  18:06:01 PDTReceived: from BOBOLINK.SCRC.Symbolics.COM by STONY-BROOK.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 476125; Thu 13-Oct-88 19:19:18 EDTDate: Thu, 13 Oct 88 19:19 EDTFrom: Kent M Pitman <KMP@STONY-BROOK.SCRC.Symbolics.COM>Subject: Issue: STANDARD-INPUT-INITIAL-BINDING (Version 8)To: CL-Cleanup@SAIL.Stanford.EDUMessage-ID: <881013191910.1.KMP@BOBOLINK.SCRC.Symbolics.COM>My notes from Fairfax meeting...Cleanup meeting: Thought ready for vote.X3J13 meeting: RWK had some questions about things he thought the proposal might be saying that worried him, but he was pacified by people pointing him at definitive wording. People seemed not to object, but no vote was taken.*start*06848 00024 US Date:  9 Dec 88 01:19 PSTFrom: masinter.paTo: masinterSubject: Issue: STANDARD-INPUT-INITIAL-BINDING (Version 8)Issue:         STANDARD-INPUT-INITIAL-BINDINGReferences:    Standard streams (pp. 327-329)Category:      CHANGEEdit history:  Version 1 by Pierson and Haflich 1/19/87    	       Version 2 by Pierson 2/29/88	       Version 3 by Pierson 5/23/88, per comments by Moon               Version 4 by Pierson 5/26/88, clean up    	       Version 5 by Pierson 6/28/88, simple design per Masinter    	       Version 6 by Pierson 7/ 5/88, clean up and split issue	       Version 7 by Pierson 7/ 8/88, clean up per Pitman	       Version 8 by Pierson 7/ 8/88, yet more clean upProblem description:CLtL requires that *STANDARD-INPUT*, *STANDARD-OUTPUT*,*ERROR-OUTPUT*, *TRACE-OUTPUT*, *QUERY-IO*, and *DEBUG-IO* areinitially bound to synonym streams to *TERMINAL-IO*.  This requirementhampers the integration of Common Lisp with many existing andpotential operating environments.For example, a Unix implementation is currently unable to legallysupport Unix standard error output even though Common Lisp defines*ERROR-OUTPUT* because *ERROR-OUTPUT* is required to start out boundto the same stream as *STANDARD-OUTPUT*.  A workstation environnmentwhich provides stream access to windows as an extension is currentlyforbidden to make trace output appear in a separate window by defaultbecause *TRACE-OUTPUT* is required to start out bound to the samestream as *STANDARD-OUTPUT*.Proposal (STANDARD-INPUT-INITIAL-BINDING:DEFINED-CONTRACTS):A Common Lisp implementation is required to provide the followinginitial streams.  Each initial stream has a specific purpose asdefined in CLtL.  This proposal redefines the initial bindings ofthe streams and leaves the rest of the CLtL description unchanged.    *TERMINAL-IO*    *STANDARD-INPUT*    *STANDARD-OUTPUT*    *ERROR-OUTPUT*    *TRACE-OUTPUT*    *QUERY-IO*    *DEBUG-IO*    	The initial bindings of these variables are undefined except	that:	    1. They are all initially bound to open streams.	    2. The streams must support input and/or output as	       indicated by the variable name.    	    3. None of the standard streams (including *TERMINAL-IO*)	       may be directed by synonym streams to another of these	       stream variables (except *TERMINAL-IO*), whether	       directly or by indirection via some composite stream	       such as a two way stream with one of the arms being a	       synonym stream.	    4. Any or all of these streams may be synonyms for the	       common implementation dependent stream.  For example,	       in an interactive Common Lisp invocation running on a	       character terminal, all of the streams mentioned here	       might be synonym streams (or two-way streams to synonym	       streams) to a pair of hidden terminal input/output	       streams maintained by the implementation.	The intent of the above rules is to ensure that it is always	safe to bind any of the above variables to another of the	above variables without unduly restricting implementation	flexibility.Examples:(PROGN   (PRINT "Output" *STANDARD-OUTPUT*)   (PRINT "Error" *ERROR-OUTPUT*))In current Common Lisp will write:    ------    Output    Error    ------With proposal *might* write:    ------    Output    ------    and "Error" appears somewhere else.(LET ((*STANDARD-OUTPUT* *DEBUG-IO*))  ...)In current Common Lisp:     Might cause a circular stream reference if *DEBUG-IO* was    bound to a two-way stream made up of synonym streams to    *STANDARD-INPUT* and *STANDARD-OUTPUT*.With this proposal:    Would be guaranteed not to cause a circular stream reference    unless the initial value of *DEBUG-IO* had been changed to a value    that did not conform the restrictions in this proposal.  While no    Common Lisp implementation should do this, a user program might.(LET ((*STANDARD-INPUT*  *TERMINAL-IO*)      (*STANDARD-OUTPUT* *TERMINAL-IO*))  ...)In current Common Lisp:     Might cause a circular stream reference because *TERMINAL-IO* was    bound to a two-way stream made up of synonym streams to    *STANDARD-INPUT* and *STANDARD-OUTPUT*.With this proposal:    Would be guaranteed not to cause a circular stream reference.Rationale:This proposal attempts to provide a balance between over-specifyingbehavior to the point that Lisp programs can't behave like otherprograms in conventional operating systems and providing enoughspecification that Common Lisp programs can perform portable input andoutput.Current practice:Lucid binds *TERMINAL-IO* to a special internal stream type.  Franzbinds *TERMINAL-IO* to a special internal stream type for terminalstreams which reads from Unix standard input and writes to Unixstandard output.  KCL binds *TERMINAL-IO* to a standard two-way-streamwith input from Unix standard input and output to Unix standardoutput.  Symbolics Genera binds *TERMINAL-IO* as appropriate for eachprocess, usually to a window for interactive applications or to astream which will conjure an interaction window on demand forbackground tasks.Cost to Implementors:All implementations will have to change to some degree but the changeswill probably be simple and localized.  All known implementationsalready support the underlying streams required to implement thisproposal.Cost to Users:User code which depends on the strict binding hierarchy in CLtL mayhave to change.  Cost of non-Adoption:It will continue to be difficult or impossible to integrate portableCommon Lisp progams in conventional operating system environments.Many implementations will have to continue to choose betweenconforming to the standard and providing a superior user environment.Benefits:Implementations will be more able to match their IO behavior to theirenvironment and their user's expectations.Aesthetics:Improved because this area becomes better defined.Discussion:Moon says that *TERMINAL-IO* (and, by extension, *QUERY-IO*, and*DEBUG-IO*) should fail to work in a non-interactive environment wherenothing like a terminal exists.  This proposal fails to address this.Masinter notes that:    ``In many multi-processing multi-window environments,      the "initial binding" for *STANDARD-INPUT*, *QUERY-INPUT*      differs for each process.''  Pierson and Pitman support STANDARD-INPUT-INITIAL-BINDING:DEFINED-CONTRACTS.        TITAN 
         TITAN 
           I                                                                                  =              
                                (                            X                    
       s              5                   R  z