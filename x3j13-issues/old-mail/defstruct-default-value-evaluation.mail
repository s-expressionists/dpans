*start*03651 00024 USfReturn-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU by Xerox.COM ; 19 MAY 88 11:27:29 PDTReceived: from hub.ucsb.edu by SAIL.Stanford.EDU with TCP; 19 May 88  11:24:57 PDTReceived: from csilvax.ucsb.edu by hub.ucsb.edu (5.59) id AA15596; Thu, 19 May 88 11:26:00 PDTReceived: from  by csilvax.ucsb.CSNET (5.51) id AA27191; Thu, 19 May 88 11:20:30 PDTDate: Thu, 19 May 88 11:20:30 PDTFrom: Skona Brittain <skona%csilvax@hub.ucsb.edu>Posted-Date: Thu, 19 May 88 11:20:30 PDTTo: cl-cleanup@sail.stanford.eduSubject: ISSUE: DEFSTRUCT-DEFAULT-VALUE-EVALUATIONIssue:          DEFSTRUCT-DEFAULT-VALUE-EVALUATIONReferences:     CLtL p.308-10 & 86-003 p.4Category:       CLARIFICATIONEdit history:   Revision 1 by Skona Brittain 05/13/88Problem Description:There is some confusion over whether default initializationforms for defstruct slots get evaluated, when they are not neededbecause a keyword argument was supplied to the constructor function.As a consequence of this confusion, there is confusion over whetherthere can be a type-mismatch error between the specified type of the slotand the type of the default value.On page 308, it says "The default-init is a form that is evaluated each time a structure is to be constructed; the value is used as the initial value of the slot.  If no default-init is specified, then theinitial contents of the slot are undefined and implementation-dependent."On the next page, however, it says that the default-init is evaluated ifthe keyword argument is not supplied and the converse, although not stated,is intended and informally implied.Proposal (DEFSTRUCT-DEFAULT-VALUE-EVALUATION:IFF-NEEDED):Clarify that the converse is true. i.e that the default-init is not evaluated if the keyword argument is supplied.In the quote from page 308, delete the second sentence and replace "a structure is to be constructed; the value is" by "its value is to be".To section 19.3, add a clarification,such as the following from Guy's issues file:       "The default value in a defstruct slot is not evaluated         unless it is needed in the creation of a particular structure        instance.  If it is never needed, there can be no type-mismatch        error, even if the type of the slot is specified, and no warning        should be issued."Test Case:In the following sequence, only the last call is an error.        (defstruct person (name 007 :type string))         (make-person :name "James")        (make-person)Rationale:It is inefficient, and inconsistent with the rest of the language, for the default initialization form to be evaluated when it is not needed.Consequently, when it's not needed, such type-mismatch errors should not be detectable in general.Any existing confusion should be clarified by this proposal.Current Practice:KCL does not evaluate the default initialization form unless it is needed;even when it is needed, the type checking is not done at all.Cost to Implementors:If there are any implementations that currently behave differently fromthe proposed way, then they need some slight modification.  Cost to Users:None.Benefits:Clarity and portability.  In particular, clarifying that the unaesthetic situation mentioned in the next section is allowed should be reassuring.Aesthetics:It appears slightly unaesthetic to have a default value that violates a type specification.  Discussion: Although this issue was mentioned in Guy's original issues file, it hasnot been officially discussed since.*start*02246 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU by Xerox.COM ; 21 MAY 88 02:48:40 PDTReceived: from labrea.stanford.edu by SAIL.Stanford.EDU with TCP; 21 May 88  02:47:32 PDTReceived: by labrea.stanford.edu; Sat, 21 May 88 02:47:00 PDTReceived: from bhopal.lucid.com by edsel id AA19314g; Sat, 21 May 88 02:35:44 PDTReceived: by bhopal id AA07861g; Sat, 21 May 88 02:39:21 PDTDate: Sat, 21 May 88 02:39:21 PDTFrom: Jon L White <edsel!jonl@labrea.stanford.edu>Message-Id: <8805210939.AA07861@bhopal.lucid.com>To: skona%csilvax@hub.ucsb.eduCc: cl-cleanup@sail.stanford.eduIn-Reply-To: Skona Brittain's message of Thu, 19 May 88 11:20:30 PDT <8805191831.AA11226@edsel.lucid.com>Subject: ISSUE: DEFSTRUCT-DEFAULT-VALUE-EVALUATIONYou can add to the "Current Practice:" section:    LUCID does not evaluate the default initialization form unless it is     needed; even when it is needed, the type checking is not done at all.    However, at structure definition time, if an initial value form is    constanp and doesn't satisfy the :type specification, a warning message    is printed.Oddly enough, Lucid's interpreter ensures that SETF's of slots obey the:type specifier, even though init-forms aren't checked.  Furthermore, in safety levels 2 or higher, the compiled code will do minimal "memory-integrity" type checking for SETF's (which is what I suspect the various special-purpose microcoded machines do); however except for low-level numerictypes, this is rarely equivalent to what a full type check would do.I have long suggested that there should be at least one mode of operation such that all :type information is checked when setting values into structureslots (setf as well as initialization).  Some have suggested that this mode could be "when running interpretively, or when when compiled with the highestdegree of SAFETY and lower degrees of SPEED."  However, since the wording of CLtL p310 suggests that the :type slot options is merely a DECLARE, and sincesome vendors effectively ignore any and all declarations [except for SPECIAL],then this suggestion hasn't reached proposal stage yet.-- JonL --*start*00829 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU by Xerox.COM ; 24 MAY 88 14:03:56 PDTReceived: from JASPER.SCRC.Symbolics.COM ([128.81.41.58]) by SAIL.Stanford.EDU with TCP; 24 May 88  14:02:09 PDTReceived: from EUPHRATES.SCRC.Symbolics.COM by JASPER.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 191921; Tue 24-May-88 17:02:01 EDTDate: Tue, 24 May 88 17:02 EDTFrom: David A. Moon <Moon@STONY-BROOK.SCRC.Symbolics.COM>Subject: ISSUE: DEFSTRUCT-DEFAULT-VALUE-EVALUATIONTo: cl-cleanup@SAIL.STANFORD.EDUIn-Reply-To: The message of 19 May 88 14:20 EDT from Skona Brittain <skona%csilvax@hub.ucsb.edu>Message-ID: <19880524210207.8.MOON@EUPHRATES.SCRC.Symbolics.COM>I agree with DEFSTRUCT-DEFAULT-VALUE-EVALUATION:IFF-NEEDED.*start*00891 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU by Xerox.COM ; 28 MAY 88 09:30:54 PDTReceived: from STONY-BROOK.SCRC.Symbolics.COM (SCRC-STONY-BROOK.ARPA) by SAIL.Stanford.EDU with TCP; 28 May 88  09:27:19 PDTReceived: from PEWEE.SCRC.Symbolics.COM by STONY-BROOK.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 411847; Sat 28-May-88 12:26:29 EDTDate: Sat, 28 May 88 12:26 EDTFrom: Kent M Pitman <KMP@STONY-BROOK.SCRC.Symbolics.COM>Subject: ISSUE: DEFSTRUCT-DEFAULT-VALUE-EVALUATIONTo: skona%csilvax@hub.ucsb.educc: cl-cleanup@sail.stanford.eduIn-Reply-To: The message of 19 May 88 14:20 EDT from Skona Brittain <skona%csilvax@hub.ucsb.edu>Message-ID: <880528122617.9.KMP@PEWEE.SCRC.Symbolics.COM>DEFSTRUCT-DEFAULT-VALUE-EVALUATION looks ok to me.I support the IFF-NEEDED proposal.*start*05058 00024 USaDate:  8 Jun 88 15:24 PDTFrom: Masinter.paSubject: Issue: DEFSTRUCT-DEFAULT-VALUE-EVALUATION (Version 1)TO: x3j13@Sail.stanford.edureply-to: cl-cleanup@sail.stanford.educc: masinterLINE-FOLD: NOIssue:          DEFSTRUCT-DEFAULT-VALUE-EVALUATIONReferences:     CLtL p.308-10 & 86-003 p.4Category:       CLARIFICATIONEdit history:   Revision 1 by Skona Brittain 05/13/88Problem Description:There is some confusion over whether default initializationforms for defstruct slots get evaluated, when they are not neededbecause a keyword argument was supplied to the constructor function.As a consequence of this confusion, there is confusion over whetherthere can be a type-mismatch error between the specified type of the slotand the type of the default value.On page 308, it says "The default-init is a form that is evaluated each time a structure is to be constructed; the value is used as the initial value of the slot.  If no default-init is specified, then theinitial contents of the slot are undefined and implementation-dependent."On the next page, however, it says that the default-init is evaluated ifthe keyword argument is not supplied and the converse, although not stated,is intended and informally implied.Proposal (DEFSTRUCT-DEFAULT-VALUE-EVALUATION:IFF-NEEDED):Clarify that the converse is true. i.e that the default-init is not evaluated if the keyword argument is supplied.In the quote from page 308, delete the second sentence and replace "a structure is to be constructed; the value is" by "its value is to be".To section 19.3, add a clarification,such as the following from Guy's issues file:       "The default value in a defstruct slot is not evaluated         unless it is needed in the creation of a particular structure        instance.  If it is never needed, there can be no type-mismatch        error, even if the type of the slot is specified, and no warning        should be issued."Test Case:In the following sequence, only the last call is an error.        (defstruct person (name 007 :type string))         (make-person :name "James")        (make-person)Rationale:It is inefficient, and inconsistent with the rest of the language, for the default initialization form to be evaluated when it is not needed.Consequently, when it's not needed, such type-mismatch errors should not be detectable in general.Any existing confusion should be clarified by this proposal.Current Practice:KCL does not evaluate the default initialization form unless it is needed;even when it is needed, the type checking is not done at all.Cost to Implementors:If there are any implementations that currently behave differently fromthe proposed way, then they need some slight modification.  Cost to Users:None.Benefits:Clarity and portability.  In particular, clarifying that the unaesthetic situation mentioned in the next section is allowed should be reassuring.Aesthetics:It appears slightly unaesthetic to have a default value that violates a type specification.  Discussion: Although this issue was mentioned in Guy's original issues file, it hasnot been officially discussed since.Additional notes:Several members of the cleanup committee endorsed this proposal.JonL added:You can add to the "Current Practice:" section:    LUCID does not evaluate the default initialization form unless it is     needed; even when it is needed, the type checking is not done at all.    However, at structure definition time, if an initial value form is    constanp and doesn't satisfy the :type specification, a warning message    is printed.Oddly enough, Lucid's interpreter ensures that SETF's of slots obey the:type specifier, even though init-forms aren't checked.  Furthermore, in safety levels 2 or higher, the compiled code will do minimal "memory-integrity" type checking for SETF's (which is what I suspect the various special-purpose microcoded machines do); however except for low-level numerictypes, this is rarely equivalent to what a full type check would do.I have long suggested that there should be at least one mode of operation such that all :type information is checked when setting values into structureslots (setf as well as initialization).  Some have suggested that this mode could be "when running interpretively, or when when compiled with the highestdegree of SAFETY and lower degrees of SPEED."  However, since the wording of CLtL p310 suggests that the :type slot options is merely a DECLARE, and sincesome vendors effectively ignore any and all declarations [except for SPECIAL],then this suggestion hasn't reached proposal stage yet.        TITAN 
         TITAN 
          
TIMESROMAN 
           Ã              #                                          (             L       :      ç              ≠             4              å              à              	       
       ñ              b             I      W z∫*start*05505 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([10.0.0.11]) by Xerox.COM ; 14 SEP 88 20:13:04 PDTReceived: from Xerox.COM by SAIL.Stanford.EDU with TCP; 14 Sep 88  20:11:12 PDTReceived: from Cabernet.ms by ArpaGateway.ms ; 14 SEP 88 20:00:45 PDTDate: 14 Sep 88 20:00 PDTFrom: masinter.paSubject: Re: Issue: DEFSTRUCT-DEFAULT-VALUE-EVALUATION (Version 1)In-reply-to: Masinter.pa's message of 8 Jun 88 15:24 PDTTo: cl-cleanup@sail.stanford.eduMessage-ID: <880914-200045-1692@Xerox>The minutes from the June meeting say "The discussion ofDEFSTRUCT-DEFAULT-VALUE-EVALUATION led to  no resolution of opinion so it wasdecided not to bring the proposal to a motion."I cannot recall what, if any, controversy was associated with this proposal.JonL had some additional comments, but I didn't see that they would require anychanges to this issue per se (correct me if I am wrong.)To refresh your memory:!Issue:          DEFSTRUCT-DEFAULT-VALUE-EVALUATIONReferences:     CLtL p.308-10 & 86-003 p.4Category:       CLARIFICATIONEdit history:   Revision 1 by Skona Brittain 05/13/88Problem Description:There is some confusion over whether default initializationforms for defstruct slots get evaluated, when they are not neededbecause a keyword argument was supplied to the constructor function.As a consequence of this confusion, there is confusion over whetherthere can be a type-mismatch error between the specified type of the slotand the type of the default value.On page 308, it says "The default-init is a form that is evaluated each time a structure is to be constructed; the value is used as the initial value of the slot.  If no default-init is specified, then theinitial contents of the slot are undefined and implementation-dependent."On the next page, however, it says that the default-init is evaluated ifthe keyword argument is not supplied and the converse, although not stated,is intended and informally implied.Proposal (DEFSTRUCT-DEFAULT-VALUE-EVALUATION:IFF-NEEDED):Clarify that the converse is true. i.e that the default-init is not evaluated if the keyword argument is supplied.In the quote from page 308, delete the second sentence and replace "a structure is to be constructed; the value is" by "its value is to be".To section 19.3, add a clarification,such as the following from Guy's issues file:       "The default value in a defstruct slot is not evaluated         unless it is needed in the creation of a particular structure        instance.  If it is never needed, there can be no type-mismatch        error, even if the type of the slot is specified, and no warning        should be issued."Test Case:In the following sequence, only the last call is an error.        (defstruct person (name 007 :type string))         (make-person :name "James")        (make-person)Rationale:It is inefficient, and inconsistent with the rest of the language, for the default initialization form to be evaluated when it is not needed.Consequently, when it's not needed, such type-mismatch errors should not be detectable in general.Any existing confusion should be clarified by this proposal.Current Practice:KCL does not evaluate the default initialization form unless it is needed;even when it is needed, the type checking is not done at all.Cost to Implementors:If there are any implementations that currently behave differently fromthe proposed way, then they need some slight modification.  Cost to Users:None.Benefits:Clarity and portability.  In particular, clarifying that the unaesthetic situation mentioned in the next section is allowed should be reassuring.Aesthetics:It appears slightly unaesthetic to have a default value that violates a type specification.  Discussion: Although this issue was mentioned in Guy's original issues file, it hasnot been officially discussed since.!Additional notes:Several members of the cleanup committee endorsed this proposal.JonL added:You can add to the "Current Practice:" section:    LUCID does not evaluate the default initialization form unless it is     needed; even when it is needed, the type checking is not done at all.    However, at structure definition time, if an initial value form is    constanp and doesn't satisfy the :type specification, a warning message    is printed.Oddly enough, Lucid's interpreter ensures that SETF's of slots obey the:type specifier, even though init-forms aren't checked.  Furthermore, in safety levels 2 or higher, the compiled code will do minimal "memory-integrity" type checking for SETF's (which is what I suspect the various special-purpose microcoded machines do); however except for low-level numerictypes, this is rarely equivalent to what a full type check would do.I have long suggested that there should be at least one mode of operation such that all :type information is checked when setting values into structureslots (setf as well as initialization).  Some have suggested that this mode could be "when running interpretively, or when when compiled with the highestdegree of SAFETY and lower degrees of SPEED."  However, since the wording of CLtL p310 suggests that the :type slot options is merely a DECLARE, and sincesome vendors effectively ignore any and all declarations [except for SPECIAL],then this suggestion hasn't reached proposal stage yet.*start*00779 00024 US Return-Path: <Moon@STONY-BROOK.SCRC.Symbolics.COM>Received: from STONY-BROOK.SCRC.Symbolics.COM ([128.81.41.144]) by Xerox.COM ; 18 SEP 88 12:49:20 PDTReceived: from EUPHRATES.SCRC.Symbolics.COM by STONY-BROOK.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 461260; Sun 18-Sep-88 15:48:59 EDTDate: Sun, 18 Sep 88 15:48 EDTFrom: David A. Moon <Moon@STONY-BROOK.SCRC.Symbolics.COM>Subject: Re: Issue: DEFSTRUCT-DEFAULT-VALUE-EVALUATION (Version 1)To: masinter.pacc: cl-cleanup@sail.stanford.eduIn-Reply-To: <880914-200045-1692@Xerox>Message-ID: <19880918194856.5.MOON@EUPHRATES.SCRC.Symbolics.COM>Line-fold: NoI support DEFSTRUCT-DEFAULT-VALUE-EVALUATION:IFF-NEEDED.  All thediscussion about :type is some other issue as far as I am concerned.*start*00796 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 13 OCT 88 13:14:16 PDTReceived: from STONY-BROOK.SCRC.Symbolics.COM (SCRC-STONY-BROOK.ARPA) by SAIL.Stanford.EDU with TCP; 13 Oct 88  13:14:22 PDTReceived: from BOBOLINK.SCRC.Symbolics.COM by STONY-BROOK.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 475789; Thu 13-Oct-88 16:12:59 EDTDate: Thu, 13 Oct 88 16:12 EDTFrom: Kent M Pitman <KMP@STONY-BROOK.SCRC.Symbolics.COM>Subject: Issue: DEFSTRUCT-DEFAULT-VALUE-EVALUATION (Version 1)To: CL-Cleanup@SAIL.Stanford.EDUMessage-ID: <881013161251.6.KMP@BOBOLINK.SCRC.Symbolics.COM>My notes from Fairfax meeting...X3J13 meeting: This was voted upon and ACCEPTED.