*start*01328 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 09 JAN 89 13:19:01 PSTReceived: from ti.com by SAIL.Stanford.EDU with TCP; 9 Jan 89  13:18:45 PSTReceived: by ti.com id AA00427; Mon, 9 Jan 89 12:35:39 CSTReceived: from Kelvin by tilde id AA05460; Mon, 9 Jan 89 12:26:31 CSTMessage-Id: <2809362537-10236580@Kelvin>Sender: GRAY@Kelvin.csc.ti.comDate: Mon, 9 Jan 89 12:28:57 CSTFrom: David N Gray <Gray@DSG.csc.ti.com>To: "Kim A. Barrett" <IIM@ECLA.USC.EDU>Cc: cl-cleanup@SAIL.STANFORD.EDUSubject: Re: Proposal SUBTYPEP-ENVIRONMENT:NEW-ARGUMENT, Version 1In-Reply-To: Msg of Mon 2 Jan 89 17:31:11-PST from Kim A. Barrett <IIM@ECLA.USC.EDU>> Proposal (SUBTYPEP-ENVIRONMENT:NEW-ARGUMENT)> >  Extend SUBTYPEP to accept an optional third argument.  This argument should be>  either NIL, the &environment argument received by a macro expander function,>  or the environment argument received by an *evalhook* or *applyhook* function.>  This argument is used to distinguish between compile-time and run-time>  environments. I don't see any point in mentioning *EVALHOOK* environments here sincethere isn't any facility for local type declarations comparable toMACROLET for local macros.*start*01754 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 09 JAN 89 13:20:36 PSTReceived: from ti.com by SAIL.Stanford.EDU with TCP; 9 Jan 89  13:20:21 PSTReceived: by ti.com id AA00423; Mon, 9 Jan 89 12:35:34 CSTReceived: from Kelvin by tilde id AA05368; Mon, 9 Jan 89 12:20:25 CSTMessage-Id: <2809362147-10213162@Kelvin>Sender: GRAY@Kelvin.csc.ti.comDate: Mon, 9 Jan 89 12:22:27 CSTFrom: David N Gray <Gray@DSG.csc.ti.com>To: Richard Mlynarik <Mly@AI.AI.MIT.EDU>Cc: "Kim A. Barrett" <IIM@ECLA.USC.EDU>, cl-cleanup@SAIL.STANFORD.EDUSubject: Re: Proposal SUBTYPEP-ENVIRONMENT:NEW-ARGUMENT, Version 1In-Reply-To: Msg of Sat, 7 Jan 89 12:24 EST from Richard Mlynarik <Mly@AI.AI.MIT.EDU>> Not so.  Consider compiler optimisations of (MAKE-ARRAY # :ELEMENT-TYPE #)> When I last wrote a CL type system I needed a mess of parallel> COMPILER-SUBTYPEP and COMPILER-UPGRADE-ARRAY-ELEMEN-TYPE (and so forth)> functions.  Using compilation-environment technology would have been far> preferable.> > I give MAKE-ARRAY optimisation merely as an example -- I feel `user'> code has the same sorts of needs.On the Explorer, both TYPEP and SUBTYPEP already implicitly use thecompile-time environment when they are called from within COMPILE-FILE.Consequently, uses of these in macro expanders will see type definitionsearlier in the same file without the macro writer needing to do anythingspecial, so this capability could be used a lot without anyone realizingit.  I think it would be cleaner if these functions accepted optionalenvironment arguments, which default to the compilation environment whenwithin COMPILE-FILE.*start*02200 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 09 JAN 89 18:50:46 PSTReceived: from ALDERAAN.SCRC.Symbolics.COM ([128.81.41.109]) by SAIL.Stanford.EDU with TCP; 9 Jan 89  16:09:00 PSTReceived: from GANG-GANG.SCRC.Symbolics.COM by ALDERAAN.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 257602; Mon 9-Jan-89 19:06:33 ESTDate: Mon, 9 Jan 89 19:06 ESTFrom: Glenn S. Burke <gsb@ALDERAAN.SCRC.Symbolics.COM>Subject: Re: Proposal SUBTYPEP-ENVIRONMENT:NEW-ARGUMENT, Version 1To: Gray@DSG.csc.ti.com, Mly@AI.AI.MIT.EDUcc: IIM@ECLA.USC.EDU, cl-cleanup@SAIL.STANFORD.EDUIn-Reply-To: <2809362147-10213162@Kelvin>Message-ID: <19890110000602.8.GSB@GANG-GANG.SCRC.Symbolics.COM>    Date: Mon, 9 Jan 89  12:22:27 CST    From: David N Gray <Gray@DSG.csc.ti.com>    > Not so.  Consider compiler optimisations of (MAKE-ARRAY # :ELEMENT-TYPE #)    > When I last wrote a CL type system I needed a mess of parallel    > COMPILER-SUBTYPEP and COMPILER-UPGRADE-ARRAY-ELEMEN-TYPE (and so forth)    > functions.  Using compilation-environment technology would have been far    > preferable.    >     > I give MAKE-ARRAY optimisation merely as an example -- I feel `user'    > code has the same sorts of needs.    On the Explorer, both TYPEP and SUBTYPEP already implicitly use the    compile-time environment when they are called from within COMPILE-FILE.    Consequently, uses of these in macro expanders will see type definitions    earlier in the same file without the macro writer needing to do anything    special, so this capability could be used a lot without anyone realizing    it.  I think it would be cleaner if these functions accepted optional    environment arguments, which default to the compilation environment when    within COMPILE-FILE.The problem is defining "within" compile-file.  This is what the environmentargument determines.  A runtime call to make-array inside the guts of thecompiler (or other miscellaneous system code) which happens to beunoptimized and calls subtypep should not be using type information fromthe user's file.*start*00952 00024 USaReturn-Path: <Gray@DSG.csc.ti.com>Received: from ti.com ([10.7.0.46]) by Xerox.COM ; 11 JAN 89 14:05:37 PSTReceived: by ti.com id AA11377; Wed, 11 Jan 89 16:06:43 CSTReceived: from Kelvin by tilde id AA02679; Wed, 11 Jan 89 15:55:49 CSTMessage-Id: <2809547867-4856416@Kelvin>Sender: GRAY@Kelvin.csc.ti.comDate: Wed, 11 Jan 89 15:57:47 CSTFrom: David N Gray <Gray@DSG.csc.ti.com>To: masinter.paCc: "Kim A. Barrett" <IIM@ECLA.USC.EDU>Subject: Re: environment argument for SUBTYPEPIn-Reply-To: Msg of 5 Jan 89 20:27 PST from masinter.pa@Xerox.COM> I'm temporarily blanking -- I can think of no way of making a local> declaration in such a way that SUBTYPEP might differ between local & global> context. So I can't think of a case where SUBTYPEP's results could> legitimately depend on an environment argument.There are no "local" types, but there are types in the "remote global"environment during COMPILE-FILE.*start*00890 00024 US GV-Info: CL-Cleanup-mailer@SAIL.Stanford.EDU at 17-Mar-89 23:56:27 from AGReturn-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 17 MAR 89 23:56:25 PSTReceived: from Xerox.COM by SAIL.Stanford.EDU with TCP; 17 Mar 89  23:57:39 PSTReceived: from Semillon.ms by ArpaGateway.ms ; 17 MAR 89 23:54:56 PSTDate: 17 Mar 89 23:54 PSTFrom: masinter.paSubject: Re: environment argument for SUBTYPEPIn-reply-to: David N Gray <Gray@DSG.csc.ti.com>'s message of Wed, 11 Jan 89 15:57:47 CSTTo: David N Gray <Gray@DSG.csc.ti.com>, cl-cleanup@sail.stanford.edu, "Kim A. Barrett" <IIM@ECLA.USC.EDU>Message-ID: <890317-235456-3561@Xerox>Somehow I dropped some mail; I don't have the proposal, although there's areference to version 1 of SUBTYPEP-ENVIRONMENT. Is this ready?