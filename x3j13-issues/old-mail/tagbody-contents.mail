*start*01808 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([10.0.0.11]) by Xerox.COM ; 13 SEP 88 12:34:52 PDTReceived: from decwrl.dec.com by SAIL.Stanford.EDU with TCP; 13 Sep 88  12:33:53 PDTReceived: by decwrl.dec.com (5.54.5/4.7.34)	id AA14180; Tue, 13 Sep 88 12:32:37 PDTDate: Tue, 13 Sep 88 12:32:37 PDTMessage-Id: <8809131932.AA14180@decwrl.dec.com>From: vanroggen%aitg.DEC@decwrl.dec.comTo: cl-cleanup@sail.stanford.eduSubject: Issue: TAGBODY-CONTENTS (version 1)Issue:		TAGBODY-CONTENTSReferences:	TAGBODY (pp 130-131 of CLtL)Category:	CLARIFICATIONEdit History:	13-Sept-88, version 1 by Walter van RoggenProblem Description:  CLtL isn't clear on what may be in the body of a TAGBODY.Proposal: (TAGBODY-CONTENTS:RESTRICT)  Anything in a TAGBODY other than a tag (a symbol or an integer) or  a list is an error.  It is an error for the same (EQL) tag to appear more than once in the  body of a TAGBODY.  (However, a TAGBODY may have the same tag as  another TAGBODY in which it nests, in which case the tag in the outer  TAGBODY is shadowed, as already specified.)  The same restrictions apply to all forms which implicitly use TAGBODY,  such as PROG and DO.Current Practice:Cost to Implementors:  A few simple checks are probably all that's needed, and probably  most implementations (both interpreters and compilers) already perform them.Cost to Users:  Unlikely to affect any portable code.  If there are implementations which  support other objects as tags (floats, for example), there may be simple  editing necessary.Benefits:  A slightly more precise description of the language.Discussion:  This first appeared in ">GLS>clarifications.text" of 12/06/85.*start*02258 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([10.0.0.11]) by Xerox.COM ; 13 SEP 88 16:04:55 PDTReceived: from STONY-BROOK.SCRC.Symbolics.COM (SCRC-STONY-BROOK.ARPA) by SAIL.Stanford.EDU with TCP; 13 Sep 88  16:03:59 PDTReceived: from GRYPHON.SCRC.Symbolics.COM by STONY-BROOK.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 458649; Tue 13-Sep-88 19:02:54 EDTDate: Tue, 13 Sep 88 19:02 EDTFrom: Kent M Pitman <KMP@STONY-BROOK.SCRC.Symbolics.COM>Subject: Issue: TAGBODY-CONTENTS (version 1)To: vanroggen%aitg.DEC@decwrl.dec.comcc: CL-Cleanup@SAIL.Stanford.EDUIn-Reply-To: <8809131932.AA14180@decwrl.dec.com>Message-ID: <880913190211.7.KMP@GRYPHON.SCRC.Symbolics.COM>I generally support this TAGBODY-CONTENTS:RESTRICT, but have the following comments:    Cost to Implementors:      A few simple checks are probably all that's needed, and probably      most implementations (both interpreters and compilers) already perform them.Actually, this should be "no cost" since you've only said this "is an error".You've not required implementations to signal. With my portable-code-writer's hat on, I'd applaud any attempts to make implementations really signal in this case,but my guess is that most implementors (maybe even Symbolics itself) would boo meon this and would regard this as an imposition of the same caliber as my IF-BODYsuggestion a while back.    Cost to Users:      Unlikely to affect any portable code.  If there are implementations which      support other objects as tags (floats, for example), there may be simple      editing necessary.Again, no cost. Users already can't rely on anything more than what's in CLtL.If they do, they're not writing CL code. Further, since you're not forcingimplementations to change, they are free to continue to rely on this non-portableextension as long as implementors don't get overzealous and upgrade just for grins.Bottom line: I don't think this proposal really restricts anything. I think it'sjust a restatement of the status quo. If you think there's confusion, I accept thatstatement as an existence proof that there is confusion and I'm happy to see itclarified. *start*00935 00024 USaReturn-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([10.0.0.11]) by Xerox.COM ; 18 SEP 88 12:34:53 PDTReceived: from STONY-BROOK.SCRC.Symbolics.COM (SCRC-STONY-BROOK.ARPA) by SAIL.Stanford.EDU with TCP; 18 Sep 88  12:34:46 PDTReceived: from EUPHRATES.SCRC.Symbolics.COM by STONY-BROOK.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 461250; Sun 18-Sep-88 15:29:34 EDTDate: Sun, 18 Sep 88 15:29 EDTFrom: David A. Moon <Moon@STONY-BROOK.SCRC.Symbolics.COM>Subject: Issue: TAGBODY-CONTENTS (version 1)To: vanroggen%aitg.DEC@decwrl.dec.comcc: cl-cleanup@sail.stanford.eduIn-Reply-To: <8809131932.AA14180@decwrl.dec.com>Message-ID: <19880918192926.3.MOON@EUPHRATES.SCRC.Symbolics.COM>TAGBODY-CONTENTS:RESTRICT is fine, although I think I oncesaw code that used characters as tags, and I don't see anyobvious reason to disallow that.*start*00900 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 20 SEP 88 18:17:44 PDTReceived: from Xerox.COM by SAIL.Stanford.EDU with TCP; 20 Sep 88  18:17:25 PDTReceived: from Cabernet.ms by ArpaGateway.ms ; 20 SEP 88 18:13:07 PDTDate: 20 Sep 88 18:13 PDTFrom: masinter.paSubject: Re: Issue: TAGBODY-CONTENTS (version 1)In-reply-to: David A. Moon <Moon@STONY-BROOK.SCRC.Symbolics.COM>'s message of Sun, 18 Sep 88 15:29 EDTTo: David A. Moon <Moon@STONY-BROOK.SCRC.Symbolics.COM>cc: vanroggen%aitg.DEC@decwrl.dec.com, cl-cleanup@sail.stanford.eduMessage-ID: <880920-181307-5271@Xerox>(tagbody    #\return (format t "return here...")   #\Newline (format t "newline here ...")   ...)might be a reason for disallowing characters.I think this one is Ready for Release.*start*00959 00024 US Return-Path: <Moon@STONY-BROOK.SCRC.Symbolics.COM>Received: from STONY-BROOK.SCRC.Symbolics.COM ([128.81.41.144]) by Xerox.COM ; 21 SEP 88 08:43:14 PDTReceived: from EUPHRATES.SCRC.Symbolics.COM by STONY-BROOK.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 463154; Wed 21-Sep-88 11:43:16 EDTDate: Wed, 21 Sep 88 11:43 EDTFrom: David A. Moon <Moon@STONY-BROOK.SCRC.Symbolics.COM>Subject: Re: Issue: TAGBODY-CONTENTS (version 1)To: masinter.pacc: vanroggen%aitg.DEC@decwrl.dec.com, cl-cleanup@sail.stanford.eduIn-Reply-To: <880920-181307-5271@Xerox>Message-ID: <19880921154319.6.MOON@EUPHRATES.SCRC.Symbolics.COM>Line-fold: No    Date: 20 Sep 88 18:13 PDT    From: masinter.pa@Xerox.COM    (tagbody        #\return (format t "return here...")       #\Newline (format t "newline here ...")       ...)    might be a reason for disallowing characters.Good point.    I think this one is Ready for Release.Agreed.*start*01045 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 22 SEP 88 17:27:38 PDTReceived: from lucid.com by SAIL.Stanford.EDU with TCP; 22 Sep 88  17:27:00 PDTReceived: from bhopal ([192.9.200.13]) by heavens-gate.lucid.com id AA07074g; Thu, 22 Sep 88 16:25:15 PSTReceived: by bhopal id AA07353g; Thu, 22 Sep 88 17:24:43 PDTDate: Thu, 22 Sep 88 17:24:43 PDTFrom: Jon L White <jonl@lucid.com>Message-Id: <8809230024.AA07353@bhopal>To: cl-cleanup@sail.stanford.eduSubject: Issue: TAGBODY-CONTENTS (version 1)I'm happy with the restrictions proposed.For the record, I believe the reason pdp10 MacLisp allowed numbers,including flonums, as tags was that Ira Goldstein's LLOGO (a LOGOsystem written entirely in Lisp) just used READ for the statementnumbers, and they looked like floats; e.g., 1.1, 1.2, ... etc.  Theremay be more to it, but I distinctly remember an event like this inthe distant past.-- JonL --*start*01288 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 23 SEP 88 14:37:03 PDTReceived: from Think.COM by SAIL.Stanford.EDU with TCP; 23 Sep 88  14:32:19 PDTReturn-Path: <gls@Think.COM>Received: from joplin.think.com ([192.31.181.10]) by Think.COM; Fri, 23 Sep 88 17:31:27 EDTReceived: by joplin.think.com; Fri, 23 Sep 88 17:29:25 EDTDate: Fri, 23 Sep 88 17:29:25 EDTFrom: gls@Think.COMMessage-Id: <8809232129.AA02644@joplin.think.com>To: jonl@lucid.comCc: cl-cleanup@sail.stanford.eduIn-Reply-To: Jon L White's message of Thu, 22 Sep 88 17:24:43 PDT <8809230024.AA07353@bhopal>Subject: Issue: TAGBODY-CONTENTS (version 1)   Date: Thu, 22 Sep 88 17:24:43 PDT   From: Jon L White <jonl@lucid.com>   I'm happy with the restrictions proposed.   For the record, I believe the reason pdp10 MacLisp allowed numbers,   including flonums, as tags was that Ira Goldstein's LLOGO (a LOGO   system written entirely in Lisp) just used READ for the statement   numbers, and they looked like floats; e.g., 1.1, 1.2, ... etc.  There   may be more to it, but I distinctly remember an event like this in   the distant past.That is exactly what I recall.--Guy*start*04196 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 02 OCT 88 15:10:00 PDTReceived: from STONY-BROOK.SCRC.Symbolics.COM (SCRC-STONY-BROOK.ARPA) by SAIL.Stanford.EDU with TCP; 2 Oct 88  15:09:37 PDTReceived: from GRYPHON.SCRC.Symbolics.COM by STONY-BROOK.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 469126; Sun 2-Oct-88 18:08:25 EDTDate: Sun, 2 Oct 88 18:07 EDTFrom: Kent M Pitman <KMP@STONY-BROOK.SCRC.Symbolics.COM>Subject: Issue: TAGBODY-CONTENTS (Version 2)To: CL-Cleanup@SAIL.Stanford.EDUMessage-ID: <881002180755.9.KMP@GRYPHON.SCRC.Symbolics.COM>Changes... - I thought it would be good to merge the discussion as Rationale. - Several sections seemed to think that this proposal was making this   a "signal an error" situation. Since it was only "is an error",   implementations were still permitted to diverge. I corrected this   to make the change forbid implementations to extend the syntax.   I changed the proposal name from RESTRICT to FORBID-EXTENSION for   ease in referring to both proposals in case a problem comes up.) - I also noticed a funny(?) ambiguity about NIL in a tagbody -- it's   both a symbol and a list. Can you GO to it? I decided to address this.Hope the result is still non-controversial.-----Issue:		TAGBODY-CONTENTSReferences:	TAGBODY (pp 130-131 of CLtL)Category:	CLARIFICATIONEdit History:	13-Sep-88, version 1 by Walter van Roggen		02-Oct-88, version 2 by PitmanProblem Description:  CLtL specifies that symbols and integers are valid tags  in a TAGBODY and that lists are valid forms in a TAGBODY  but is silent about other data types.  Also, NIL is both a symbol and a list. Some implementations  might permit (GO NIL) because they treat NIL as a tag,  while others might not permit because they treat NIL as a form.Proposal (TAGBODY-CONTENTS:FORBID-EXTENSION):  TAGBODY treats symbols (including NIL) and integers as tags  and conses as forms.  It is an error if a form in a TAGBODY is not a symbol, integer,  or NIL. Implementations are forbidden from extending this syntax.  It is an error for the same (EQL) tag to appear more than once  in the body of a TAGBODY.  (However, a TAGBODY may have the  same tag as another TAGBODY in which it nests, in which case  the tag in the outer TAGBODY is shadowed, as already specified.)  The same restrictions apply to all forms which implicitly use  TAGBODY, such as PROG and DO.Rationale:  The proposed set of tags is expressionally adequate.  Other obvious candidate types have lurking problems that could  lead to subtle program bugs if permitted as tags. For example,   - Characters make bad tags because, for example,     (TAGBODY ... #\Return ... #\Newline ...)     will be an error in some implementations due to     (EQL #\Return #\Newline).   - Floats make bad tags because round-off error will vary     between implementations.   - Rationals have problems with reduction to lowest terms.     eg, (EQL 1/2 2/4). This doesn't vary between implementations     but may still cause surprises.Current Practice:  Symbolics Genera documents that only symbols or integers are permitted.  The restriction is enforced by the compiler, but not the interpreter.Cost to Implementors:  A few simple checks are probably all that's needed. Probably most  implementations (both interpreters and compilers) already perform them.Cost to Users:  Unlikely to affect any portable code.  If there are implementations which support other objects as tags  (floats, for example), there may be simple editing necessary.Benefits:  One less place for portability problems to occur.Aesthetics:  Makes the language description more precise.Discussion:  This first appeared in ">GLS>clarifications.text" of 12/06/85.  Historical Note (JonL, Steele):    The reason pdp10 MacLisp allowed numbers, including flonums,    as tags was that Ira Goldstein's LLOGO (a LOGO system    written entirely in Lisp) just used READ for the statement    numbers, and they looked like floats; e.g., 1.1, 1.2, ... etc.*start*01717 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 04 OCT 88 15:51:12 PDTReceived: from STONY-BROOK.SCRC.Symbolics.COM (SCRC-STONY-BROOK.ARPA) by SAIL.Stanford.EDU with TCP; 4 Oct 88  15:48:12 PDTReceived: from BOBOLINK.SCRC.Symbolics.COM by STONY-BROOK.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 470547; Tue 4-Oct-88 18:46:46 EDTReceived: from BOBOLINK.SCRC.Symbolics.COM by STONY-BROOK.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 470537; Tue 4-Oct-88 18:32:25 EDTDate: Tue, 4 Oct 88 18:32 EDTFrom: Kent M Pitman <KMP@STONY-BROOK.SCRC.Symbolics.COM>Subject: Re: Issue: TAGBODY-CONTENTS (Version 3) To: peck@Sun.COMcc: KMP@STONY-BROOK.SCRC.Symbolics.COMIn-Reply-To: <8810042215.AA11605@denali.sun.com>Message-ID: <881004183219.8.KMP@BOBOLINK.SCRC.Symbolics.COM>Resent-To: CL-Cleanup@SAIL.Stanford.EDUResent-From: Kent M Pitman <KMP@STONY-BROOK.SCRC.Symbolics.COM>Resent-Date: Tue, 4 Oct 88 18:46 EDTResent-Message-ID: <881004184640.9.KMP@BOBOLINK.SCRC.Symbolics.COM>That's an interesting issue that at least I was not thinking of.Since the current situation is technically ambiguous, I wouldargue that the code you're citing was technically in error.But by the same argument, so is the (GO NIL) case I was citing.Since my guess is that there are many more cases of the situationyou describe than there are of (GO NIL), my inclination would beto invert things.Since I have to rewrite the proposal anyway to merge your usefulcomments, I could just as well change it to make NIL a form andnot a tag.If anyone has an opinion on this, they should speak now.*start*02339 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 04 OCT 88 15:57:46 PDTReceived: from Riverside.SCRC.Symbolics.COM (SCRC-RIVERSIDE.ARPA) by SAIL.Stanford.EDU with TCP; 4 Oct 88  15:57:27 PDTReceived: from BOBOLINK.SCRC.Symbolics.COM by Riverside.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 285552; Tue 4-Oct-88 18:55:19 EDTReturn-path: <peck@SUN.COM>Received: from SUN.COM by STONY-BROOK.SCRC.Symbolics.COM via INTERNET with SMTP id 470521; 4 Oct 88 18:13:58 EDTReceived: from snail.sun.com by Sun.COM (4.0/SMI-4.0)	id AA02991; Tue, 4 Oct 88 15:11:07 PDTReceived: from denali.sun.com by snail.sun.com (4.0/SMI-4.0)	id AA19126; Tue, 4 Oct 88 15:14:03 PDTReceived: from localhost by denali.sun.com (3.2/SMI-3.2)	id AA11605; Tue, 4 Oct 88 15:15:51 PDTMessage-Id: <8810042215.AA11605@denali.sun.com>To: Kent M Pitman <KMP@STONY-BROOK.SCRC.Symbolics.COM>Subject: Re: Issue: TAGBODY-CONTENTS (Version 3) In-Reply-To: Your message of Tue, 04 Oct 88 17:19:00 -0400;	<881004171910.6.KMP@BOBOLINK.SCRC.Symbolics.COM> .Date: Tue, 04 Oct 88 15:15:49 -0700From: peck@Sun.COMResent-To: CL-Cleanup@SAIL.Stanford.EDUResent-From: Kent M Pitman <KMP@STONY-BROOK.SCRC.Symbolics.COM>Resent-Date: Tue, 4 Oct 88 18:55 EDTResent-Message-ID: <881004185556.0.KMP@BOBOLINK.SCRC.Symbolics.COM> Is anybody concerned about macros that expand to a tagbody with NIL forms?If NIL is a statement in a tagbody then they disappear quietly,especially after a pass by a good compiler.With the current proposal, though, one will get:  "ERROR: Multiple appearances of tag NIL."I don't know what current practice is, if code like this has always signalled an error then this is a total non-issue.If not, it might be noted as a possible conversion cost.Code like FOO1 will need to be rewritten to splice like in FOO2.  [sometimes it may not be this easy...](defmacro foo1 (&rest args)  `(do () ((test-fn))     ,(when (member :bar args) '(do-bar-thing))     ,(when (member :baz args) '(do-baz-things))     (do-regular-things)))(defmacro foo2 (&rest args)  `(do () ((test-fn))     ,@(when (member :bar args) '((do-bar-thing)))     ,@(when (member :baz args) '((do-baz-things)))     (do-regular-things)))*start*01081 00024 US Return-Path: <Gray@DSG.csc.ti.com>Received: from ti.com ([10.7.0.46]) by Xerox.COM ; 03 OCT 88 15:49:55 PDTReceived: by ti.com id AA25745; Mon, 3 Oct 88 17:49:39 CDTReceived: from Kelvin by tilde id AA12544; Mon, 3 Oct 88 17:45:19 CDTMessage-Id: <2800910767-11445984@Kelvin>Sender: GRAY@Kelvin.csc.ti.comDate: Mon, 3 Oct 88 17:46:07 CDTFrom: David N Gray <Gray@DSG.csc.ti.com>To: Kent M Pitman <KMP@SCRC-STONY-BROOK.ARPA>Cc: masinter.paSubject: Re: Issue: TAGBODY-CONTENTS (Version 2)In-Reply-To: Msg of Sun, 2 Oct 88 18:07 EDT from Kent M Pitman <KMP@SCRC-STONY-BROOK.ARPA>> Proposal (TAGBODY-CONTENTS:FORBID-EXTENSION):> >   TAGBODY treats symbols (including NIL) and integers as tags>   and conses as forms.> >   It is an error if a form in a TAGBODY is not a symbol, integer,>   or NIL.Don't you mean "symbol, integer, or cons"?> Current Practice:> >   Symbolics Genera documents that only symbols or integers are permitted.>   The restriction is enforced by the compiler, but not the interpreter.The Explorer does the same.*start*01128 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 04 OCT 88 14:12:35 PDTReceived: from STONY-BROOK.SCRC.Symbolics.COM (SCRC-STONY-BROOK.ARPA) by SAIL.Stanford.EDU with TCP; 4 Oct 88  14:04:34 PDTReceived: from EUPHRATES.SCRC.Symbolics.COM by STONY-BROOK.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 470456; Tue 4-Oct-88 17:03:08 EDTDate: Tue, 4 Oct 88 17:02 EDTFrom: David A. Moon <Moon@STONY-BROOK.SCRC.Symbolics.COM>Subject: Issue: TAGBODY-CONTENTS (Version 2)To: Kent M Pitman <KMP@STONY-BROOK.SCRC.Symbolics.COM>cc: CL-Cleanup@SAIL.Stanford.EDUIn-Reply-To: <881002180755.9.KMP@GRYPHON.SCRC.Symbolics.COM>Message-ID: <19881004210239.1.MOON@EUPHRATES.SCRC.Symbolics.COM>I approve TAGBODY-CONTENTS:FORBID-EXTENSION, except thatyou need to change the sentence  It is an error if a form in a TAGBODY is not a symbol, integer,  or NIL.to say whatever you really meant.  You probably meant to includetags as well as forms and you probably did not mean to excludeconses as valid forms.*start*03803 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 04 OCT 88 14:20:44 PDTReceived: from STONY-BROOK.SCRC.Symbolics.COM (SCRC-STONY-BROOK.ARPA) by SAIL.Stanford.EDU with TCP; 4 Oct 88  14:20:39 PDTReceived: from BOBOLINK.SCRC.Symbolics.COM by STONY-BROOK.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 470472; Tue 4-Oct-88 17:19:18 EDTDate: Tue, 4 Oct 88 17:19 EDTFrom: Kent M Pitman <KMP@STONY-BROOK.SCRC.Symbolics.COM>Subject: Issue: TAGBODY-CONTENTS (Version 3)To: CL-Cleanup@SAIL.Stanford.EDUMessage-ID: <881004171910.6.KMP@BOBOLINK.SCRC.Symbolics.COM>Ok, I changed the first two paragraphs of the proposal slightlyto accomodate criticisms by Moon and Gray. Everything else isthe same.Hopefully ready for release...-----Issue:		TAGBODY-CONTENTSReferences:	TAGBODY (pp 130-131 of CLtL)Category:	CLARIFICATIONEdit History:	13-Sep-88, version 1 by Walter van Roggen		02-Oct-88, version 2 by Pitman		 (beef up rationale, clarify tag NIL is ok)		04-Oct-88, version 3 by Pitman (fix wording bug)Problem Description:  CLtL specifies that symbols and integers are valid tags  in a TAGBODY and that lists are valid forms in a TAGBODY  but is silent about other data types.  Also, NIL is both a symbol and a list. Some implementations  might permit (GO NIL) because they treat NIL as a tag,  while others might not permit because they treat NIL as a form.Proposal (TAGBODY-CONTENTS:FORBID-EXTENSION):  TAGBODY treats symbols (including NIL) and integers as tags,  and treats conses as forms.  It is an error if an expression in a TAGBODY is not a symbol,  an integer, or a cons. Implementations are forbidden from  extending this syntax.  It is an error for the same (EQL) tag to appear more than once  in the body of a TAGBODY.  (However, a TAGBODY may have the  same tag as another TAGBODY in which it nests, in which case  the tag in the outer TAGBODY is shadowed, as already specified.)  The same restrictions apply to all forms which implicitly use  TAGBODY, such as PROG and DO.Rationale:  The proposed set of tags is expressionally adequate.  Other obvious candidate types have lurking problems that could  lead to subtle program bugs if permitted as tags. For example,   - Characters make bad tags because, for example,     (TAGBODY ... #\Return ... #\Newline ...)     will be an error in some implementations due to     (EQL #\Return #\Newline).   - Floats make bad tags because round-off error will vary     between implementations.   - Rationals have problems with reduction to lowest terms.     eg, (EQL 1/2 2/4). This doesn't vary between implementations     but may still cause surprises.Current Practice:  Symbolics Genera documents that only symbols or integers are permitted.  The restriction is enforced by the compiler, but not the interpreter.Cost to Implementors:  A few simple checks are probably all that's needed. Probably most  implementations (both interpreters and compilers) already perform them.Cost to Users:  Unlikely to affect any portable code.  If there are implementations which support other objects as tags  (floats, for example), there may be simple editing necessary.Benefits:  One less place for portability problems to occur.Aesthetics:  Makes the language description more precise.Discussion:  This first appeared in ">GLS>clarifications.text" of 12/06/85.  Historical Note (JonL, Steele):    The reason pdp10 MacLisp allowed numbers, including flonums,    as tags was that Ira Goldstein's LLOGO (a LOGO system    written entirely in Lisp) just used READ for the statement    numbers, and they looked like floats; e.g., 1.1, 1.2, ... etc.*start*04922 00024 USfReturn-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 05 OCT 88 20:32:01 PDTReceived: from STONY-BROOK.SCRC.Symbolics.COM (SCRC-STONY-BROOK.ARPA) by SAIL.Stanford.EDU with TCP; 5 Oct 88  20:31:55 PDTReceived: from BOBOLINK.SCRC.Symbolics.COM by STONY-BROOK.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 471496; Wed 5-Oct-88 23:30:42 EDTDate: Wed, 5 Oct 88 23:30 EDTFrom: Kent M Pitman <KMP@STONY-BROOK.SCRC.Symbolics.COM>Subject: Issue: TAGBODY-CONTENTS (Version 4)To: CL-Cleanup@SAIL.Stanford.EDUMessage-ID: <881005233028.2.KMP@BOBOLINK.SCRC.Symbolics.COM>I felt pretty good about this compromise solution.  I hope otherswill, too. It permits duplicated tags if they are unused, and itpermits (GO NIL). Hopefully that will make everything that runsnow continue to run with no serious loss of aesthetic appeal.I changed the proposal and extended the rationale. -kmp-----Issue:		TAGBODY-CONTENTSReferences:	TAGBODY (pp 130-131 of CLtL)Category:	CLARIFICATIONEdit History:	13-Sep-88, version 1 by Walter van Roggen		02-Oct-88, version 2 by Pitman		 (beef up rationale, clarify tag NIL is ok)		04-Oct-88, version 3 by Pitman (fix wording bug)	        05-Oct-88, version 4 by Pitman		 (modify proposal based on comments from Peck@Sun	 	  -- allow both (GO NIL) and unused duplicated tags)Problem Description:  CLtL specifies that symbols and integers are valid tags  in a TAGBODY and that lists are valid forms in a TAGBODY  but is silent about other data types.  Also, NIL is both a symbol and a list. Some implementations  might permit (GO NIL) because they treat NIL as a tag,  while others might not permit because they treat NIL as a form.Proposal (TAGBODY-CONTENTS:FORBID-EXTENSION):  TAGBODY treats symbols (including NIL) and integers as tags,  and treats conses as forms.  It is an error if an expression in a TAGBODY is not a symbol,  an integer, or a cons. Implementations are forbidden from  extending this syntax.  It is an error to do a GO to a tag name for which the same  (i.e., EQL) tag appears more than once in the body of the  innermost TAGBODY containing that tag.  The same restrictions apply to all forms which implicitly use  TAGBODY, such as PROG and DO.Rationale:  The proposed set of tags is expressionally adequate.  Other obvious candidate types have lurking problems that could  lead to subtle program bugs if permitted as tags. For example,   - Characters make bad tags because, for example,     (TAGBODY ... #\Return ... #\Newline ...)     will be an error in some implementations due to     (EQL #\Return #\Newline).   - Floats make bad tags because round-off error will vary     between implementations.   - Rationals have problems with reduction to lowest terms.     eg, (EQL 1/2 2/4). This doesn't vary between implementations     but may still cause surprises.  Duplicated tags are permitted in situations where no GO is done  to them primarily for two reasons:   - To permit NIL to occur more than once in common situations     such as:     (defmacro foo1 (&rest args)       `(do () ((test-fn))	  ,(when (member :bar args) '(do-bar-thing))	  ,(when (member :baz args) '(do-baz-things))	  (do-regular-things)))   - To permit the use of symbols as `dividers' between major     sections of code. eg,     (do (...)	 (...)	 -----	 (...)	 (...)	 -----	 (...))  It is not our intent particularly to encourage either of these  practices. Both are easy to work around. But current practice is  to permit such uses in many implementations, and there was no driving  reason to force such code to break.Current Practice:  Symbolics Genera documents that only symbols or integers are permitted.  The restriction is enforced by the compiler, but not the interpreter.  The TI Explorer permits using NIL as a GO tag, but as a special case,  does not warn about multiple appearances of NIL.Cost to Implementors:  A few simple checks are probably all that's needed. Probably most  implementations (both interpreters and compilers) already perform them.Cost to Users:  Unlikely to affect any portable code.  If there are implementations which support other objects as tags  (floats, for example), there may be simple editing necessary.Benefits:  One less place for portability problems to occur.Aesthetics:  Makes the language description more precise.Discussion:  This first appeared in ">GLS>clarifications.text" of 12/06/85.  Historical Note (JonL, Steele):    The reason pdp10 MacLisp allowed numbers, including flonums,    as tags was that Ira Goldstein's LLOGO (a LOGO system    written entirely in Lisp) just used READ for the statement    numbers, and they looked like floats; e.g., 1.1, 1.2, ... etc.  Pitman supports this proposal.*start*00910 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 05 OCT 88 20:44:34 PDTReceived: from Xerox.COM by SAIL.Stanford.EDU with TCP; 5 Oct 88  20:44:52 PDTReceived: from Semillon.ms by ArpaGateway.ms ; 05 OCT 88 20:43:19 PDTDate: 5 Oct 88 20:43 PDTFrom: masinter.paSubject: Re: Issue: TAGBODY-CONTENTS (Version 4)In-reply-to: Kent M Pitman <KMP@STONY-BROOK.SCRC.Symbolics.COM>'s message of Wed, 5 Oct 88 23:30 EDTTo: Kent M Pitman <KMP@STONY-BROOK.SCRC.Symbolics.COM>cc: CL-Cleanup@SAIL.Stanford.EDUMessage-ID: <881005-204319-2154@Xerox>It would be just as easy to say that if duplicate tags are present, thefirst one takes precedent. I'd say that along the lines of performance,implementation cost, readability that its a wash and that the aestheticsare slightly improved.*start*01542 00024 US Return-Path: <@STONY-BROOK.SCRC.Symbolics.COM,@BOBOLINK.SCRC.Symbolics.COM:KMP@STONY-BROOK.SCRC.Symbolics.COM>Received: from STONY-BROOK.SCRC.Symbolics.COM ([128.81.41.144]) by Xerox.COM ; 05 OCT 88 20:48:06 PDTReceived: from BOBOLINK.SCRC.Symbolics.COM by STONY-BROOK.SCRC.Symbolics.COM via INTERNET with SMTP id 471507; 5 Oct 88 23:48:18 EDTDate: Wed, 5 Oct 88 23:48 EDTFrom: Kent M Pitman <KMP@STONY-BROOK.SCRC.Symbolics.COM>Subject: Re: Issue: TAGBODY-CONTENTS (Version 4)To: Masinter.PAcc: KMP@STONY-BROOK.SCRC.Symbolics.COM, CL-Cleanup@SAIL.Stanford.EDUIn-Reply-To: <881005-204319-2154@Xerox>Message-ID: <881005234808.3.KMP@BOBOLINK.SCRC.Symbolics.COM>    Date: 5 Oct 88 20:43 PDT    From: masinter.pa@Xerox.COM    It would be just as easy to say that if duplicate tags are present, the    first one takes precedent.Indeed, it would be easy to say. It would be harder to feel reallycomfortable that that was what the user intended and that you didn'tjust have a syntax error. Just as reasonable would be to take the tagthat was visually closest, assuming the user couldn't get the wholefunction on the screen to see the conflict. I'd just as soon not makean arbitrary decision since I don't think anyone's pushing for it.The proposal on the table is conservative on this point, which is whyI like it.    I'd say that along the lines of performance, implementation cost,    readability that its a wash and that the aesthetics are slightly improved.By your suggestion, mine, or both?*start*01351 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 05 OCT 88 13:33:26 PDTReceived: from ti.com by SAIL.Stanford.EDU with TCP; 5 Oct 88  11:51:14 PDTReceived: by ti.com id AA10789; Wed, 5 Oct 88 13:49:36 CDTReceived: from Kelvin by tilde id AA26823; Wed, 5 Oct 88 13:35:29 CDTMessage-Id: <2801068586-4412902@Kelvin>Sender: GRAY@Kelvin.csc.ti.comDate: Wed, 5 Oct 88 13:36:26 CDTFrom: David N Gray <Gray@DSG.csc.ti.com>To: peck@SUN.COMCc: Kent M Pitman <KMP@SCRC-STONY-BROOK.ARPA>, CL-Cleanup@SAIL.STANFORD.EDUSubject: Re: Issue: TAGBODY-CONTENTS (Version 3) In-Reply-To: Msg of Tue, 04 Oct 88 15:15:49 -0700 from peck@SUN.COM>  Is anybody concerned about macros that expand to a tagbody with NIL forms?> If NIL is a statement in a tagbody then they disappear quietly,> especially after a pass by a good compiler.> With the current proposal, though, one will get:>   "ERROR: Multiple appearances of tag NIL."> > I don't know what current practice is, if code like this has > always signalled an error then this is a total non-issue.> If not, it might be noted as a possible conversion cost.The Explorer permits using NIL as a GO tag, but as a special case, doesnot warn about multiple appearances of NIL.*start*01922 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 05 OCT 88 13:33:29 PDTReceived: from STONY-BROOK.SCRC.Symbolics.COM (SCRC-STONY-BROOK.ARPA) by SAIL.Stanford.EDU with TCP; 5 Oct 88  12:03:03 PDTReceived: from BOBOLINK.SCRC.Symbolics.COM by STONY-BROOK.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 471066; Wed 5-Oct-88 15:00:56 EDTDate: Wed, 5 Oct 88 15:00 EDTFrom: Kent M Pitman <KMP@STONY-BROOK.SCRC.Symbolics.COM>Subject: Re: Issue: TAGBODY-CONTENTS (Version 3) To: Gray@DSG.csc.ti.comcc: peck@SUN.COM, KMP@STONY-BROOK.SCRC.Symbolics.COM, CL-Cleanup@SAIL.STANFORD.EDUIn-Reply-To: <2801068586-4412902@Kelvin>Message-ID: <881005150038.7.KMP@BOBOLINK.SCRC.Symbolics.COM>    Date: Wed, 5 Oct 88  13:36:26 CDT    From: David N Gray <Gray@DSG.csc.ti.com>    >  Is anybody concerned about macros that expand to a tagbody with NIL forms?    > If NIL is a statement in a tagbody then they disappear quietly,    > especially after a pass by a good compiler.    > With the current proposal, though, one will get:    >   "ERROR: Multiple appearances of tag NIL."    >     > I don't know what current practice is, if code like this has     > always signalled an error then this is a total non-issue.    > If not, it might be noted as a possible conversion cost.    The Explorer permits using NIL as a GO tag, but as a special case, does    not warn about multiple appearances of NIL.Hmmm. That suggests another alternative: We could leave NIL being a tagand just say that it's an error to repeat a tag only if you also GO toit.  That would mean that other tags could be repeated as well. eg, Iseem to recall that some people put ------ in their tagbodies asseparators between major sections. As long as they didn't also do (GO-----), their practice would be legitimized.*start*01044 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 06 OCT 88 13:01:56 PDTReceived: from STONY-BROOK.SCRC.Symbolics.COM (SCRC-STONY-BROOK.ARPA) by SAIL.Stanford.EDU with TCP; 6 Oct 88  13:02:04 PDTReceived: from EUPHRATES.SCRC.Symbolics.COM by STONY-BROOK.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 472019; Thu 6-Oct-88 16:00:36 EDTDate: Thu, 6 Oct 88 16:00 EDTFrom: David A. Moon <Moon@STONY-BROOK.SCRC.Symbolics.COM>Subject: Issue: TAGBODY-CONTENTS (Version 4)To: Kent M Pitman <KMP@STONY-BROOK.SCRC.Symbolics.COM>cc: CL-Cleanup@SAIL.Stanford.EDUIn-Reply-To: <881005233028.2.KMP@BOBOLINK.SCRC.Symbolics.COM>Message-ID: <19881006200018.7.MOON@EUPHRATES.SCRC.Symbolics.COM>TAGBODY-CONTENTS:FORBID-EXTENSION is fine.I hope it's clear enough that it is -not- an error to haveduplicate tags in a TAGBODY if no one goes to them.  This isimplied but not stated explicitly within the body of the proposal.*start*04163 00024 USfDate:  7 Oct 88 23:33 PDTFrom: masinter.paSubject: Issue: TAGBODY-CONTENTS (Version 4)To: x3j13@sail.stanford.eduREPLY-TO: cl-cleanup@sail.stanford.eduline-fold: NOcc: MasinterIssue:		TAGBODY-CONTENTSReferences:	TAGBODY (pp 130-131 of CLtL)Category:	CLARIFICATIONEdit History:	13-Sep-88, version 1 by Walter van Roggen		02-Oct-88, version 2 by Pitman		 (beef up rationale, clarify tag NIL is ok)		04-Oct-88, version 3 by Pitman (fix wording bug)	        05-Oct-88, version 4 by Pitman		 (modify proposal based on comments from Peck@Sun	 	  -- allow both (GO NIL) and unused duplicated tags)Problem Description:  CLtL specifies that symbols and integers are valid tags  in a TAGBODY and that lists are valid forms in a TAGBODY  but is silent about other data types.  Also, NIL is both a symbol and a list. Some implementations  might permit (GO NIL) because they treat NIL as a tag,  while others might not permit because they treat NIL as a form.Proposal (TAGBODY-CONTENTS:FORBID-EXTENSION):  TAGBODY treats symbols (including NIL) and integers as tags,  and treats conses as forms.  It is an error if an expression in a TAGBODY is not a symbol,  an integer, or a cons. Implementations are forbidden from  extending this syntax.  It is an error to do a GO to a tag name for which the same  (i.e., EQL) tag appears more than once in the body of the  innermost TAGBODY containing that tag.  The same restrictions apply to all forms which implicitly use  TAGBODY, such as PROG and DO.Rationale:  The proposed set of tags is expressionally adequate.  Other obvious candidate types have lurking problems that could  lead to subtle program bugs if permitted as tags. For example,   - Characters make bad tags because, for example,     (TAGBODY ... #\Return ... #\Newline ...)     will be an error in some implementations due to     (EQL #\Return #\Newline).   - Floats make bad tags because round-off error will vary     between implementations.   - Rationals have problems with reduction to lowest terms.     eg, (EQL 1/2 2/4). This doesn't vary between implementations     but may still cause surprises.  Duplicated tags are permitted in situations where no GO is done  to them primarily for two reasons:   - To permit NIL to occur more than once in common situations     such as:     (defmacro foo1 (&rest args)       `(do () ((test-fn))	  ,(when (member :bar args) '(do-bar-thing))	  ,(when (member :baz args) '(do-baz-things))	  (do-regular-things)))   - To permit the use of symbols as `dividers' between major     sections of code. eg,     (do (...)	 (...)	 -----	 (...)	 (...)	 -----	 (...))  It is not our intent particularly to encourage either of these  practices. Both are easy to work around. But current practice is  to permit such uses in many implementations, and there was no driving  reason to force such code to break.Current Practice:  Symbolics Genera documents that only symbols or integers are permitted.  The restriction is enforced by the compiler, but not the interpreter.  The TI Explorer permits using NIL as a GO tag, but as a special case,  does not warn about multiple appearances of NIL.Cost to Implementors:  A few simple checks are probably all that's needed. Probably most  implementations (both interpreters and compilers) already perform them.Cost to Users:  Unlikely to affect any portable code.  If there are implementations which support other objects as tags  (floats, for example), there may be simple editing necessary.Benefits:  One less place for portability problems to occur.Aesthetics:  Makes the language description more precise.Discussion:  This first appeared in ">GLS>clarifications.text" of 12/06/85.  Historical Note (JonL, Steele):    The reason pdp10 MacLisp allowed numbers, including flonums,    as tags was that Ira Goldstein's LLOGO (a LOGO system    written entirely in Lisp) just used READ for the statement    numbers, and they looked like floats; e.g., 1.1, 1.2, ... etc.  Pitman supports this proposal.     ----- End Forwarded Messages -----*start*01096 00024 USaReturn-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 18 OCT 88 13:41:01 PDTReceived: from decwrl.dec.com by SAIL.Stanford.EDU with TCP; 18 Oct 88  12:19:59 PDTReceived: by decwrl.dec.com (5.54.5/4.7.34)	id AA04253; Tue, 19 Apr 88 20:15:23 PDTDate: Tue, 19 Apr 88 20:15:23 PDTMessage-Id: <8804200315.AA04253@decwrl.dec.com>From: vanroggen%aitg.DEC@decwrl.dec.comTo: cl-cleanup@sail.stanford.eduSubject: Re: Issue: TAGBODY-CONTENTSI strongly disagree with the version 4 change to allow duplicatetags as long as there is no GO to them.  If one really wants to beable to use NIL as a statement because of the way many people writemacros, then let's change the proposal to treat NIL as a statement,and not as a tag.  And the rationale about using symbols as dividersin code sounds pretty weak to me--that what comments are for.I never saw version 3 of the proposal, but it sounds more like whatI'd find reasonable, judging by the change history.			---Walter*start*01336 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 30 NOV 88 21:05:58 PSTReceived: from Xerox.COM by SAIL.Stanford.EDU with TCP; 30 Nov 88  21:04:47 PSTReceived: from Semillon.ms by ArpaGateway.ms ; 30 NOV 88 21:04:06 PSTDate: 30 Nov 88 21:03 PSTFrom: masinter.paSubject: Issue: TAGBODY-CONTENTS (Version 4)In-reply-to: vanroggen%aitg.DEC@decwrl.dec.com's message of Tue, 19 Apr 88 20:15:23 PDT (really 18-Oct-88)To: vanroggen%aitg.DEC@decwrl.dec.comcc: cl-cleanup@sail.stanford.eduMessage-ID: <881130-210406-3763@Xerox>The acceptability of the proposal might improve with some rewording, e.g.,expressing it as a constraint on GO instead of on TAGBODY.For example:A TAGBODY's body consists of arbitrary data elements with arbitraryduplications. Elements that are lists (CONSP) are evaluated inleft-to-write order. Any other elements are ignored by TAGBODY. However,GO is only legal when given a symbol or integer. The results of executingGO when there is more than one instance of the same (EQL) symbol or integerat the top level of any TAGBODY are unspecified.Thus(TAGBODY 3.4 4.5 (print "hi there"))is legal, although useless just as (PROGN 3.4 4.5 (print "hi there")) mightbe.*start*01902 00024 US Return-Path: <KMP@STONY-BROOK.SCRC.Symbolics.COM>Received: from STONY-BROOK.SCRC.Symbolics.COM ([128.81.41.144]) by Xerox.COM ; 30 NOV 88 22:25:39 PSTReceived: from BOBOLINK.SCRC.Symbolics.COM by STONY-BROOK.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 500522; Thu 1-Dec-88 01:26:05 ESTDate: Thu, 1 Dec 88 01:25 ESTFrom: Kent M Pitman <KMP@STONY-BROOK.SCRC.Symbolics.COM>Subject: Issue: TAGBODY-CONTENTS (Version 4)To: masinter.pacc: vanroggen%aitg.DEC@decwrl.dec.com, cl-cleanup@sail.stanford.eduIn-Reply-To: <881130-210406-3763@Xerox>Message-ID: <881201012556.6.KMP@BOBOLINK.SCRC.Symbolics.COM>    Date: 30 Nov 88 21:03 PST    From: masinter.pa@Xerox.COM    The acceptability of the proposal might improve with some rewording, e.g.,    expressing it as a constraint on GO instead of on TAGBODY.    For example:    A TAGBODY's body consists of arbitrary data elements with arbitrary    duplications. Elements that are lists (CONSP) are evaluated in    left-to-write order. Any other elements are ignored by TAGBODY. However,    GO is only legal when given a symbol or integer. The results of executing    GO when there is more than one instance of the same (EQL) symbol or integer    at the top level of any TAGBODY are unspecified.I'd say:A TAGBODY's body consists of arbitrary data elements with arbitraryduplications. Elements that are lists (CONSP) are evaluated inleft-to-right order. Any other elements are ignored by TAGBODY. However,GO is only legal when the given tag is a symbol or integer. The resultsof executing GO when there is more than one instance of the same (EQL)tag at the top level of the innermost TAGBODY containing that tag areunspecified.    Thus    (TAGBODY 3.4 4.5 (print "hi there"))    is legal, although useless just as (PROGN 3.4 4.5 (print "hi there")) might    be.Personally, I like this approach.*start*05171 00024 US Date:  9 Dec 88 13:39 PSTSender: masinter.paTo: x3j13@sail.stanford.eduSubject: Issue: TAGBODY-CONTENTS (Version 5)From: cl-cleanup@sail.stanford.edureply-to: cl-cleanup@sail.stanford.educc: masinterline-fold: noForum:          CleanupIssue:          TAGBODY-CONTENTSReferences:     TAGBODY (pp 130-131 of CLtL)Category:       CLARIFICATIONEdit History:   13-Sep-88, version 1 by Walter van Roggen                02-Oct-88, version 2 by Pitman                 (beef up rationale, clarify tag NIL is ok)                04-Oct-88, version 3 by Pitman (fix wording bug)                05-Oct-88, version 4 by Pitman                 (modify proposal based on comments from Peck@Sun                   -- allow both (GO NIL) and unused duplicated tags)                 9-Dec-88, Version 5 by Masinter (wording per Pitman)Problem Description:  CLtL specifies that symbols and integers are valid tags  in a TAGBODY and that lists are valid forms in a TAGBODY  but is silent about other data types.  Also, NIL is both a symbol and a list. Some implementations  might permit (GO NIL) because they treat NIL as a tag,  while others might not permit because they treat NIL as a form.Proposal (TAGBODY-CONTENTS:FORBID-EXTENSION):A TAGBODY's body may contain arbitrary data elements; noconstraints are placed on duplication of those elements.duplications. Elements that are lists (CONSP) are evaluated inleft-to-right order. Any other elements are ignored by TAGBODY. However,GO is only legal when the given a tag that is a symbol or integer. The resultsof executing GO when there is more than one instance of the same (EQL)tag at the top level of the innermost TAGBODY containing that tag areunspecified.In particular it is an error to use a character, floating point number,ratio or other data element as a tag to GO.The same restrictions apply to all forms which implicitly useTAGBODY, such as PROG and DO.Examples:;; legal, but useless     (TAGBODY 3.4 4.5 (print "hi there"));; not legal(tagbody        (ecase char (#\a (go #\a)) (#\b (go #\b)))        #\a (print "Apple")        #\b (print "Ball"));;legal, even when args are NIL:     (defmacro foo1 (&rest args)       `(do () ((test-fn))          ,(when (member :bar args) '(do-bar-thing))          ,(when (member :baz args) '(do-baz-things))          (do-regular-things)));; legal, but bad style     (do (...)         (...)         -----         (...)         (...)         -----         (...))Rationale:  The proposed set of tags is expressionally adequate.  Other candidate types have lurking problems that could  lead to subtle program bugs if permitted as tags. For example,   - Characters make bad tags because, for example,     (TAGBODY ... #\Return ... #\Newline ...)     will be an error in some implementations due to     (EQL #\Return #\Newline).   - Floats make bad tags because round-off error will vary     between implementations.   - Rationals have problems with reduction to lowest terms.     eg, (EQL 1/2 2/4). This doesn't vary between implementations     but may still cause surprises.  Duplicated tags are permitted in situations where no GO is done  to them; it is not our intent particularly to encourage the  practice. . But current practice is    to permit such uses in  many implementations, and there was no driving  reason to force such code to break.Current Practice:  Symbolics Genera documents that only symbols or integers are permitted.  The restriction is enforced by the compiler, but not the interpreter.  The TI Explorer permits using NIL as a GO tag, but as a special case,  does not warn about multiple appearances of NIL.  Many implementations allow duplicate tags if there is no GO to them.Cost to Implementors:  A few simple checks are probably all that's needed. Probably most  implementations (both interpreters and compilers) already perform them.  Implementations that disallow duplicate tags (generally in the   compiler but not the interpreter) will have to remove the   error checks.Cost to Users:  Unlikely to affect any portable code.  If there are implementations which support other objects as tags  (floats, for example), other (likely minor) changes will be  necessary.Benefits:  One less place for portability problems to occur.Aesthetics:  Makes the language description more precise.Discussion:  This issue was first included in in ">GLS>clarifications.text"  of 12/06/85.  Historical Note (JonL, Steele):    The reason pdp10 MacLisp allowed numbers, including flonums,    as tags was that Ira Goldstein's LLOGO (a LOGO system    written entirely in Lisp) just used READ for the statement    numbers, and they looked like floats; e.g., 1.1, 1.2, ... etc.        TITAN 
         TITAN 
           Z              …                                                              Ô             Y       .      ·       
      0             ‚             X                           ¹       
       6              1             t      Å  zº*start*05151 00024 US Return-Path: <X3J13-mailer@SAIL.Stanford.EDU>Received: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 09 DEC 88 14:23:21 PSTReceived: from Xerox.COM by SAIL.Stanford.EDU with TCP; 9 Dec 88  14:06:43 PSTReceived: from Semillon.ms by ArpaGateway.ms ; 09 DEC 88 13:39:52 PSTDate: 9 Dec 88 13:39 PSTSender: masinter.paTo: x3j13@sail.stanford.eduSubject: Issue: TAGBODY-CONTENTS (Version 5)From: cl-cleanup@sail.stanford.edureply-to: cl-cleanup@sail.stanford.educc: masinter.paline-fold: noMessage-ID: <881209-133952-701@Xerox>!Forum:          CleanupIssue:          TAGBODY-CONTENTSReferences:     TAGBODY (pp 130-131 of CLtL)Category:       CLARIFICATIONEdit History:   13-Sep-88, version 1 by Walter van Roggen                02-Oct-88, version 2 by Pitman                 (beef up rationale, clarify tag NIL is ok)                04-Oct-88, version 3 by Pitman (fix wording bug)                05-Oct-88, version 4 by Pitman                 (modify proposal based on comments from Peck@Sun                   -- allow both (GO NIL) and unused duplicated tags)                 9-Dec-88, Version 5 by Masinter (wording per Pitman)Problem Description:  CLtL specifies that symbols and integers are valid tags  in a TAGBODY and that lists are valid forms in a TAGBODY  but is silent about other data types.  Also, NIL is both a symbol and a list. Some implementations  might permit (GO NIL) because they treat NIL as a tag,  while others might not permit because they treat NIL as a form.Proposal (TAGBODY-CONTENTS:FORBID-EXTENSION):A TAGBODY's body may contain arbitrary data elements; noconstraints are placed on duplication of those elements.duplications. Elements that are lists (CONSP) are evaluated inleft-to-right order. Any other elements are ignored by TAGBODY. However,GO is only legal when the given a tag that is a symbol or integer. The resultsof executing GO when there is more than one instance of the same (EQL)tag at the top level of the innermost TAGBODY containing that tag areunspecified.In particular it is an error to use a character, floating point number,ratio or other data element as a tag to GO.The same restrictions apply to all forms which implicitly useTAGBODY, such as PROG and DO.Examples:;; legal, but useless     (TAGBODY 3.4 4.5 (print "hi there"));; not legal(tagbody        (ecase char (#\a (go #\a)) (#\b (go #\b)))        #\a (print "Apple")        #\b (print "Ball"));;legal, even when args are NIL:     (defmacro foo1 (&rest args)       `(do () ((test-fn))          ,(when (member :bar args) '(do-bar-thing))          ,(when (member :baz args) '(do-baz-things))          (do-regular-things)));; legal, but bad style     (do (...)         (...)         -----         (...)         (...)         -----         (...))Rationale:  The proposed set of tags is expressionally adequate.  Other candidate types have lurking problems that could  lead to subtle program bugs if permitted as tags. For example,   - Characters make bad tags because, for example,     (TAGBODY ... #\Return ... #\Newline ...)     will be an error in some implementations due to     (EQL #\Return #\Newline).   - Floats make bad tags because round-off error will vary     between implementations.   - Rationals have problems with reduction to lowest terms.     eg, (EQL 1/2 2/4). This doesn't vary between implementations     but may still cause surprises.  Duplicated tags are permitted in situations where no GO is done  to them; it is not our intent particularly to encourage the  practice. . But current practice is    to permit such uses in  many implementations, and there was no driving  reason to force such code to break.Current Practice:  Symbolics Genera documents that only symbols or integers are permitted.  The restriction is enforced by the compiler, but not the interpreter.  The TI Explorer permits using NIL as a GO tag, but as a special case,  does not warn about multiple appearances of NIL.  Many implementations allow duplicate tags if there is no GO to them.Cost to Implementors:  A few simple checks are probably all that's needed. Probably most  implementations (both interpreters and compilers) already perform them.  Implementations that disallow duplicate tags (generally in the   compiler but not the interpreter) will have to remove the   error checks.Cost to Users:  Unlikely to affect any portable code.  If there are implementations which support other objects as tags  (floats, for example), other (likely minor) changes will be  necessary.Benefits:  One less place for portability problems to occur.Aesthetics:  Makes the language description more precise.Discussion:  This issue was first included in in ">GLS>clarifications.text"  of 12/06/85.  Historical Note (JonL, Steele):    The reason pdp10 MacLisp allowed numbers, including flonums,    as tags was that Ira Goldstein's LLOGO (a LOGO system    written entirely in Lisp) just used READ for the statement    numbers, and they looked like floats; e.g., 1.1, 1.2, ... etc.*start*00893 00024 USaReturn-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 02 JAN 89 21:27:24 PSTReceived: from Riverside.SCRC.Symbolics.COM (SCRC-RIVERSIDE.ARPA) by SAIL.Stanford.EDU with TCP; 2 Jan 89  21:27:05 PSTReceived: from BOBOLINK.SCRC.Symbolics.COM by Riverside.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 305264; Tue 3-Jan-89 00:25:14 ESTDate: Tue, 3 Jan 89 00:25 ESTFrom: Kent M Pitman <KMP@STONY-BROOK.SCRC.Symbolics.COM>Subject: Issue: TAGBODY-CONTENTS (Version 5)To: CL-Cleanup@SAIL.STANFORD.EDUMessage-ID: <890103002508.1.KMP@BOBOLINK.SCRC.Symbolics.COM>Typo (extra word in "the given a tag") in para 1 of Proposal.The term "data element" is too vague in para 2 of Proposal.These should be fixed before final vote; the latter could lead toserious confusion.*start*01747 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 09 JAN 89 19:43:16 PSTReceived: from Xerox.COM by SAIL.Stanford.EDU with TCP; 9 Jan 89  19:43:03 PSTReceived: from Semillon.ms by ArpaGateway.ms ; 09 JAN 89 19:41:00 PSTDate: 9 Jan 89 19:40 PSTFrom: masinter.paSubject: Re: Issue: TAGBODY-CONTENTS (Version 5)In-reply-to: Kent M Pitman <KMP@STONY-BROOK.SCRC.Symbolics.COM>'s message of Tue, 3 Jan 89 00:25 ESTTo: Kent M Pitman <KMP@STONY-BROOK.SCRC.Symbolics.COM>cc: CL-Cleanup@SAIL.STANFORD.EDUMessage-ID: <890109-194100-5316@Xerox>I wrote up this proposal in the current form, but I've had some secondthoughts as I'm trying to deal the ballot comments. I've forgotten the reasons for allowing other types of objects in TAGBODYbodies. I still like the part about duplicate elements was the part aboutduplication, viz: duplicates are OK if there's no GO.Walter's objections were not included in the proposal writeup, I'vediscovered:"I strongly disagree with the version 4 change to allow duplicatetags as long as there is no GO to them.  If one really wants to beable to use NIL as a statement because of the way many people writemacros, then let's change the proposal to treat NIL as a statement,and not as a tag.  And the rationale about using symbols as dividersin code sounds pretty weak to me--that what comments are for.I never saw version 3 of the proposal, but it sounds more like whatI'd find reasonable, judging by the change history.			---Walter"I guess we can talk about this next week. I'm just saying I've probablychanged my mind -- not that this is an important issue.*start*00951 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 12 JAN 89 00:48:54 PSTReceived: from Xerox.COM by SAIL.Stanford.EDU with TCP; 12 Jan 89  00:48:21 PSTReceived: from Semillon.ms by ArpaGateway.ms ; 12 JAN 89 00:45:14 PSTDate: 12 Jan 89 00:44 PSTFrom: masinter.paSubject: Issue: TAGBODY-CONTENTS (Version 5)In-reply-to: Jeff Dalton <jeff%aiai.edinburgh.ac.uk@NSS.Cs.Ucl.AC.UK>'s message of Thu, 12 Jan 89 03:57:03 GMTTo: Jeff Dalton <jeff%aiai.edinburgh.ac.uk@NSS.Cs.Ucl.AC.UK>cc: cl-cleanup@sail.stanford.eduMessage-ID: <890112-004514-11904@Xerox>On your ballot, you said:"Contents should be valid forms (including self-evaluating) or valid tags.Duplicate tags should be an error (as in the proposal)."However, the EVAL-OTHER proposal passed at the last meeting makes all"other" objections self-evaluating.*start*01109 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 12 JAN 89 15:19:24 PSTReceived: from NSS.Cs.Ucl.AC.UK by SAIL.Stanford.EDU with TCP; 12 Jan 89  15:17:44 PSTReceived: from aiai.edinburgh.ac.uk by NSS.Cs.Ucl.AC.UK   via Janet with NIFTP           id aa09212; 12 Jan 89 23:08 GMTDate: Thu, 12 Jan 89 23:11:35 GMTMessage-Id: <21725.8901122311@subnode.aiai.ed.ac.uk>From: Jeff Dalton <jeff%aiai.edinburgh.ac.uk@NSS.Cs.Ucl.AC.UK>Subject: Re: Issue: TAGBODY-CONTENTS (Version 5)To: masinter.paIn-Reply-To: masinter.pa@com.xerox's message of 12 Jan 89 00:44 PSTCc: cl-cleanup@sail.stanford.edu> On your ballot, you said:> > "Contents should be valid forms (including self-evaluating) or valid tags.> Duplicate tags should be an error (as in the proposal)."> > However, the EVAL-OTHER proposal passed at the last meeting makes all> "other" objections self-evaluating.Right, I'd forgotten that.  I'd still prefer that the contents bedescribed as forms rather than data.