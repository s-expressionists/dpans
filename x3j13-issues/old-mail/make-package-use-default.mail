*start*01900 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 23 SEP 88 01:25:12 PDTReceived: from Xerox.COM by SAIL.Stanford.EDU with TCP; 23 Sep 88  01:25:04 PDTReceived: from Cabernet.ms by ArpaGateway.ms ; 23 SEP 88 01:18:51 PDTDate: 23 Sep 88 01:19 PDTFrom: masinter.paSubject: Issue: MAKE-PACKAGE-USE-DEFAULT (split from PACKAGE-CLUTTER)In-reply-to: Jon L White <jonl@lucid.com>'s message of Fri, 23 Sep 88 00:18:50 PDTTo: Jon L White <jonl@lucid.com>cc: cl-cleanup@sail.stanford.eduMessage-ID: <880923-011851-3969@Xerox>(I thought I'd mailed this, but apparently I left it pending while I rewrotePACKAGE-CLUTTER. Since I'm hoping to split out the default from :USE from theissue of what's actually in the Lisp package, I've put this under a differentIssue name.- - - - - - - -One of the complaints I hear frequently about Common Lisp is how non-portable itis -- how people with Common Lisp code had to work really hard to port theirstuff from Vendor 1 to Vendor 2 even on the same machine, and that it must bereally not a very good language definition compared to C. I usually think thisis backward, and isn't CL great how it is even portable across machines withdifferent word sizes.But then I get to issues like this, where if you write a simple program thatsays (in-package "FROB") (defun draw-line (x y) ...)that when they go to port it to Vendor y, they find out that their simpleprogram crashes the graphics package because draw-line now has the wrongarguments. "I meant FROB:DRAW-LINE, not some LU-GRAPHICS:DRAW-LINE."?I think this is the same argument that Kent made, so I won't belabor it. Maybethe lines are drawn fairly clear. Its a tradeoff of encouraging portability vsconvenience for users of a specific implementation.  *start*03257 00024 US Return-Path: <jonl@lucid.com>Received: from lucid.com ([192.26.25.1]) by Xerox.COM ; 26 SEP 88 17:17:54 PDTReceived: from bhopal ([192.9.200.13]) by heavens-gate.lucid.com id AA09621g; Mon, 26 Sep 88 16:17:13 PSTReceived: by bhopal id AA02429g; Mon, 26 Sep 88 17:16:45 PDTDate: Mon, 26 Sep 88 17:16:45 PDTFrom: Jon L White <jonl@lucid.com>Message-Id: <8809270016.AA02429@bhopal>To: masinter.paCc: cl-cleanup@sail.stanford.eduIn-Reply-To: masinter.pa@Xerox.COM's message of 23 Sep 88 01:19 PDT <880923-011851-3969@Xerox>Subject: Issue: MAKE-PACKAGE-USE-DEFAULT (split from PACKAGE-CLUTTER)re: But then I get to issues like this, where if you write a simple program     that says       (in-package "FROB")        (defun draw-line (x y) ...)    that when they go to port it to Vendor y, they find out that their simple    program crashes the graphics package because draw-line now has the wrong    arguments. "I meant FROB:DRAW-LINE, not some LU-GRAPHICS:DRAW-LINE."?First, the 'in-package' statement doesn't necessarily define the package,and hence one can't assume a default :use list.  Probably one of the more confusing bugs that users fall into is having two slightly different package creation forms in two different files belonging to the same package.  Say:    (in-package "FROB" :use '(:lisp :holistics))in the first file, and    (in-package "FROB")in the second.  IN-PACKAGE as currently defined is not supposed to "warn" you if the package doesn't already exist, or if it exists with components different from what you specified.  You simply lose if you process the second file first.[Incidentally, this brings up the fact that the only utility of a DEFPACKAGE proposal is that it tends to focus on one place, and one place only, where a package can be defined.  The proposal adds absolutely no functionality not currently available with the "7 extremely randoms" and 'eval-when' -- it merely focuses the user's attention.]Second -- as mentioned in prior mail -- those currently porting from vendor to vendor will *never* allow the :use argument to MAKE-PACKAGE to be defaulted.  This good practice could be encouraged by removing from thestandard any requirement about what the default will be.  Those involved in *converting* code written for one vendor's Lisp to run in another vendor's face a different problem, namely how to reconcile the names they have used with those "available" under the other vendor [frequently, they evenaren't concerned with being super-portable, especially when it comesto windows and graphics capabilities, since there is no standard yetin those realms.]The references to the portability of C programs, and to the difficultyof porting CL programs, seems to be completely ignorant of the horribleproblem in porting between one vendor's Unix library and another's.  As if C were merely a "language" with no library support needed!  But in factCLtL is not only a specification for the hard-core language, but that alsofor the greater part of the runtime-library.At any rate, portabililty is not sacrificed in the least when it is definedas "portable programs must supply the :use argument to MAKE-PACKAGE andfriends."-- JonL --*start*05172 00024 USfReturn-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 06 OCT 88 22:21:35 PDTReceived: from lucid.com by SAIL.Stanford.EDU with TCP; 6 Oct 88  22:20:19 PDTReceived: from bhopal ([192.9.200.13]) by heavens-gate.lucid.com id AA01038g; Thu, 6 Oct 88 22:19:08 PDTReceived: by bhopal id AA07620g; Thu, 6 Oct 88 22:17:28 PDTDate: Thu, 6 Oct 88 22:17:28 PDTFrom: Jon L White <jonl@lucid.com>Message-Id: <8810070517.AA07620@bhopal>To: cl-cleanup@sail.stanford.eduIn-Reply-To: masinter.pa@Xerox.COM's message of 23 Sep 88 01:19 PDT <880923-011851-3969@Xerox>Subject: Issue: MAKE-PACKAGE-USE-DEFAULT (version 1)Issue:        MAKE-PACKAGE-USE-DEFAULT References:    MAKE-PACKAGE, CLtL p183               "USER" package, CLtL p181Related issues: PACKAGE-CLUTTERCategory:      CHANGEEdit history:  JonL White, 6-Oct-88 (version 1)Problem description:CLtL is underspecified as how to treat vendor-specific extensions to the language; and every vendor has a fairly large set of such extensions.A general understanding came over the community during 1986 that vendors should "home" their extensions in a vendor-specific package, and not in any of the packages named in CLtL section 11.6 "Built-in Packages".  Just how these symbols would be accessible to the user, however, was not stated.All  current means of providing "unqualified accessibility" to the vendors' extensions will violate either some trivial part of CLtL, such as the default :use list for MAKE-PACKAGE, or the prohibition of adding non-standard symbols to the LISP package, or the apparent charge that the USER package should use (only) the LISP package.Proposal MAKE-PACKAGE-USE-DEFAULT:IMPLEMENTATION-DEPENDENTSpecify that the default value for the :use argument to MAKE-PACKAGE is implementation-dependent; portable code would thus have to explicitly designate the LISP package as the :use argument.  Vendors are encouraged to put their vendor-specific package on the default list, along with the LISP package and any other packages so specified by the new standard.Examples:(package-use-list (make-package "SOME-USER"))(package-use-list "USER")Test Cases:(assert     (subsetp `(,(find-package "LISP"))              (package-use-list (or (find-package "SOME-USER")				    (make-package "SOME-USER")))))Rationale:Every vendor either already does the equivalent of this, or else has a confusing assymetry about the USER package (i.e., their propietaryextensions are "available" in USER, but not in SOME-USER).Current practice:TI and Lucid's  3.0 versions "implement" this proposal in that they set the default :use argument to be a list of the LISP package and the vendor-specific package. VAXLISP has renamed the LISP package to be the same as the vendor-specificpackage, which contains the 775 symbols supposed to be in the LISP packgealong with all the vendors extensions; the package named COMMON-LISPhas only the 775.  Thus this "implements" the proposal in the sense thatthe inheritance of a package made with a default :use list containsall the vendor-specific symbols -- not just the 775 "LISP" ones.Symbolics release 7, and Lucid's 2.1 release use only '("LISP") for thedefault MAKE-PACKAGE use list, but have the aforementioned assymetryabout the USER package.Cost to Implementors:None; this relaxes a constraint imposed by CLtL.Cost to Users:In theory, every user porting code from one vendor to another wouldhave to ensure that every package definition, via IN-PACKAGE orMAKE-PACKAGE, had an explicit :use list.  This is probably at mosta 5-minute text editor search.  But in fact this imposition is moot,since virtually every such user has *already* supplied explicit:use lists; given the current practice, he has had no alternative.Cost of non-adoption:There will continue to be a lack of clear standardization in this area,especially since vendors are more willing to violate this apparentlyunuseful mandate from CLtL than they are to give up a minor bias towardstheir customer base.Performance impact:None.Benefits:This new default behaviour for package creation will permit a vendor'sdocumented extensions to appear on equal footing with the basic facilitiesin the LISP package.  It appears as though the _majority_ of any vendors' customers are developing and running their code totally within the enviornment provided by that one vendor; hence it seems reasonable forvendors to bias their default use list towards those customers making frequent use of their specific extensions to Common Lisp.Esthetics:Some feel that fewer implementation-dependent loopholes in the languageis preferable, even when the practical import is virtually moot.Discussion:Lucid "exposes" the default :use list as the value of the specialvariable *DEFAULT-MAKE-PACKAGE-USE-LIST*, so that at site-configurationtime, one could do	  (setq *DEFAULT-MAKE-PACKAGE-USE-LIST* '("LISP"))to return to the 1984 CLtL behaviour.  [This is not being proposedat this time.]*start*01430 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 07 OCT 88 10:19:49 PDTReceived: from STONY-BROOK.SCRC.Symbolics.COM (SCRC-STONY-BROOK.ARPA) by SAIL.Stanford.EDU with TCP; 7 Oct 88  10:19:52 PDTReceived: from EUPHRATES.SCRC.Symbolics.COM by STONY-BROOK.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 472589; Fri 7-Oct-88 13:17:45 EDTDate: Fri, 7 Oct 88 13:17 EDTFrom: David A. Moon <Moon@STONY-BROOK.SCRC.Symbolics.COM>Subject: Issue: MAKE-PACKAGE-USE-DEFAULT (version 1)To: Jon L White <jonl@lucid.com>cc: cl-cleanup@sail.stanford.eduIn-Reply-To: <8810070517.AA07620@bhopal>Message-ID: <19881007171716.6.MOON@EUPHRATES.SCRC.Symbolics.COM>This is a good issue to address, but I can't figureout what you're actually proposing.  The single paragraphunder "proposal" says only that the default for the :use argumentto MAKE-PACKAGE should be implementation-dependent, but therest of the message acts as if you had proposed something muchmore concrete.  I don't see how any implementation could besaid not to implement such a proposal!Had you intended to propose something specific about the value of(package-use-list "USER")?  Had you intended to propose somethingspecific about the default for the :use argument to MAKE-PACKAGE?  Hadyou intended to propose that these must be equal?*start*01563 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 07 OCT 88 17:57:18 PDTReceived: from lucid.com by SAIL.Stanford.EDU with TCP; 7 Oct 88  17:57:17 PDTReceived: from bhopal ([192.9.200.13]) by heavens-gate.lucid.com id AA00977g; Fri, 7 Oct 88 17:56:00 PDTReceived: by bhopal id AA02431g; Fri, 7 Oct 88 17:54:19 PDTDate: Fri, 7 Oct 88 17:54:19 PDTFrom: Jon L White <jonl@lucid.com>Message-Id: <8810080054.AA02431@bhopal>To: Moon@STONY-BROOK.SCRC.Symbolics.COMCc: cl-cleanup@sail.stanford.eduIn-Reply-To: David A. Moon's message of Fri, 7 Oct 88 13:17 EDT <19881007171716.6.MOON@EUPHRATES.SCRC.Symbolics.COM>Subject: Issue: MAKE-PACKAGE-USE-DEFAULT (version 1)re: ... I don't see how any implementation could be    said not to implement such a proposal!The issue is not current practice, but CLtL p.183.  Indeed, the "Cost"section points out this obvious situation.re: Had you intended to propose something specific about the value of    (package-use-list "USER")?  Had you intended to propose something    specific about the default for the :use argument to MAKE-PACKAGE?  Had    you intended to propose that these must be equal?No. On the otherhand, I would expect that most vendors would set theirdefault in such a way as to make all LISP symbols available, as wellas their vendor-specific ones.   But I see no need to spell this out, since portable code will have to use an explicit :use LISP.-- JonL --*start*02057 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 08 OCT 88 20:06:08 PDTReceived: from STONY-BROOK.SCRC.Symbolics.COM (SCRC-STONY-BROOK.ARPA) by SAIL.Stanford.EDU with TCP; 8 Oct 88  20:06:39 PDTReceived: from BOBOLINK.SCRC.Symbolics.COM by STONY-BROOK.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 473427; Sat 8-Oct-88 23:05:01 EDTDate: Sat, 8 Oct 88 23:04 EDTFrom: Kent M Pitman <KMP@STONY-BROOK.SCRC.Symbolics.COM>Subject: Issue: MAKE-PACKAGE-USE-DEFAULT (version 1)To: JonL@Lucid.COMcc: CL-Cleanup@SAIL.Stanford.EDUIn-Reply-To: <8810070517.AA07620@bhopal>Message-ID: <881008230447.5.KMP@BOBOLINK.SCRC.Symbolics.COM>I can't approve of this proposal.Many portable programs will be forced to put :USE "LISP" in where theydo not currently specify. There is no ambiguity in those programs --they are using a well-advertised default -- so it is not proper to makeclaims like "if they care, they should be specific".Similar arguments could be made for the OPEN keywords. Perhaps all keysshould default in an implementation-dependent fashion and users should behighly-specific about their intent.I think it is appropriate for Common Lisp to specify useful portable defaults.I think it is inappropriate for Common Lisp to be encouraging vendordivergence. Common Lisp tolerates such divergence of necessity, but itshould not be a goal because it does not serve the user community.Finally, under current practice, you ignored my remarks about Cloe so I'llrepeat them. Cloe shadows MAKE-PACKAGE, IN-PACKAGE, etc. in the defaultpackage so that it offers the functionality you desire in a way that isnot incompatible to Lisp. I would recommend that you do the same. LISP:MAKE-PACKAGE name &KEY nicknames (USE "LISP") CLOE:MAKE-PACKAGE name &KEY nicknames (USE "CLOE")Once you've chosen a package to work from, all calls to an unqualifiedMAKE-PACKAGE do the thing that is natural for that initial package.*start*04859 00024 USfDate:  8 Oct 88 20:18 PDTFrom: masinter.paSubject: Issue: MAKE-PACKAGE-USE-DEFAULT (version 2)To: cl-cleanup@sail.stanford.eduline-fold: NOcc: MasinterThere's enough debate on this that this might be helpful.Issue:        MAKE-PACKAGE-USE-DEFAULT References:    MAKE-PACKAGE, CLtL p183               "USER" package, CLtL p181Related issues: PACKAGE-CLUTTERCategory:      CHANGEEdit history:  JonL White, 6-Oct-88 (version 1)               Masinter,  8-Oct-88  (version 2)Problem description:The proposal in the issue PACKAGE-CLUTTER would specify that implementation-specific extensions are not in the LISP package.With that restriction, access to implementation-specific featuresis awkward; it is necessary to always name the vendor-specificextensions in the :USE list of MAKE-PACKAGE or (if the proposalin DEFPACKAGE is adopted) in DEFPACKAGE.This forces users of a specific implementation to always haveto type something to get the default set of features for thatimplementation, even if they have no intention of writing portablecode.Proposal MAKE-PACKAGE-USE-DEFAULT:IMPLEMENTATION-DEPENDENTChange the specification of MAKE-PACKAGE (and DEFPACKAGE, ifadopted, and IN-PACKAGE, if IN-PACKAGE-FUNCTIONALITY is notadopted) so that the default for the :USE keyword is implementation-dependent. Normally, the default will includethe packages containing the implementation-specific features.Portable programs should instead always specify :USE '("LISP")explicitly.  Examples:(package-use-list (make-package "SOME-USER"))(package-use-list "USER")Test Cases:(assert     (subsetp `(,(find-package "LISP"))              (package-use-list (or (find-package "SOME-USER")				    (make-package "SOME-USER")))))Rationale:Every implementation either already does the equivalent of this, orelse has a confusing assymetry about the USER package (i.e., theirextensions are "available" in USER, but not in SOME-USER).Current practice:TI and Lucid's  3.0 versions "implement" this proposal in that they set the default :USE argument to be a list of the LISP package and the implementation-specific package. In VAXLISP the LISP package is the implementation-specificpackage, which contains the 775 symbols supposed to be in the LISP packgealong with all the extensions; the package named COMMON-LISPhas only the 775.  Thus this implements the proposal in the sense thatthe inheritance of a package made with a default :USE list containsall the implementation-specific symbols -- not just the 775 "LISP" ones.Symbolics release 7, and Lucid's 2.1 release use only '("LISP") for thedefault MAKE-PACKAGE use list, but have the aforementioned assymetryabout the USER package.Cost to Implementors:None; this relaxes a constraint imposed by CLtL.Cost to Users:In theory, every user porting code from one vendor to another wouldhave to ensure that every package definition, via IN-PACKAGE orMAKE-PACKAGE, had an explicit :USE list.  This is probably at mosta 5-minute text editor search.  But in fact this imposition is moot,since virtually every such user has *already* supplied explicit:USE lists; given the current practice, he has had no alternative.Cost of non-adoption:There will continue to be a lack of clear standardization in this area,especially since vendors are more willing to violate this apparentlyunuseful mandate from CLtL than they are to give up a minor bias towardstheir customer base.Performance impact:None.Benefits:This new default behaviour for package creation will permit documented extensions to appear on equal footing with the basic facilitiesin the LISP package.  It appears as though the _majority_ of any  users are developing and running their code totally within the enviornment provided by that one vendor; hence it seems reasonable forimplementations to bias their default use list towards those making frequent use of their specific extensions to Common Lisp.Esthetics:Some feel that fewer implementation-dependent loopholes in the languageis preferable, even when the practical import is virtually moot.Discussion:Lucid "exposes" the default :use list as the value of the specialvariable *DEFAULT-MAKE-PACKAGE-USE-LIST*, so that at site-configurationtime, one could do	  (setq *DEFAULT-MAKE-PACKAGE-USE-LIST* '("LISP"))to return to the 1984 CLtL behaviour.  [This is not being proposedat this time.]        TITAN 
         TITAN 
           Ú                            B                                          R             2       ;      z       
       K              ™              Ä             î              3             ’              í                     
      Ô              ‹             %      ` %zº*start*04836 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 08 OCT 88 20:20:09 PDTReceived: from Xerox.COM by SAIL.Stanford.EDU with TCP; 8 Oct 88  20:20:53 PDTReceived: from Semillon.ms by ArpaGateway.ms ; 08 OCT 88 20:18:22 PDTDate: 8 Oct 88 20:18 PDTFrom: masinter.paSubject: Issue: MAKE-PACKAGE-USE-DEFAULT (version 2)To: cl-cleanup@sail.stanford.eduline-fold: NOcc: Masinter.paMessage-ID: <881008-201822-2495@Xerox>There's enough debate on this that this might be helpful.!Issue:        MAKE-PACKAGE-USE-DEFAULT References:    MAKE-PACKAGE, CLtL p183               "USER" package, CLtL p181Related issues: PACKAGE-CLUTTERCategory:      CHANGEEdit history:  JonL White, 6-Oct-88 (version 1)               Masinter,  8-Oct-88  (version 2)Problem description:The proposal in the issue PACKAGE-CLUTTER would specify that implementation-specific extensions are not in the LISP package.With that restriction, access to implementation-specific featuresis awkward; it is necessary to always name the vendor-specificextensions in the :USE list of MAKE-PACKAGE or (if the proposalin DEFPACKAGE is adopted) in DEFPACKAGE.This forces users of a specific implementation to always haveto type something to get the default set of features for thatimplementation, even if they have no intention of writing portablecode.Proposal MAKE-PACKAGE-USE-DEFAULT:IMPLEMENTATION-DEPENDENTChange the specification of MAKE-PACKAGE (and DEFPACKAGE, ifadopted, and IN-PACKAGE, if IN-PACKAGE-FUNCTIONALITY is notadopted) so that the default for the :USE keyword is implementation-dependent. Normally, the default will includethe packages containing the implementation-specific features.Portable programs should instead always specify :USE '("LISP")explicitly.  Examples:(package-use-list (make-package "SOME-USER"))(package-use-list "USER")Test Cases:(assert     (subsetp `(,(find-package "LISP"))              (package-use-list (or (find-package "SOME-USER")				    (make-package "SOME-USER")))))Rationale:Every implementation either already does the equivalent of this, orelse has a confusing assymetry about the USER package (i.e., theirextensions are "available" in USER, but not in SOME-USER).Current practice:TI and Lucid's  3.0 versions "implement" this proposal in that they set the default :USE argument to be a list of the LISP package and the implementation-specific package. In VAXLISP the LISP package is the implementation-specificpackage, which contains the 775 symbols supposed to be in the LISP packgealong with all the extensions; the package named COMMON-LISPhas only the 775.  Thus this implements the proposal in the sense thatthe inheritance of a package made with a default :USE list containsall the implementation-specific symbols -- not just the 775 "LISP" ones.Symbolics release 7, and Lucid's 2.1 release use only '("LISP") for thedefault MAKE-PACKAGE use list, but have the aforementioned assymetryabout the USER package.Cost to Implementors:None; this relaxes a constraint imposed by CLtL.Cost to Users:In theory, every user porting code from one vendor to another wouldhave to ensure that every package definition, via IN-PACKAGE orMAKE-PACKAGE, had an explicit :USE list.  This is probably at mosta 5-minute text editor search.  But in fact this imposition is moot,since virtually every such user has *already* supplied explicit:USE lists; given the current practice, he has had no alternative.Cost of non-adoption:There will continue to be a lack of clear standardization in this area,especially since vendors are more willing to violate this apparentlyunuseful mandate from CLtL than they are to give up a minor bias towardstheir customer base.Performance impact:None.Benefits:This new default behaviour for package creation will permit documented extensions to appear on equal footing with the basic facilitiesin the LISP package.  It appears as though the _majority_ of any  users are developing and running their code totally within the enviornment provided by that one vendor; hence it seems reasonable forimplementations to bias their default use list towards those making frequent use of their specific extensions to Common Lisp.Esthetics:Some feel that fewer implementation-dependent loopholes in the languageis preferable, even when the practical import is virtually moot.Discussion:Lucid "exposes" the default :use list as the value of the specialvariable *DEFAULT-MAKE-PACKAGE-USE-LIST*, so that at site-configurationtime, one could do	  (setq *DEFAULT-MAKE-PACKAGE-USE-LIST* '("LISP"))to return to the 1984 CLtL behaviour.  [This is not being proposedat this time.]*start*01041 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 13 OCT 88 19:27:39 PDTReceived: from STONY-BROOK.SCRC.Symbolics.COM (SCRC-STONY-BROOK.ARPA) by SAIL.Stanford.EDU with TCP; 13 Oct 88  15:38:21 PDTReceived: from BOBOLINK.SCRC.Symbolics.COM by STONY-BROOK.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 476048; Thu 13-Oct-88 18:36:41 EDTDate: Thu, 13 Oct 88 18:36 EDTFrom: Kent M Pitman <KMP@STONY-BROOK.SCRC.Symbolics.COM>Subject: Issue: MAKE-PACKAGE-USE-DEFAULT (Version 2)To: CL-Cleanup@SAIL.Stanford.EDUMessage-ID: <881013183624.2.KMP@BOBOLINK.SCRC.Symbolics.COM>My notes from Fairfax meeting...Cleanup meeting: I (KMP) don't like this proposal, but I made a note to myself about another reason that just occurred to me:  There is no syntax for getting the default (ie, system-dependent) package included if you want to -also- use some other package. We didn't think this was ready to vote on.*start*01661 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 11 OCT 88 10:00:08 PDTReceived: from STONY-BROOK.SCRC.Symbolics.COM (SCRC-STONY-BROOK.ARPA) by SAIL.Stanford.EDU with TCP; 11 Oct 88  10:00:05 PDTReceived: from EUPHRATES.SCRC.Symbolics.COM by STONY-BROOK.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 474097; Tue 11-Oct-88 12:58:26 EDTDate: Tue, 11 Oct 88 12:58 EDTFrom: David A. Moon <Moon@STONY-BROOK.SCRC.Symbolics.COM>Subject: Issue: MAKE-PACKAGE-USE-DEFAULT (version 2)To: cl-cleanup@sail.stanford.eduIn-Reply-To: <881008-201822-2495@Xerox>Message-ID: <19881011165801.8.MOON@EUPHRATES.SCRC.Symbolics.COM>MAKE-PACKAGE-USE-DEFAULT:IMPLEMENTATION-DEPENDENT is okay with me.I think it might be better to strengthen it and say that thedefault for :USE is identical to the use list of the USER package.Does anyone agree?In response to Kent's remarks, the issue is whether the default shouldbe a portable way to get the local extensions, or a portable way toget the portable language without the extensions.  I think either ofthose choices is portable and reasonable, it just depends on what youwant to make easier, which probably depends on whether a package isbeing set up for use only by a predefined program or for use by usertypein and/or user-written programs, either of which are likely toexpect the local extensions.Hence I would also accept a proposal to make the default for :USEcontinue to be the LISP package, rather than incompatibly changing it,and add a portable name for the local extensions.*start*00892 00024 USfDate: 10 Oct 88 08:07 PDTFrom: Stan Lanning <Lanning.pa>Subject: Re: Issue: MAKE-PACKAGE-USE-DEFAULT (version 2)In-reply-to: masinter.pa's message of 8 Oct 88 20:18 PDTTo: masinter.paCan anybody join in with their 2 cents worth, or should I just remain a silent bystander?  Or should I not contribute to the noise, given that Pitman refuses to let this proposal fly?  This particular issue has hit me before -- I've filed a bug report with Lucid over their impelementation.  Pavel, Pederson, and I have all been bitten by this.The point:  non-portable programs should declare that intent up-front.  This is a virtue of the current situation:  if the program uses a non-portable package, they have to state that at the head of the file.  Us poor losers who try to load it into the wrong environment get a error before we've gotten on with the load.----- smL*start*03830 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 17 OCT 88 18:01:31 PDTReceived: from lucid.com by SAIL.Stanford.EDU with TCP; 17 Oct 88  18:00:03 PDTReceived: from bhopal ([192.9.200.13]) by LUCID.COM id AA05500g; Mon, 17 Oct 88 17:59:57 PDTReceived: by bhopal id AA05092g; Mon, 17 Oct 88 17:58:22 PDTDate: Mon, 17 Oct 88 17:58:22 PDTFrom: Jon L White <jonl@lucid.com>Message-Id: <8810180058.AA05092@bhopal>To: KMP@STONY-BROOK.SCRC.Symbolics.COMCc: CL-Cleanup@SAIL.Stanford.EDUIn-Reply-To: Kent M Pitman's message of Sat, 8 Oct 88 23:04 EDT <881008230447.5.KMP@BOBOLINK.SCRC.Symbolics.COM>Subject: Issue: MAKE-PACKAGE-USE-DEFAULT (version 1)re: Many portable programs will be forced to put :USE "LISP" in where they    do not currently specify. I claim this is not so [i.e. the "do not currently specify" part].  The relevant, unchallenged part of the proposal says:    Cost to Users:    In theory, every user porting code from one vendor to another would    have to ensure that every package definition, via IN-PACKAGE or    MAKE-PACKAGE, had an explicit :use list.  This is probably at most    a 5-minute text editor search.  But in fact this imposition is moot,    since virtually every such user has *already* supplied explicit    :use lists; given the current practice, he has had no alternative.re: Finally, under current practice, you ignored my remarks about Cloe so I'll    repeat them. Cloe shadows MAKE-PACKAGE, IN-PACKAGE, etc. in the default    package so that it offers the functionality you desire in a way that is    not incompatible to Lisp. I would recommend that you do the same.     LISP:MAKE-PACKAGE name &KEY nicknames (USE "LISP")     CLOE:MAKE-PACKAGE name &KEY nicknames (USE "CLOE")    Once you've chosen a package to work from, all calls to an unqualified    MAKE-PACKAGE do the thing that is natural for that initial package.This doesn't work the same; namely, it forces a user to preface his files:        (cloe:in-package <mumble> ...)rather than:        (in-package <mumble> ...)That is, assuming that CLOE does the reasonable thing of reading the IN-PACKAGE command from the USER package.  If you have some otherdefault package, then that itself is an imposition on at least thesame order of magnitude as the proposal for MAKE-PACKAGE-USE-DEFAULT.I see MAKE-PACKAGE-USE-DEFAULT:IMPLEMENTATION-DEPENDENT; as the lesserof several evils.  As moon said [in msg of  Tue, 11 Oct 88 12:58 EDT]    "... the issue is whether the default should     be a portable way to get the local extensions, or a portable way to     get the portable language without the extensions.  I think either of     those choices is portable and reasonable, it just depends on what you     want to make easier, ..."Now, there may be a separate issue we haven't addressed yet -- justwhat package is current when you load a file?  A "good style" programwill have an IN-PACKAGE command as the first executable form in thefile [or, a DEFPACKAGE followed by an IN-PACKAGE ?].  The question is,how do you read the IN-PACKAGE itself?   Unfortunately, all implementations I've examined, including Lucid's, just leave you in the current package.  I believe the "reasonable" thing to do is to rebind *package* to USER; the expectation, of course, is that the currentpackage will immediately be changed via IN-PACKAGE.The same issue holds with respect to the CL-Compiler committee's issueabout what package you start out in when you compile-file a file.  Ifear that, at the recent x3j13 meeting, we too easily assented to a rebinding of *package* to itself, precisely because we hadn't thoughtthrough this "separate issue" before.-- JonL --*start*01582 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 17 OCT 88 18:10:10 PDTReceived: from lucid.com by SAIL.Stanford.EDU with TCP; 17 Oct 88  18:08:41 PDTReceived: from bhopal ([192.9.200.13]) by LUCID.COM id AA05512g; Mon, 17 Oct 88 18:08:35 PDTReceived: by bhopal id AA05120g; Mon, 17 Oct 88 18:07:01 PDTDate: Mon, 17 Oct 88 18:07:01 PDTFrom: Jon L White <jonl@lucid.com>Message-Id: <8810180107.AA05120@bhopal>To: Moon@STONY-BROOK.SCRC.Symbolics.COMCc: cl-cleanup@sail.stanford.eduIn-Reply-To: David A. Moon's message of Tue, 11 Oct 88 12:58 EDT <19881011165801.8.MOON@EUPHRATES.SCRC.Symbolics.COM>Subject: Issue: MAKE-PACKAGE-USE-DEFAULT (version 2)re: I think it might be better to strengthen it and say that the    default for :USE is identical to the use list of the USER package.    Does anyone agree?I agree, sort of.  Especially since one of the motivating factors for this proposal was that some Lucid 2.1 user's were complaining that "things" look a lot different from the USER package than from a user-created package.The only question is whether or not you really want the default to besensitive to subsequent alterations of USER's :use list.  As mentionedin the Discussion section of the proposal, Lucid's implementationexposes the default as the value of a global variable, which happensto be a copy of the initial :use list of USER; but subsequent changes to USER have no affect on this global variable.-- JonL --*start*05296 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 17 OCT 88 18:42:16 PDTReceived: from STONY-BROOK.SCRC.Symbolics.COM (SCRC-STONY-BROOK.ARPA) by SAIL.Stanford.EDU with TCP; 17 Oct 88  18:40:40 PDTReceived: from BOBOLINK.SCRC.Symbolics.COM by STONY-BROOK.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 477766; Mon 17-Oct-88 21:40:33 EDTDate: Mon, 17 Oct 88 21:40 EDTFrom: Kent M Pitman <KMP@STONY-BROOK.SCRC.Symbolics.COM>Subject: Issue: MAKE-PACKAGE-USE-DEFAULT (version 1)To: jonl@lucid.comcc: KMP@STONY-BROOK.SCRC.Symbolics.COM, CL-Cleanup@SAIL.Stanford.EDUIn-Reply-To: <8810180058.AA05092@bhopal>Message-ID: <881017214016.4.KMP@BOBOLINK.SCRC.Symbolics.COM>    Date: Mon, 17 Oct 88 17:58:22 PDT    From: Jon L White <jonl@lucid.com>    ...    re: Finally, under current practice, you ignored my remarks about Cloe so I'll	repeat them. Cloe shadows MAKE-PACKAGE, IN-PACKAGE, etc. in the default	package so that it offers the functionality you desire in a way that is	not incompatible to Lisp. I would recommend that you do the same.	 LISP:MAKE-PACKAGE name &KEY nicknames (USE "LISP")	 CLOE:MAKE-PACKAGE name &KEY nicknames (USE "CLOE")	Once you've chosen a package to work from, all calls to an unqualified	MAKE-PACKAGE do the thing that is natural for that initial package.This is a current practice statement. Please note it.    This doesn't work the same; namely, it forces a user to preface his files:	    (cloe:in-package <mumble> ...)    rather than:	    (in-package <mumble> ...)No. Our USER package uses CLOE, so (IN-PACKAGE ...) [unqualified] callsCLOE:IN-PACKAGE.There is a command you can run to say that you would prefer the system notshow you Cloe extensions, so there is no trouble getting the other behaviorfor people who want it.    That is, assuming that CLOE does the reasonable thing of reading the     IN-PACKAGE command from the USER package.There are no restrictions in CLtL about what packages the USER package may use,what symbols it may shadow, etc.Anyway, the -important- thing is that LOAD is documented to rebind *PACKAGE*to its current value. Hence, a safe portable program must -always- sayLISP:IN-PACKAGE (if that's what it intends) just in case the "current value"of *PACKAGE* is a package which has shadowed IN-PACKAGE to be something whichmeans nothing like what it means in CLtL... eg, what if *PACKAGE* is the keywordpackage when you call LOAD?    If you have some other default package, then that itself is an imposition    on at least the same order of magnitude as the proposal for     MAKE-PACKAGE-USE-DEFAULT.Nonsense. The user selects once at the beginning of his session whether he'sworking with the Cloe extensions or not. From then on out, everything isentirely consistent. In general, you have the problem that     I see MAKE-PACKAGE-USE-DEFAULT:IMPLEMENTATION-DEPENDENT; as the lesser    of several evils.  As moon said [in msg of  Tue, 11 Oct 88 12:58 EDT]	"... the issue is whether the default should	 be a portable way to get the local extensions, or a portable way to	 get the portable language without the extensions.  I think either of	 those choices is portable and reasonable, it just depends on what you	 want to make easier, ..."I think there should be a portable way to get portable code (ie, the languagewithout extensions). I don't want to waste -any- time figuring out how peopleget to system-dependent stuff. There's already an adequate mechanism for doingthat. And even if there weren't, an extension could be added in a system-dependentway without wasting any CL designers' time.     Now, there may be a separate issue we haven't addressed yet -- just    what package is current when you load a file?  A "good style" program    will have an IN-PACKAGE command as the first executable form in the    file [or, a DEFPACKAGE followed by an IN-PACKAGE ?].  The question is,    how do you read the IN-PACKAGE itself?   Unfortunately, all     implementations I've examined, including Lucid's, just leave you in     the current package.That's because that's what p183 of CLtL says they have to do!    I believe the "reasonable" thing to do is to     rebind *package* to USER; the expectation, of course, is that the    current package will immediately be changed via IN-PACKAGE.I strongly disagree. You have no idea what's in USER. Besides, it's gratuitouslyincompatible with existing programs, as is your suggestion to change themeaning of MAKE-PACKAGE with no :USE argument.    The same issue holds with respect to the CL-Compiler committee's issue    about what package you start out in when you compile-file a file.  I    fear that, at the recent x3j13 meeting, we too easily assented to a     rebinding of *package* to itself, precisely because we hadn't thought    through this "separate issue" before.The compiler committee had thought it through. The ammendment to thatproposal to which we agreed -- my addition of wording saying "to its currentvalue" -- was exactly to make it consistent with the documented behaviorof LOAD (because we believe most implementations already provide suchconsistency).*start*02686 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 27 OCT 88 22:16:09 PDTReceived: from lucid.com by SAIL.Stanford.EDU with TCP; 27 Oct 88  22:14:16 PDTReceived: from bhopal ([192.9.200.13]) by heavens-gate.lucid.com id AA01734g; Thu, 27 Oct 88 22:13:35 PDTReceived: by bhopal id AA13338g; Thu, 27 Oct 88 22:12:02 PDTDate: Thu, 27 Oct 88 22:12:02 PDTFrom: Jon L White <jonl@lucid.com>Message-Id: <8810280512.AA13338@bhopal>To: KMP@STONY-BROOK.SCRC.Symbolics.COMCc: CL-Cleanup@SAIL.Stanford.EDUIn-Reply-To: Kent M Pitman's message of Mon, 17 Oct 88 21:40 EDT <881017214016.4.KMP@BOBOLINK.SCRC.Symbolics.COM>Subject: Issue: MAKE-PACKAGE-USE-DEFAULT (version 1)[some of quoted parts of your msg are out of order, in order to reply tothe simpler ones first]re: I think there should be a portable way to get portable code (ie, the     language without extensions). I don't want to waste -any- time figuring     out how people get to system-dependent stuff. . . So do I; as this proposal suggests, supplying an explicit :USE argument of "LISP" would be this portable way.re: There are no restrictions in CLtL about what packages the USER package may     use, what symbols it may shadow, etc.See CLtL, p181.  It is required to "use" LISP.  Current practice also hasit "inheriting" all the vendors extensions, and has it essentially free ofany other symbols.re:     Cloe shadows MAKE-PACKAGE, IN-PACKAGE, etc. ...        Once you've chosen a package to work from, all calls to an unqualified	MAKE-PACKAGE do the thing that is natural for that initial package.    This is a current practice statement. Please note it.Uh, I'm not sure this is relevant to a proposal concerning the _standard_ definition of MAKE-PACKAGE;  a non-standard ACME:MAKE-PACKAGE can do just about whatever it wants.  Remember that this proposal concerns thedefault value of the :use argument to MAKE-PACKAGE -- it is not directlyabout some underlying problem that CLoe may address in a different way.re: Our USER package uses CLOE, so (IN-PACKAGE ...) [unqualified] calls    CLOE:IN-PACKAGE.So either Cloe's USER package doesn't use LISP -- which would violate CLtLp181 --  or it shadows LISP:IN-PACKAGE with CLOE:IN-PACKAGE  -- whichintroduces yet another oddball variation between the shape of the USERpackage and a vanilla package made like (make-package "FOO" :use "LISP").As I mentioned before, one primary motivation for this proposal is the usercomplaints about USER being so "different" (in the Lucid Sun3/2.1 release).-- JonL --*start*00840 00024 US Date: 23 Nov 88 13:41 PSTFrom: masinter.paSubject: Issue: MAKE-PACKAGE-USE-DEFAULT (version 2)To: cl-cleanuP@sail.stanford.educc: masinter.paThe local user community feels strongly that the :USE default of MAKE-PACKAGE should *not* be implementation dependent. "The point:  non-portable programs should declare that intent up-front.  This is a virtue of the current situation:  if the program uses a non-portable package, they have to state that at the head of the file.  Us poor losers who try to load it into the wrong environment get a error before we've gotten on with the load."I would characterize this as : "There was strong opposition to this proposal from one group Common Lisp users trying to run multiple implementations at their site." and include the above phrase in the discussion section.*start*01203 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 23 NOV 88 13:52:51 PSTReceived: from Xerox.COM by SAIL.Stanford.EDU with TCP; 23 Nov 88  13:51:00 PSTReceived: from Cabernet.ms by ArpaGateway.ms ; 23 NOV 88 13:42:44 PSTDate: 23 Nov 88 13:41 PSTFrom: masinter.paSubject: Issue: MAKE-PACKAGE-USE-DEFAULT (version 2)To: cl-cleanuP@sail.stanford.educc: masinter.paMessage-ID: <881123-134244-13159@Xerox>The local user community feels strongly that the :USE default ofMAKE-PACKAGE should *not* be implementation dependent. "The point:  non-portable programs should declare that intent up-front.This is a virtue of the current situation:  if the program uses anon-portable package, they have to state that at the head of the file.  Uspoor losers who try to load it into the wrong environment get a errorbefore we've gotten on with the load."I would characterize this as : "There was strong opposition to thisproposal from one group Common Lisp users trying to run multipleimplementations at their site." and include the above phrase in thediscussion section.*start*00247 00024 US Date: 23 Nov 88 13:57 PSTFrom: Stanley's Tool Works <Lanning.pa>Subject: Re: Issue: MAKE-PACKAGE-USE-DEFAULT (version 2)In-reply-to: masinter.pa's message of 23 Nov 88 13:41 PSTTo: masinter.paGee, thanks.----- smL*start*00933 00024 US Return-Path: <jonl@lucid.com>Received: from lucid.com ([192.26.25.1]) by Xerox.COM ; 28 NOV 88 23:24:10 PSTReceived: from bhopal ([192.9.200.13]) by heavens-gate.lucid.com id AA01417g; Mon, 28 Nov 88 23:22:35 PSTReceived: by bhopal id AA00546g; Mon, 28 Nov 88 23:21:27 PSTDate: Mon, 28 Nov 88 23:21:27 PSTFrom: Jon L White <jonl@lucid.com>Message-Id: <8811290721.AA00546@bhopal>To: masinter.paCc: cl-cleanuP@sail.stanford.edu, masinter.paIn-Reply-To: masinter.pa@Xerox.COM's message of 23 Nov 88 13:41 PST <881123-134244-13159@Xerox>Subject: Issue: MAKE-PACKAGE-USE-DEFAULT (version 2)re: I would characterize this as : "There was strong opposition to this    proposal from one group Common Lisp users trying to run multiple    implementations at their site." and include the above phrase in the    discussion section.How large was this "vocal" group of users?  2?  3? 200? 300?-- JonL --*start*00300 00024 US Date: 29 Nov 88 08:20 PSTFrom: Stanley's Tool Works <Lanning.pa>Subject: Re: Issue: MAKE-PACKAGE-USE-DEFAULT (version 2)In-reply-to: Jon L White <jonl@lucid.com>'s message of Mon, 28 Nov 88 23:21:27 PSTTo: masinter.paWell, there's at least 2 (Pavel and me).----- smL*start*07423 00024 UU?Date: 12 Dec 88 13:34 PSTSender: masinter.paTo: x3j13@sail.stanford.eduSubject: Issue: MAKE-PACKAGE-USE-DEFAULT (Version 2)From: cl-cleanup@sail.stanford.edureply-to: cl-cleanup@sail.stanford.educc: masinterline-fold: noA number of comments on this version are excerptedin a section "Additional Comments" at the end.Issue:        MAKE-PACKAGE-USE-DEFAULT References:    MAKE-PACKAGE, CLtL p183               "USER" package, CLtL p181Related issues: PACKAGE-CLUTTERCategory:      CHANGEEdit history:  JonL White, 6-Oct-88 (version 1)               Masinter,  8-Oct-88  (version 2)Problem description:The proposal in the issue PACKAGE-CLUTTER would specify that implementation-specific extensions are not in the LISP package.With that restriction, access to implementation-specific featuresis awkward; it is necessary to always name the vendor-specificextensions in the :USE list of MAKE-PACKAGE or (if the proposalin DEFPACKAGE is adopted) in DEFPACKAGE.This forces users of a specific implementation to always haveto type something to get the default set of features for thatimplementation, even if they have no intention of writing portablecode.Proposal MAKE-PACKAGE-USE-DEFAULT:IMPLEMENTATION-DEPENDENTChange the specification of MAKE-PACKAGE (and DEFPACKAGE, ifadopted, and IN-PACKAGE, if IN-PACKAGE-FUNCTIONALITY is notadopted) so that the default for the :USE keyword is implementation-dependent. Normally, the default will includethe packages containing the implementation-specific features.Portable programs should instead always specify :USE '("LISP")explicitly.  Examples:(package-use-list (make-package "SOME-USER"))(package-use-list "USER")Test Cases:(assert     (subsetp `(,(find-package "LISP"))              (package-use-list (or (find-package "SOME-USER")				    (make-package "SOME-USER")))))Rationale:Every implementation either already does the equivalent of this, orelse has a confusing assymetry about the USER package (i.e., theirextensions are "available" in USER, but not in SOME-USER).Current practice:TI and Lucid's  3.0 versions "implement" this proposal in that they set the default :USE argument to be a list of the LISP package and the implementation-specific package. In VAXLISP the LISP package is the implementation-specificpackage, which contains the 775 symbols supposed to be in the LISP packgealong with all the extensions; the package named COMMON-LISPhas only the 775.  Thus this implements the proposal in the sense thatthe inheritance of a package made with a default :USE list containsall the implementation-specific symbols -- not just the 775 "LISP" ones.Symbolics release 7, and Lucid's 2.1 release use only '("LISP") for thedefault MAKE-PACKAGE use list, but have the aforementioned assymetryabout the USER package.Cost to Implementors:None; this relaxes a constraint imposed by CLtL.Cost to Users:In theory, every user porting code from one vendor to another wouldhave to ensure that every package definition, via IN-PACKAGE orMAKE-PACKAGE, had an explicit :USE list.  This is probably at mosta 5-minute text editor search.  But in fact this imposition is moot,since virtually every such user has *already* supplied explicit:USE lists; given the current practice, he has had no alternative.Cost of non-adoption:There will continue to be a lack of clear standardization in this area,especially since vendors are more willing to violate this apparentlyunuseful mandate from CLtL than they are to give up a minor bias towardstheir customer base.Performance impact:None.Benefits:This new default behaviour for package creation will permit documented extensions to appear on equal footing with the basic facilitiesin the LISP package.  It appears as though the _majority_ of any  users are developing and running their code totally within the enviornment provided by that one vendor; hence it seems reasonable forimplementations to bias their default use list towards those making frequent use of their specific extensions to Common Lisp.Esthetics:Some feel that fewer implementation-dependent loopholes in the languageis preferable, even when the practical import is virtually moot.Discussion:Lucid "exposes" the default :use list as the value of the specialvariable *DEFAULT-MAKE-PACKAGE-USE-LIST*, so that at site-configurationtime, one could do	  (setq *DEFAULT-MAKE-PACKAGE-USE-LIST* '("LISP"))to return to the 1984 CLtL behaviour.  [This is not being proposedat this time.]     ----- Additional Comments -----" I don't like this proposal, but I made a note to myself about another reason that just occurred to me:  There is no syntax for getting the default (ie, system-dependent) package included if you want to -also- use some other package." - - - - - -"MAKE-PACKAGE-USE-DEFAULT:IMPLEMENTATION-DEPENDENT is okay with me.I think it might be better to strengthen it and say that thedefault for :USE is identical to the use list of the USER package.Does anyone agree?In response to Kent's remarks, the issue is whether the default shouldbe a portable way to get the local extensions, or a portable way toget the portable language without the extensions.  I think either ofthose choices is portable and reasonable, it just depends on what youwant to make easier, which probably depends on whether a package isbeing set up for use only by a predefined program or for use by usertypein and/or user-written programs, either of which are likely toexpect the local extensions.Hence I would also accept a proposal to make the default for :USEcontinue to be the LISP package, rather than incompatibly changing it,and add a portable name for the local extensions." - - - - - -"re: I think it might be better to strengthen it and say that the    default for :USE is identical to the use list of the USER package.    Does anyone agree?I agree, sort of.  Especially since one of the motivating factors for this proposal was that some Lucid 2.1 user's were complaining that "things" look a lot different from the USER package than from a user-created package.The only question is whether or not you really want the default to besensitive to subsequent alterations of USER's :use list.  As mentionedin the Discussion section of the proposal, Lucid's implementationexposes the default as the value of a global variable, which happensto be a copy of the initial :use list of USER; but subsequent changes to USER have no affect on this global variable." - - - - - -"The point:  non-portable programs should declare that intent up-front.This is a virtue of the current situation:  if the program uses anon-portable package, they have to state that at the head of the file.  Uspoor losers who try to load it into the wrong environment get a errorbefore we've gotten on with the load."        
TIMESROMAN           TITAN 
         TITAN 
         ; -(TEXTFONT 7 (TIMESROMAN 12) NIL (CLASSIC 10))            Z              å                     B                                          R             2       ;      z       
       K              ™              Ä             î              3             ’              í                     
      Ô              ‹             
Q             ÿ 'zº*start*07260 00024 US Return-Path: <X3J13-mailer@SAIL.Stanford.EDU>Received: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 12 DEC 88 14:20:58 PSTReceived: from Xerox.COM by SAIL.Stanford.EDU with TCP; 12 Dec 88  14:00:15 PSTReceived: from Semillon.ms by ArpaGateway.ms ; 12 DEC 88 13:38:46 PSTDate: 12 Dec 88 13:34 PSTSender: masinter.paTo: x3j13@sail.stanford.eduSubject: Issue: MAKE-PACKAGE-USE-DEFAULT (Version 2)From: cl-cleanup@sail.stanford.edureply-to: cl-cleanup@sail.stanford.educc: masinter.paline-fold: noMessage-ID: <881212-133846-5027@Xerox>A number of comments on this version are excerptedin a section "Additional Comments" at the end.!Issue:        MAKE-PACKAGE-USE-DEFAULT References:    MAKE-PACKAGE, CLtL p183               "USER" package, CLtL p181Related issues: PACKAGE-CLUTTERCategory:      CHANGEEdit history:  JonL White, 6-Oct-88 (version 1)               Masinter,  8-Oct-88  (version 2)Problem description:The proposal in the issue PACKAGE-CLUTTER would specify that implementation-specific extensions are not in the LISP package.With that restriction, access to implementation-specific featuresis awkward; it is necessary to always name the vendor-specificextensions in the :USE list of MAKE-PACKAGE or (if the proposalin DEFPACKAGE is adopted) in DEFPACKAGE.This forces users of a specific implementation to always haveto type something to get the default set of features for thatimplementation, even if they have no intention of writing portablecode.Proposal MAKE-PACKAGE-USE-DEFAULT:IMPLEMENTATION-DEPENDENTChange the specification of MAKE-PACKAGE (and DEFPACKAGE, ifadopted, and IN-PACKAGE, if IN-PACKAGE-FUNCTIONALITY is notadopted) so that the default for the :USE keyword is implementation-dependent. Normally, the default will includethe packages containing the implementation-specific features.Portable programs should instead always specify :USE '("LISP")explicitly.  Examples:(package-use-list (make-package "SOME-USER"))(package-use-list "USER")Test Cases:(assert     (subsetp `(,(find-package "LISP"))              (package-use-list (or (find-package "SOME-USER")				    (make-package "SOME-USER")))))Rationale:Every implementation either already does the equivalent of this, orelse has a confusing assymetry about the USER package (i.e., theirextensions are "available" in USER, but not in SOME-USER).Current practice:TI and Lucid's  3.0 versions "implement" this proposal in that they set the default :USE argument to be a list of the LISP package and the implementation-specific package. In VAXLISP the LISP package is the implementation-specificpackage, which contains the 775 symbols supposed to be in the LISP packgealong with all the extensions; the package named COMMON-LISPhas only the 775.  Thus this implements the proposal in the sense thatthe inheritance of a package made with a default :USE list containsall the implementation-specific symbols -- not just the 775 "LISP" ones.Symbolics release 7, and Lucid's 2.1 release use only '("LISP") for thedefault MAKE-PACKAGE use list, but have the aforementioned assymetryabout the USER package.Cost to Implementors:None; this relaxes a constraint imposed by CLtL.Cost to Users:In theory, every user porting code from one vendor to another wouldhave to ensure that every package definition, via IN-PACKAGE orMAKE-PACKAGE, had an explicit :USE list.  This is probably at mosta 5-minute text editor search.  But in fact this imposition is moot,since virtually every such user has *already* supplied explicit:USE lists; given the current practice, he has had no alternative.Cost of non-adoption:There will continue to be a lack of clear standardization in this area,especially since vendors are more willing to violate this apparentlyunuseful mandate from CLtL than they are to give up a minor bias towardstheir customer base.Performance impact:None.Benefits:This new default behaviour for package creation will permit documented extensions to appear on equal footing with the basic facilitiesin the LISP package.  It appears as though the _majority_ of any  users are developing and running their code totally within the enviornment provided by that one vendor; hence it seems reasonable forimplementations to bias their default use list towards those making frequent use of their specific extensions to Common Lisp.Esthetics:Some feel that fewer implementation-dependent loopholes in the languageis preferable, even when the practical import is virtually moot.Discussion:Lucid "exposes" the default :use list as the value of the specialvariable *DEFAULT-MAKE-PACKAGE-USE-LIST*, so that at site-configurationtime, one could do	  (setq *DEFAULT-MAKE-PACKAGE-USE-LIST* '("LISP"))to return to the 1984 CLtL behaviour.  [This is not being proposedat this time.]     ----- Additional Comments -----" I don't like this proposal, but I made a note to myself about another reason that just occurred to me:  There is no syntax for getting the default (ie, system-dependent) package included if you want to -also- use some other package." - - - - - -"MAKE-PACKAGE-USE-DEFAULT:IMPLEMENTATION-DEPENDENT is okay with me.I think it might be better to strengthen it and say that thedefault for :USE is identical to the use list of the USER package.Does anyone agree?In response to Kent's remarks, the issue is whether the default shouldbe a portable way to get the local extensions, or a portable way toget the portable language without the extensions.  I think either ofthose choices is portable and reasonable, it just depends on what youwant to make easier, which probably depends on whether a package isbeing set up for use only by a predefined program or for use by usertypein and/or user-written programs, either of which are likely toexpect the local extensions.Hence I would also accept a proposal to make the default for :USEcontinue to be the LISP package, rather than incompatibly changing it,and add a portable name for the local extensions." - - - - - -"re: I think it might be better to strengthen it and say that the    default for :USE is identical to the use list of the USER package.    Does anyone agree?I agree, sort of.  Especially since one of the motivating factors for this proposal was that some Lucid 2.1 user's were complaining that "things" look a lot different from the USER package than from a user-created package.The only question is whether or not you really want the default to besensitive to subsequent alterations of USER's :use list.  As mentionedin the Discussion section of the proposal, Lucid's implementationexposes the default as the value of a global variable, which happensto be a copy of the initial :use list of USER; but subsequent changes to USER have no affect on this global variable." - - - - - -"The point:  non-portable programs should declare that intent up-front.This is a virtue of the current situation:  if the program uses anon-portable package, they have to state that at the head of the file.  Uspoor losers who try to load it into the wrong environment get a errorbefore we've gotten on with the load."*start*02043 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 06 JAN 89 15:05:36 PSTReceived: from Xerox.COM by SAIL.Stanford.EDU with TCP; 6 Jan 89  15:04:14 PSTReceived: from Cabernet.ms by ArpaGateway.ms ; 05 JAN 89 23:55:12 PSTDate: 5 Jan 89 23:54 PSTSender: masinter.paSubject: Issue: MAKE-PACKAGE-USE-DEFAULT (Version 2)To: cl-cleanup@sail.stanford.eduFrom: Moon@STONY-BROOK.SCRC.Symbolics.COM, KMP@STONY-BROOK.SCRC.Symbolics.COMMessage-ID: <890105-235512-193@Xerox>[lmm: I've been folding short comments into my Issue status file, but thisone is too long.] We oppose this issue because:   - It is not clearly in the best interest of programmers in a supposedly     portable language to give up the most convenient package creation     syntax to a non-portable purpose.   - The justifications given in the proposal are not strong enough to     support an incompatible change like this.   - This is a special-case hack that does not generalize. There is     no way to create a package based on the implementation-dependent     default -and- other packages.   - It would be just as easy for someone to say        :USE (PACKAGE-USE-LIST (FIND-PACKAGE "USER"))     At least this technique generalizes.   - The Rationale uses incorrect suppositions to arrive at a false     generalization. Cloe doesn't have the asymmetry referred to.   - The current practice is not correct.     No mention of what Cloe does is attempted.   - Even allowing the default to be controlled by a variable does     not help because it encourages programs to be developed depending     on defaults which are not part of those programs, and therefore     works against portability.   - The Discussion section does not correctly reflect discussion.     For example, Pitman has repeatedly voiced strong opposition.     The Discussion mentions neither the fact that he objected nor the     reasons for his objection.