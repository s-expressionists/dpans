*start*03030 00024 USfReturn-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU by Xerox.COM ; 12 MAR 88 15:29:34 PSTReceived: from STONY-BROOK.SCRC.Symbolics.COM (SCRC-STONY-BROOK.ARPA) by SAIL.Stanford.EDU with TCP; 12 Mar 88  15:27:18 PSTReceived: from EUPHRATES.SCRC.Symbolics.COM by STONY-BROOK.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 361805; Sat 12-Mar-88 18:27:05 ESTDate: Sat, 12 Mar 88 18:26 ESTFrom: David A. Moon <Moon@STONY-BROOK.SCRC.Symbolics.COM>Subject: New issue: STEP-ENVIRONMENTTo: CL-Cleanup@SAIL.STANFORD.EDUMessage-ID: <19880312232651.2.MOON@EUPHRATES.SCRC.Symbolics.COM>Issue:         STEP-ENVIRONMENTReferences:    STEP (CLtL p.441)               TIME (CLtL p.441)Category:      CLARIFICATIONEdit history:  Version 1, 12-Mar-88, MoonProblem description:CLtL does not specify in what lexical environment the form given to STEPis evaluated.  Some people think it's supposed to be evaluated in thenull environment, others think it is supposed to be evaluated in thecurrent environment, the one in which the STEP form was evaluated.The same considerations apply to TIME.An additional problem is that CLtL says that STEP is a macro.  However,it is unclear what portable expression the macro could expand into,especially if STEP evaluates the form in the current environment.  STEPis really a variation of the Lisp interpreter, which makes it more likea special form than like a macro.The interaction of STEP with the compiler is not specified.Proposal (STEP-ENVIRONMENT:CURRENT):1. Clarify that STEP and TIME evaluate the form in the current environment.2. Change STEP from a macro to a special form.3. Clarify that it is an error to compile a STEP form.Test Cases/Examples:;Assuming X is not a special variable(setq x 1)(let ((x 2))  (step (print x)))This should print and return 2, not 1, when interpreted.Rationale:1. It is more useful for the lexical environment to pass transparentlythrough STEP and TIME than to reset to the null environment.2. STEP is really a variation of the Lisp interpreter, which makes it morelike a special form than like a macro.3. As a debugging TOOL, STEP forms do not need to be compiled.  It wouldbe difficult to specify precisely what should happen when a STEP form iscompiled (which parts of the form are to be executed interpretively), soit's easier to duck the issue.  Use "is an error" rather than "signalsan error" so that compile-only implementations are permitted to compileSTEP forms.Current practice:Symbolics Common Lisp behaves as proposed.Cost to Implementors:1 requires passing an environment around, which should be easy.2 and 3 are just restrictions, so they should cost nothing.Cost to Users:None.Cost of non-adoption:These debugging tools will continue to have vague specifications.Benefits:Slightly more preicse specification of Common Lisp.Esthetics:Slightly improved.Discussion:None yet.*start*01393 00024 USaReturn-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU by Xerox.COM ; 14 MAR 88 01:11:59 PSTReceived: from labrea.Stanford.EDU by SAIL.Stanford.EDU with TCP; 14 Mar 88  01:09:55 PSTReceived: by labrea.Stanford.EDU; Mon, 14 Mar 88 01:10:35 PSTReceived: from kent-state.lucid.com by edsel id AA11298g; Mon, 14 Mar 88 00:57:17 PSTReceived: by kent-state id AA00535g; Mon, 14 Mar 88 01:06:06 PSTDate: Mon, 14 Mar 88 01:06:06 PSTFrom: Eric Benson <edsel!eb@labrea.Stanford.EDU>Message-Id: <8803140906.AA00535@kent-state.lucid.com>To: Moon@stony-brook.scrc.symbolics.comCc: CL-Cleanup@sail.stanford.eduIn-Reply-To: David A. Moon's message of Sat, 12 Mar 88 18:26 EST <19880312232651.2.MOON@EUPHRATES.SCRC.Symbolics.COM>Subject: New issue: STEP-ENVIRONMENTFor Current Practice or an Implementation Note, this is the definitionof TIME in Lucid Common Lisp:(defmacro time (form)  `(time-internal #'(lambda () ,form)))The function TIME-INTERNAL looks something like:(defun time-internal (thunk)  (let ((before-time (get-time-state)))    (unwind-protect        (funcall thunk)      (print-time-information before-time (get-time-state)))))The definition of STEP is similar.  This is just to show that it iseasy to get the right lexical environment even though TIME and STEPare macros.*start*01205 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU by Xerox.COM ; 23 MAY 88 16:07:25 PDTReceived: from Xerox.COM by SAIL.Stanford.EDU with TCP; 23 May 88  16:05:34 PDTReceived: from Cabernet.ms by ArpaGateway.ms ; 23 MAY 88 16:02:52 PDTDate: 23 May 88 16:02 PDTFrom: masinter.paSubject: Re: New issue: STEP-ENVIRONMENTIn-reply-to: Eric Benson <edsel!eb@labrea.Stanford.EDU>'s message of Mon, 14 Mar 88 01:06:06 PSTTo: edsel!eb@labrea.Stanford.EDUcc: Moon@stony-brook.scrc.symbolics.com, CL-Cleanup@sail.stanford.eduMessage-ID: <880523-160252-5606@Xerox>While I believe it makes sense for TIME to be a macro, it makes less sense forSTEP to do so. My notes say that "Moon will separate this out into STEP-ENVIRONMENT andTIME-ENVIRONMENT", but it seems like make-work to me. I like the proposalbasically in the form that David submitted it. If we want to add to the Current Practice, you might want to mention that bothSTEP and TIME are macros in Lucid Common Lisp (although the macro definition forSTEP baffles me), and that in Xerox Common Lisp, STEP is a special form and TIMEis a macro.*start*01469 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU by Xerox.COM ; 24 MAY 88 13:44:38 PDTReceived: from JASPER.SCRC.Symbolics.COM ([128.81.41.58]) by SAIL.Stanford.EDU with TCP; 24 May 88  13:42:41 PDTReceived: from EUPHRATES.SCRC.Symbolics.COM by JASPER.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 191914; Tue 24-May-88 16:42:31 EDTDate: Tue, 24 May 88 16:42 EDTFrom: David A. Moon <Moon@STONY-BROOK.SCRC.Symbolics.COM>Subject: Re: Issue: STEP-ENVIRONMENTTo: CL-Cleanup@SAIL.STANFORD.EDUIn-Reply-To: <880523-160252-5606@Xerox>Message-ID: <19880524204240.5.MOON@EUPHRATES.SCRC.Symbolics.COM>    Date: 23 May 88 16:02 PDT    From: masinter.pa@Xerox.COM    While I believe it makes sense for TIME to be a macro, it makes less sense for    STEP to do so.     My notes say that "Moon will separate this out into STEP-ENVIRONMENT and    TIME-ENVIRONMENT", but it seems like make-work to me. I like the proposal    basically in the form that David submitted it.     If we want to add to the Current Practice, you might want to mention that both    STEP and TIME are macros in Lucid Common Lisp (although the macro definition for    STEP baffles me), and that in Xerox Common Lisp, STEP is a special form and TIME    is a macro.I don't think I can find the time to do any more work on this one.If someone else would like to, I certainly won't complain.*start*03617 00024 USmDate: 10 Jun 88 01:07 PDTFrom: Masinter.paSubject: Issue: STEP-ENVIRONMENT (Version 1)To: x3j13@SAIL.STANFORD.EDUcc: MasinterReply-to: CL-CLEANUP@Sail.stanford.eduLine-fold: NOIssue:         STEP-ENVIRONMENTReferences:    STEP (CLtL p.441)               TIME (CLtL p.441)Category:      CLARIFICATION/CHANGEEdit history:  Version 1, 12-Mar-88, Moon               Version 2, 10-Jun-88, Masinter (add discussion)Problem description:CLtL does not specify in what lexical environment the form given to STEPis evaluated.  Some people think it's supposed to be evaluated in thenull environment, others think it is supposed to be evaluated in thecurrent environment, the one in which the STEP form was evaluated.The same considerations apply to TIME.An additional problem is that CLtL says that STEP is a macro.  However,it is unclear what portable expression the macro could expand into,especially if STEP evaluates the form in the current environment.  STEPis really a variation of the Lisp interpreter, which makes it more likea special form than like a macro.The interaction of STEP with the compiler is not specified.Proposal (STEP-ENVIRONMENT:CURRENT):1. Clarify that STEP and TIME evaluate the form in the current environment.2. Change STEP from a macro to a special form.3. Clarify that it is an error to compile a STEP form.Test Cases/Examples:;Assuming X is not a special variable(setq x 1)(let ((x 2))  (step (print x)))This should print and return 2, not 1, when interpreted.Rationale:1. It is more useful for the lexical environment to pass transparentlythrough STEP and TIME than to reset to the null environment.2. STEP is really a variation of the Lisp interpreter, which makes it morelike a special form than like a macro.3. As a debugging TOOL, STEP forms do not need to be compiled.  It wouldbe difficult to specify precisely what should happen when a STEP form iscompiled (which parts of the form are to be executed interpretively), soit's easier to duck the issue.  Use "is an error" rather than "signalsan error" so that compile-only implementations are permitted to compileSTEP forms.Current practice:Symbolics Common Lisp behaves as proposed.Cost to Implementors:1 requires passing an environment around, which should be easy.2 and 3 are just restrictions, so they should cost nothing.Cost to Users:None.Cost of non-adoption:These debugging tools will continue to have vague specifications.Benefits:Slightly more preicse specification of Common Lisp.Esthetics:Slightly improved.Discussion:There was some discussion of separating this out into two separateproposals, but it didn't seem useful.Eric Benson contributed the definition of TIME in Lucid Common Lisp:(defmacro time (form)  `(time-internal #'(lambda () ,form)))The function TIME-INTERNAL looks something like:(defun time-internal (thunk)  (let ((before-time (get-time-state)))    (unwind-protect        (funcall thunk)      (print-time-information before-time (get-time-state)))))The definition of STEP is similar.  This is just to show that it iseasy to get the right lexical environment even though TIME and STEPare macros.        TITAN 
         TITAN 
          
TIMESROMAN 
           »                            4                            [                    '      }       %       ¶              Ž             p              -              ~                            D       
       6                           i      ’ !zº*start*00881 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU by Xerox.COM ; 21 JUN 88 17:40:49 PDTReceived: from labrea.stanford.edu by SAIL.Stanford.EDU with TCP; 21 Jun 88  17:40:22 PDTReceived: by labrea.stanford.edu; Tue, 21 Jun 88 17:40:26 PDTReceived: from blacksox.lucid.com by edsel id AA21993g; Tue, 21 Jun 88 14:17:18 PDTReceived: by blacksox id AA00409g; Tue, 21 Jun 88 14:16:19 pdtDate: Tue, 21 Jun 88 14:16:19 pdtFrom: Eric Benson <edsel!eb@labrea.stanford.edu>Message-Id: <8806212116.AA00409@blacksox.lucid.com>To: sandra@cs.utah.eduCc: cl-cleanup@sail.stanford.eduIn-Reply-To: Sandra J Loosemore's message of Mon, 20 Jun 88 16:44:51 MDT <8806202244.AA29826@cs.utah.edu>Subject: STEP-ENVIRONMENT, version 3Add to Current Practice: Lucid Common Lisp behaves as proposed.*start*03314 00024 USfReturn-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU by Xerox.COM ; 20 JUN 88 15:46:32 PDTReceived: from cs.utah.edu by SAIL.Stanford.EDU with TCP; 20 Jun 88  15:46:13 PDTReceived: by cs.utah.edu (5.54/utah-2.0-cs)	id AA29826; Mon, 20 Jun 88 16:44:53 MDTFrom: sandra@cs.utah.edu (Sandra J Loosemore)Message-Id: <8806202244.AA29826@cs.utah.edu>Date: Mon, 20 Jun 88 16:44:51 MDTSubject: STEP-ENVIRONMENT, version 3To: cl-cleanup@sail.stanford.eduAs promised, here is a revised version of the STEP-ENVIRONMENT proposal.I have removed the part of the proposal that would make STEP a specialform instead of a macro.-SandraIssue:         STEP-ENVIRONMENT References:    STEP (CLtL p.441)               TIME (CLtL p.441) Category:      CLARIFICATION/CHANGE Edit history:  Version 1, 12-Mar-88, Moon               Version 2, 10-Jun-88, Masinter (add discussion)	       Version 3, 20-Jun-88, Loosemore (not a special form) Problem description: CLtL does not specify in what lexical environment the form given to STEPis evaluated.  Some people think it's supposed to be evaluated in thenull environment, others think it is supposed to be evaluated in thecurrent environment, the one in which the STEP form was evaluated. The same considerations apply to TIME.  Proposal (STEP-ENVIRONMENT:CURRENT): 1. Clarify that STEP and TIME evaluate the form in the current environment.2. Clarify that calls to both STEP and TIME may be compiled, but thatin the case of STEP, it is acceptable for an implementation tointeractively step through only those parts of the evaluation that areinterpreted.  Test Cases/Examples: ;Assuming X is not a special variable(setq x 1)(let ((x 2))  (step (print x))) This should print and return 2, not 1, when interpreted. Rationale: 1. It is more useful for the lexical environment to pass transparentlythrough STEP and TIME than to reset to the null environment.2. Although STEP is primarily a debugging tool, there is no reason toprevent it from being compiled correctly. Current practice:Vax Lisp behaves as proposed.  Symbolics Common Lisp treats STEP as a specialform and does not allow it to be compiled. Cost to Implementors: Minimal.Cost to Users: None.Cost of non-adoption: These debugging tools will continue to have vague specifications. Benefits: Slightly more preicse specification of Common Lisp. Esthetics: Slightly improved. Discussion: There was some discussion of separating this out into two separateproposals, but it didn't seem useful. Eric Benson contributed the definition of TIME in Lucid Common Lisp: (defmacro time (form)  `(time-internal #'(lambda () ,form)))  The function TIME-INTERNAL looks something like: (defun time-internal (thunk)  (let ((before-time (get-time-state)))    (unwind-protect        (funcall thunk)      (print-time-information before-time (get-time-state))))) The definition of STEP is similar.  This is just to show that it iseasy to get the right lexical environment even though TIME and STEPare macros.VaxLisp expands STEP into something like:(defmacro step (form)    `(let ((*eval-hook* #'step-command-loop))        ,form)) -------*start*00670 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU by Xerox.COM ; 20 JUN 88 18:42:28 PDTReceived: from hudson.dec.com by SAIL.Stanford.EDU with TCP; 20 Jun 88  18:42:35 PDTDate: 20 Jun 88 21:20:00 EDTFrom: "AITG::VANROGGEN" <vanroggen%aitg.decnet@hudson.dec.com>Subject: Issue: STEP-ENVIRONMENT, version 3To: "cl-cleanup" <cl-cleanup@sail.stanford.edu>cc: vanroggen@hudson.dec.com Reply-To: "AITG::VANROGGEN" <vanroggen%aitg.decnet@hudson.dec.com>This looks pretty good--we really want to minimize the number of specialforms if at all possible.			---Walter------*start*02773 00024 USfDate:  7 Oct 88 22:03 PDTFrom: masinter.paSubject: STEP-ENVIRONMENT, version 3To: x3j13@sail.stanford.eduREPLY-TO: cl-cleanup@sail.stanford.eduline-fold: NOcc: MasinterIssue:         STEP-ENVIRONMENT References:    STEP (CLtL p.441)               TIME (CLtL p.441) Category:      CLARIFICATION/CHANGE Edit history:  Version 1, 12-Mar-88, Moon               Version 2, 10-Jun-88, Masinter (add discussion)	       Version 3, 20-Jun-88, Loosemore (not a special form) Problem description: CLtL does not specify in what lexical environment the form given to STEPis evaluated.  Some people think it's supposed to be evaluated in thenull environment, others think it is supposed to be evaluated in thecurrent environment, the one in which the STEP form was evaluated. The same considerations apply to TIME. Proposal (STEP-ENVIRONMENT:CURRENT): 1. Clarify that STEP and TIME evaluate the form in the current environment.2. Clarify that calls to both STEP and TIME may be compiled, but thatin the case of STEP, it is acceptable for an implementation tointeractively step through only those parts of the evaluation that areinterpreted. Test Cases/Examples: ;Assuming X is not a special variable(setq x 1)(let ((x 2))  (step (print x))) This should print and return 2, not 1, when interpreted. Rationale: 1. It is more useful for the lexical environment to pass transparentlythrough STEP and TIME than to reset to the null environment.2. Although STEP is primarily a debugging tool, there is no reason toprevent it from being compiled correctly. Current practice:Vax Lisp behaves as proposed.  Symbolics Common Lisp treats STEP as a special form and does not allow it to be compiled. Cost to Implementors: Minimal.Cost to Users: None.Cost of non-adoption: These debugging tools will continue to have vague specifications. Benefits: Slightly more preicse specification of Common Lisp. Esthetics: Slightly improved. Discussion: There was some discussion of separating this out into two separateproposals, but it didn't seem useful. Eric Benson contributed the definition of TIME in Lucid Common Lisp: (defmacro time (form)  `(time-internal #'(lambda () ,form)))  The function TIME-INTERNAL looks something like: (defun time-internal (thunk)  (let ((before-time (get-time-state)))    (unwind-protect        (funcall thunk)      (print-time-information before-time (get-time-state))))) The definition of STEP is similar.  This is just to show that it iseasy to get the right lexical environment even though TIME and STEPare macros.VaxLisp expands STEP into something like:(defmacro step (form)    `(let ((*eval-hook* #'step-command-loop))        ,form))*start*03012 00024 US Date:  9 Dec 88 01:25 PSTFrom: masinter.paTo: MasinterSubject: Issue: STEP-ENVIRONMENT (Version 3)Issue:         STEP-ENVIRONMENT References:    STEP (CLtL p.441)               TIME (CLtL p.441) Category:      CLARIFICATION/CHANGE Edit history:  Version 1, 12-Mar-88, Moon               Version 2, 10-Jun-88, Masinter (add discussion)	       Version 3, 20-Jun-88, Loosemore (not a special form) Problem description: CLtL does not specify in what lexical environment the form given to STEPis evaluated.  Some people think it's supposed to be evaluated in thenull environment, others think it is supposed to be evaluated in thecurrent environment, the one in which the STEP form was evaluated. The same considerations apply to TIME. Proposal (STEP-ENVIRONMENT:CURRENT): 1. Clarify that STEP and TIME evaluate the form in the current environment.2. Clarify that calls to both STEP and TIME may be compiled, but thatin the case of STEP, it is acceptable for an implementation tointeractively step through only those parts of the evaluation that areinterpreted. Examples: ;Assuming X is not a special variable(setq x 1)(let ((x 2))  (step (print x))) This should print and return 2, not 1, when interpreted. Rationale: 1. It is more useful for the lexical environment to pass transparentlythrough STEP and TIME than to reset to the null environment.2. Although STEP is primarily a debugging tool, there is no reason toprevent it from being compiled correctly.Current practice:Vax Lisp behaves as proposed.  Symbolics Common Lisp treats STEP as a special form and does not allow it to be compiled. Cost to Implementors: Minimal.Cost to Users: None.Cost of non-adoption: These debugging tools will continue to have vague specifications. Benefits: Slightly more preicse specification of Common Lisp. Esthetics: Slightly improved. Discussion: There was some discussion of separating this out into two separateproposals, but it didn't seem useful. Eric Benson contributed the definition of TIME in Lucid Common Lisp: (defmacro time (form)  `(time-internal #'(lambda () ,form)))  The function TIME-INTERNAL looks something like: (defun time-internal (thunk)  (let ((before-time (get-time-state)))    (unwind-protect        (funcall thunk)      (print-time-information before-time (get-time-state))))) The definition of STEP is similar.  This is just to show that it iseasy to get the right lexical environment even though TIME and STEPare macros.VaxLisp expands STEP into something like:(defmacro step (form)    `(let ((*eval-hook* #'step-command-loop))        ,form))        TITAN 
         TITAN 
           x                     5                            š             D       %      *       
       ‘              ø              }                            	              F       
       8                           ï      
h zº*start*01085 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 02 JAN 89 15:29:56 PSTReceived: from Xerox.COM by SAIL.Stanford.EDU with TCP; 2 Jan 89  15:29:44 PSTReceived: from Semillon.ms by ArpaGateway.ms ; 02 JAN 89 15:28:10 PSTDate: 2 Jan 89 15:27 PSTSender: masinter.paSubject: re: Issue: STEP-ENVIRONMENT (Version 3)To: cl-cleanup@sail.stanford.eduFrom: Kim A. Barrett <IIM@ECLA.USC.EDU>Message-ID: <890102-152810-1747@Xerox>I have no problem with TIME behaving as proposed.  I have serious problems withSTEP though, as far as compiled behavior.  I don't agree that it is easy to getthe environment right in this case, because it would require the interpreter tohandle compiler data structures, which might not even be possible.  Maybe I'mmisunderstanding what is wanted for compiled STEP.  If what is wanted is thatexecution of interpreted code which occurs within the context of the STEP macroshould be stepped, then that's ok, and I'll vote YES.