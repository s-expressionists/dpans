*start*00958 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([10.0.0.11]) by Xerox.COM ; 02 SEP 88 16:38:48 PDTReceived: from Xerox.COM by SAIL.Stanford.EDU with TCP; 2 Sep 88  16:36:47 PDTReceived: from Semillon.ms by ArpaGateway.ms ; 02 SEP 88 16:15:59 PDTDate: 2 Sep 88 16:15 PDTFrom: Masinter.paSubject: Issue: CLOSED-STREAM-OPERATIONS (Version 1) formerly DISALLOW-CLOSED-STREAM-FUNCTIONSIn-reply-to: chapman%aitg.DEC@decwrl.dec.com's message of Tue, 30 Aug 88 11:57:21 PDTTo: chapman%aitg.DEC@decwrl.dec.comcc: cl-cleanup@sail.stanford.eduMessage-ID: <880902-161559-7391@Xerox>I'm going to nitpick the name of the issue, and call the itCLOSED-STREAM-OPERATIONS.Frankly, I'd be unhappy if there were no way to ask a stream whether it wasclosed. I would much prefer OUTPUT-STREAM-P and INPUT-STREAM-P be required tojust answer NIL on closed streams.*start*02021 00024 USfReturn-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 30 AUG 88 11:59:28 PDTReceived: from decwrl.dec.com by SAIL.Stanford.EDU with TCP; 30 Aug 88  11:58:27 PDTReceived: by decwrl.dec.com (5.54.5/4.7.34)	id AA16097; Tue, 30 Aug 88 11:57:21 PDTDate: Tue, 30 Aug 88 11:57:21 PDTMessage-Id: <8808301857.AA16097@decwrl.dec.com>From: chapman%aitg.DEC@decwrl.dec.comTo: cl-cleanup@sail.stanford.eduSubject: DISALLOW-CLOSED-STREAM-FUNCTIONSIssue:        DISALLOW-CLOSED-STREAM-FUNCTIONSReferences:   CLOSE (p 332)Category:     CLARIFICATIONEdit history: 26-Aug-88, Version 1 by ChapmanProblem Description:The description of CLOSE is not completely clear about the functionswhich are allowed to be performed on a closed stream.On p332 it says:	"The stream is closed. No further Input/output operations may be	performed on it. However, certain inquiry operations may still	be performed, ..."but the list of inquiry operations is not specified.At least one implementation interpreted the list to includeat least OUTPUT-STREAM-P, while another has disallowed that operationto be performed on a closed stream. Proposal (DISALLOW-CLOSED-STREAM-FUNCTIONS:ALL)Clarify that it is an error to perform any operation on a closed stream.Rationale:This clarification allows existing implementations to maintain the statusquo, while alerting users to the fact that the result of performingan operation on a closed stream is undefined in the standard.Also, the descriptions of OUTPUT-STREAM-P and INPUT-STREAM-P indicatethat these functions can only be performed on streams that have notbeen closed.Current Practice:At least two implementations differ in which functions are allowed to beperformed on a closed stream.Adoption Cost:None.Benefits:This clarification will assist users in writing portable code.Conversion Cost:None.Aesthetics:None.Discussion:*start*01594 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([10.0.0.11]) by Xerox.COM ; 04 SEP 88 15:59:39 PDTReceived: from Xerox.COM by SAIL.Stanford.EDU with TCP; 4 Sep 88  15:59:20 PDTReceived: from Semillon.ms by ArpaGateway.ms ; 04 SEP 88 15:56:22 PDTDate: 4 Sep 88 15:56 PDTFrom: Masinter.paTo: cl-cleanup@sail.stanford.eduSubject: Issue: CLOSED-STREAM-OPERATIONS (Version 1)Message-ID: <880904-155622-8877@Xerox>This reminds me a little of the PATHNAME issue. I think that CLOSE is only validfor streams that PATHNAME was valid forWhat does it mean to CLOSE a composite stream ( broadcast two-way synonymconcatenated) ? The choices I can think of are:a) no effectb) implementation dependent (ugh)c) closes constituent streamsd) the composite stream is "closed" (no I/O operations allowed) but	the constituents are not.What does it mean to close a constructed stream (e.g., STRING)? a) no effectb) implementation dependent (ugh)c) the constructed stream is "closed" (no I/O operations allowed).I think the following operations should be as valid after a CLOSE as before(i.e., they're valid after the close only if they were valid before):STREAMP, INPUT-STREAM-P, OUTPUT-STREAM-P, TRUENAME, PATHNAME. (In fact, thereare some operating systems where you can *only* get TRUENAME on a closed stream,since the name isn't true until the stream has been closed.)Note that the issues STREAM-CAPABILITIES, STREAM-INFO, and  STREAM-CLASS-ACCESSadd functions that take streams.*start*02248 00024 USaReturn-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([10.0.0.11]) by Xerox.COM ; 07 SEP 88 18:43:58 PDTReceived: from STONY-BROOK.SCRC.Symbolics.COM (SCRC-STONY-BROOK.ARPA) by SAIL.Stanford.EDU with TCP; 7 Sep 88  18:43:10 PDTReceived: from EUPHRATES.SCRC.Symbolics.COM by STONY-BROOK.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 455943; Wed 7-Sep-88 21:41:50 EDTDate: Wed, 7 Sep 88 21:41 EDTFrom: David A. Moon <Moon@STONY-BROOK.SCRC.Symbolics.COM>Subject: Issue: CLOSED-STREAM-OPERATIONS (Version 1)To: Masinter.pacc: cl-cleanup@SAIL.STANFORD.EDUIn-Reply-To: <880904-155622-8877@Xerox>Message-ID: <19880908014133.2.MOON@EUPHRATES.SCRC.Symbolics.COM>Line-fold: No    Date: 4 Sep 88 15:56 PDT    From: Masinter.pa@Xerox.COM    This reminds me a little of the PATHNAME issue. I think that CLOSE is only valid    for streams that PATHNAME was valid forCertainly not.  Suppose I have a stream that represents a network connectionto another computer.  This stream doesn't go to a file, so it has no pathname,but it certainly has a well-defined concept of closing.    What does it mean to CLOSE a composite stream ( broadcast two-way synonym    concatenated) ? The choices I can think of are:    a) no effect    b) implementation dependent (ugh)    c) closes constituent streams    d) the composite stream is "closed" (no I/O operations allowed) but	    the constituents are not.I prefer c.    What does it mean to close a constructed stream (e.g., STRING)?     a) no effect    b) implementation dependent (ugh)    c) the constructed stream is "closed" (no I/O operations allowed).I prefer a or c.    I think the following operations should be as valid after a CLOSE as before    (i.e., they're valid after the close only if they were valid before):    STREAMP, INPUT-STREAM-P, OUTPUT-STREAM-P, TRUENAME, PATHNAME. (In fact, there    are some operating systems where you can *only* get TRUENAME on a closed stream,    since the name isn't true until the stream has been closed.)Certainly.    Note that the issues STREAM-CAPABILITIES, STREAM-INFO, and  STREAM-CLASS-ACCESS    add functions that take streams.*start*00678 00024 US Date: 14 Sep 88 02:18 PDTFrom: masinter.paSubject: Re: Issue: CLOSED-STREAM-OPERATIONS (Version 1)In-reply-to: David A. Moon <Moon@STONY-BROOK.SCRC.Symbolics.COM>'s message of Wed, 7 Sep 88 21:41 EDTTo: chapman%aitg.DEC@decwrl.dec.comcc: masinterI think this is a hard issue only because there are many details to be worked out. Since it arose during the "editorial process" I think it is a candidate for the exemption which applies to issues we can handle for the next meeting. There are lots of issues, so lets postpone this one til after the Virginia meeting (unless there's already someone with a rewrite...)Are you comfortable with that?*start*01062 00024 US Return-Path: <chapman%aitg.DEC@decwrl.dec.com>Received: from decwrl.dec.com ([128.45.9.1]) by Xerox.COM ; 14 SEP 88 05:06:10 PDTReceived: by decwrl.dec.com (5.54.5/4.7.34)	id AA26594; Wed, 14 Sep 88 05:05:58 PDTDate: Wed, 14 Sep 88 05:05:58 PDTMessage-Id: <8809141205.AA26594@decwrl.dec.com>From: chapman%aitg.DEC@decwrl.dec.comTo: masinter.paSubject: Re: Issue: CLOSED-STREAM-OPERATIONS (Version 1)>I think this is a hard issue only because there are many details to be worked>out. Since it arose during the "editorial process" I think it is a candidate for>the exemption which applies to issues we can handle for the next meeting. There>are lots of issues, so lets postpone this one til after the Virginia meeting>(unless there's already someone with a rewrite...)It seems like the original issue was pretty straightforward. The surroundingissues of what close actually does seem to be the problem. Maybe the issueshould be renamed, or another issue should be written.>Are you comfortable with that?I'm easy :-)kc*start*01266 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 21 SEP 88 02:41:07 PDTReceived: from Xerox.COM by SAIL.Stanford.EDU with TCP; 21 Sep 88  02:40:38 PDTReceived: from Cabernet.ms by ArpaGateway.ms ; 21 SEP 88 02:39:17 PDTDate: 21 Sep 88 02:39 PDTFrom: masinter.paSubject: Re: Issue: CLOSED-STREAM-OPERATIONS (Version 1)In-reply-to: David A. Moon <Moon@STONY-BROOK.SCRC.Symbolics.COM>'s message of Wed, 7 Sep 88 21:41 EDTTo: cl-cleanup@SAIL.STANFORD.EDUMessage-ID: <880921-023917-5692@Xerox>Are we agreed that functions that take streams and coerce them to pathnames arerequired to take closed streams and recall the pathname to which the stream wasoriginally attached? E.g.,  does  (with-open-file (x name)    (pathname x))return the 'same' value as(pathname (with-open-file (x name) x))?I think to sort this out further, we need a complete list of functions thataccept streams, and a blow-by-blow on whether closed streams are OK or not.I think we also need a separate CLOSE-CONSTRUCTED-STREAM issue which outlinesthe operations of CLOSE on constructed streams. I have no problems acceptingMoon's preferences.*start*02877 00024 US Date:  8 Oct 88 12:48 PDTFrom: masinter.paSubject: DRAFT Issue: CLOSED-STREAM-OPERATIONS (Version 2)To: x3j13@sail.stanford.eduREPLY-TO: cl-cleanup@sail.stanford.eduline-fold: NOcc: MasinterThis issue is in discussion in the cleanup committee. The proposal is not ready for voting at X3J13. This is to inform you about the current state of discussion.Status: DRAFTIssue:        CLOSED-STREAM-OPERATIONSReferences:   CLOSE (p 332)Category:     CLARIFICATIONEdit history: 26-Aug-88, Version 1 by Chapman               8-Oct-88, Version 2 by MasinterRelated Issues: STREAM-CAPABILITIES, STREAM-ACCESS, STREAM-INFOProblem Description:The description of CLOSE is not completely clear about the functionswhich are allowed to be performed on a closed stream.On p332 it says:	"The stream is closed. No further Input/output operations may be	performed on it. However, certain inquiry operations may still	be performed, ..."but the list of inquiry operations is not specified.At least one implementation interpreted the list to includeat least OUTPUT-STREAM-P, while another has disallowed that operationto be performed on a closed stream. Proposal (CLOSED-STREAM-FUNCTIONS:DISALLOW-ALL)Clarify that it is an error to perform any operation on a closed stream.Rationale:This clarification allows existing implementations to maintain the statusquo, while alerting users to the fact that the result of performingan operation on a closed stream is undefined in the standard.Also, the descriptions of OUTPUT-STREAM-P and INPUT-STREAM-P indicatethat these functions can only be performed on streams that have notbeen closed.Current Practice:At least two implementations differ in which functions are allowed to beperformed on a closed stream.Adoption Cost:None.Benefits:This clarification will assist users in writing portable code.Conversion Cost:None.Aesthetics:None.Discussion:Closing streams is necessary for deallocation of system resources that might have been associated with their opening. Implementations and stream-types differ as to how much of the "stream information" that Lisp normally expects to be able to obtain is in the host operating system (and thus deallocated when the stream is closed)  and how much is in Lisp, and presumably managed by the normal Lisp storage manager.  Closing a file stream also has the effect of allowing the file to be accessed for other operations in operating systems that implement file interlocking.Of STREAMP, INPUT-STREAM-P, OUTPUT-STREAM-P, TRUENAME, PATHNAME, which are legitimate on closed streams?	all?What are the effects of CLOSE on composite streams (such as broadcast, two-way, and concatinated streams?) 	close constituents?What are the effects of CLOSE on a constructed stream (e.g., WITH-OUTPUT-TO-STRING)?	no effect?*start*03200 00024 US Return-Path: <X3J13-mailer@SAIL.Stanford.EDU>Received: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 08 OCT 88 13:05:33 PDTReceived: from Xerox.COM by SAIL.Stanford.EDU with TCP; 8 Oct 88  12:53:36 PDTReceived: from Semillon.ms by ArpaGateway.ms ; 08 OCT 88 12:48:03 PDTDate: 8 Oct 88 12:48 PDTFrom: masinter.paSubject: DRAFT Issue: CLOSED-STREAM-OPERATIONS (Version 2)To: x3j13@sail.stanford.eduREPLY-TO: cl-cleanup@sail.stanford.eduline-fold: NOcc: Masinter.paMessage-ID: <881008-124803-2142@Xerox>This issue is in discussion in the cleanup committee. The proposal is not ready for voting at X3J13. This is to inform you about the current state of discussion.!Status: DRAFTIssue:        CLOSED-STREAM-OPERATIONSReferences:   CLOSE (p 332)Category:     CLARIFICATIONEdit history: 26-Aug-88, Version 1 by Chapman               8-Oct-88, Version 2 by MasinterRelated Issues: STREAM-CAPABILITIES, STREAM-ACCESS, STREAM-INFOProblem Description:The description of CLOSE is not completely clear about the functionswhich are allowed to be performed on a closed stream.On p332 it says:	"The stream is closed. No further Input/output operations may be	performed on it. However, certain inquiry operations may still	be performed, ..."but the list of inquiry operations is not specified.At least one implementation interpreted the list to includeat least OUTPUT-STREAM-P, while another has disallowed that operationto be performed on a closed stream. Proposal (CLOSED-STREAM-FUNCTIONS:DISALLOW-ALL)Clarify that it is an error to perform any operation on a closed stream.Rationale:This clarification allows existing implementations to maintain the statusquo, while alerting users to the fact that the result of performingan operation on a closed stream is undefined in the standard.Also, the descriptions of OUTPUT-STREAM-P and INPUT-STREAM-P indicatethat these functions can only be performed on streams that have notbeen closed.Current Practice:At least two implementations differ in which functions are allowed to beperformed on a closed stream.Adoption Cost:None.Benefits:This clarification will assist users in writing portable code.Conversion Cost:None.Aesthetics:None.Discussion:Closing streams is necessary for deallocation of system resources that might have been associated with their opening. Implementations and stream-types differ as to how much of the "stream information" that Lisp normally expects to be able to obtain is in the host operating system (and thus deallocated when the stream is closed)  and how much is in Lisp, and presumably managed by the normal Lisp storage manager.  Closing a file stream also has the effect of allowing the file to be accessed for other operations in operating systems that implement file interlocking.Of STREAMP, INPUT-STREAM-P, OUTPUT-STREAM-P, TRUENAME, PATHNAME, which are legitimate on closed streams?	all?What are the effects of CLOSE on composite streams (such as broadcast, two-way, and concatinated streams?) 	close constituents?What are the effects of CLOSE on a constructed stream (e.g., WITH-OUTPUT-TO-STRING)?	no effect?*start*03214 00024 USfReturn-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 13 OCT 88 12:00:34 PDTReceived: from decwrl.dec.com by SAIL.Stanford.EDU with TCP; 13 Oct 88  12:00:37 PDTReceived: by decwrl.dec.com (5.54.5/4.7.34)	id AA13409; Thu, 13 Oct 88 11:58:56 PDTDate: Thu, 13 Oct 88 11:58:56 PDTMessage-Id: <8810131858.AA13409@decwrl.dec.com>From: vanroggen%aitg.DEC@decwrl.dec.comTo: cl-cleanup@sail.stanford.eduSubject: Issue: CLOSED-STREAM-OPERATIONS (version 3)Status: DRAFTIssue:        CLOSED-STREAM-OPERATIONSReferences:   CLOSE (CLtL p 332)Category:     CLARIFICATIONEdit history: 26-Aug-88, Version 1 by Chapman               8-Oct-88, Version 2 by Masinter              13-Oct-88, Version 3 by van Roggen Related Issues: STREAM-ACCESS, STREAM-INFO  Problem Description: The description of CLOSE is not completely clear about the functionswhich are allowed to be performed on a closed stream. On p332 it says:	"The stream is closed. No further Input/output operations may be	performed on it. However, certain inquiry operations may still	be performed, ..."but the list of inquiry operations is not specified. At least one implementation interpreted the list to includeat least OUTPUT-STREAM-P, while another has disallowed that operationto be performed on a closed stream.  Proposal (CLOSED-STREAM-FUNCTIONS:ALLOW-INQUIRY) Clarify that one may call the following functions on closed streams withouterror due to the stream being closed:  STREAMP, INPUT-STREAM-P, OUTPUT-STREAM-P, CLOSE, PATHNAME, TRUENAME,  MERGE-PATHNAMES, PATHNAME-HOST, PATHNAME-DEVICE, PATHNAME-DIRECTORY,  PATHNAME-NAME, PATHNAME-TYPE, PATHNAME-VERSION, NAMESTRING, FILE-NAMESTRING,  DIRECTORY-NAMESTRING, HOST-NAMESTRING, ENOUGH-NAMESTRING, OPEN,  PROBE-FILE, DIRECTORYIf proposal STREAM-ACCESS:PROVIDE is adopted, all of its functions will workon closed streams.If proposal STREAM-INFO:ONE-DIMENSIONAL-FUNCTIONS is adopted, none of itsfunctions are required to work on closed streams. Rationale: One can consider many characteristics of a stream to be independent ofthe ability to do I/O.  Being able to determine a stream's direction andits name is often useful for debugging.  A number of the descriptions inCLtL imply (weakly) the ability to work on closed streams.  Functionssuch as OPEN and DIRECTORY don't really depend on the stream, but onthe name of the stream. Current Practice: At least two implementations differ in which functions are allowed to beperformed on a closed stream. Cost to Implementors: Unknown, but likely to be small in most implementations.  A nontrivialamount of work may be necessary if the pathname information is heldexternally and is normally deleted when the stream is closed.  Theimplementation will have to copy the information at some time for laterinquiries.Cost to Users:None. Benefits: This clarification will assist users in writing portable code. Aesthetics: Yes. Discussion:There are some separate, but related, issues regarding what CLOSE shoulddo on composite streams or constructed streams.*start*01187 00024 USfReturn-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 13 OCT 88 12:46:23 PDTReceived: from STONY-BROOK.SCRC.Symbolics.COM (SCRC-STONY-BROOK.ARPA) by SAIL.Stanford.EDU with TCP; 13 Oct 88  12:46:38 PDTReceived: from BOBOLINK.SCRC.Symbolics.COM by STONY-BROOK.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 475724; Thu 13-Oct-88 15:45:08 EDTDate: Thu, 13 Oct 88 15:44 EDTFrom: Kent M Pitman <KMP@STONY-BROOK.SCRC.Symbolics.COM>Subject: Issue: CLOSED-STREAM-OPERATIONS (Version 2)To: CL-Cleanup@SAIL.Stanford.EDUMessage-ID: <881013154459.5.KMP@BOBOLINK.SCRC.Symbolics.COM>My notes from Fairfax meeting...Cleanup meeting: Responsibility for this issue was delegated to Jim Allard (@Gensym) and Dan Pierson.X3J13 meeting: RWK: Existing propsoal maximizes incompatibilty      [Barmar pointed out that this proposal doesn't force implementors       to change -- it just points out what's portable. KMP agrees but       doesn't know for sure if RWK bought this argument. In any case,       the point should be clarified to avoid further discussion.]*start*00961 00024 USfReturn-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 17 OCT 88 10:07:35 PDTReceived: from multimax.ARPA by SAIL.Stanford.EDU with TCP; 17 Oct 88  10:03:13 PDTReceived:  by multimax.ARPA (5.51/25-eef)	id AA00771; Mon, 17 Oct 88 13:02:12 EDTReceived: from localhost by mist.UUCP (3.2/4.7)	id AA11549; Mon, 17 Oct 88 12:16:30 EDTMessage-Id: <8810171616.AA11549@mist.UUCP>To: "vanroggen%aitg.DEC@decwrl.dec.com"@MULTIMAX.ENCORE.COMCc: cl-cleanup%sail.stanford.edu@MULTIMAX.ENCORE.COMSubject: Re: Issue: CLOSED-STREAM-OPERATIONS (version 3) In-Reply-To: Your message of Thu, 13 Oct 88 11:58:56 -0700.             <8810131858.AA13409@decwrl.dec.com> Date: Mon, 17 Oct 88 12:16:28 EDTFrom: Dan L. Pierson <pierson%mist@MULTIMAX.ENCORE.COM>Thanks Walter.  Since this looks good at a first glance, I'm notplanning another writeup.*start*03458 00024 USfReturn-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 17 OCT 88 12:15:03 PDTReceived: from STONY-BROOK.SCRC.Symbolics.COM (SCRC-STONY-BROOK.ARPA) by SAIL.Stanford.EDU with TCP; 17 Oct 88  12:13:07 PDTReceived: from BOBOLINK.SCRC.Symbolics.COM by STONY-BROOK.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 477479; Mon 17-Oct-88 15:11:57 EDTDate: Mon, 17 Oct 88 15:11 EDTFrom: Kent M Pitman <KMP@STONY-BROOK.SCRC.Symbolics.COM>Subject: Issue: CLOSED-STREAM-OPERATIONS (version 3)To: vanroggen%aitg.DEC@decwrl.dec.comcc: CL-Cleanup@SAIL.Stanford.EDUIn-Reply-To: <8810131858.AA13409@decwrl.dec.com>Message-ID: <881017151141.7.KMP@BOBOLINK.SCRC.Symbolics.COM>    Date: Thu, 13 Oct 88 11:58:56 PDT    From: vanroggen%aitg.DEC@decwrl.dec.com    ...    Issue:        CLOSED-STREAM-OPERATIONS    ...     Proposal (CLOSED-STREAM-FUNCTIONS:ALLOW-INQUIRY)     Clarify that one may call the following functions on closed streams without    error due to the stream being closed:This is not the same as saying they will continue to return the same values.For example... - perhaps CLOSE on a closed stream should return NIL, not T.  - perhaps some implementations would want INPUT-STREAM-P of closed streams to be NIL.   i think there's no good reason to have that be so, but it's an issue that would   have to be resolved and implementations would likely diverge in the absence of info   so it could lead to portability troubles if we don't clarify that if a stream was   INPUT-STREAM-P when open, it will be when closed, too. [we might acknowledge the   possibilty that a stream could be `re-opened' in an implementation-specific way,   in which case the way this function operated could change.]    (SETQ S (OPEN "file" :DIRECTION :INPUT))    (INPUT-STREAM-P S) => T    (CLOSE S) => T    (CLOSE S) => T ;NIL?    (INPUT-STREAM-P S) => T    (OPEN S :DIRECTION :OUTPUT) => ??    (INPUT-STREAM-P S) => ?? - I could imagine the pathname information for a pathname wanting to change from   the opened name to the truename upon close. eg, if you open .NEWEST, you might   know the truename only after you close. TRUENAME might therefore want to return   something different after CLOSE. Whether it should be permitted is something   -we- should decide, not something we should leave up to implementors ... at least   not without making it explicit that we're doing so. - Gack. I never noticed that PATHNAME-VERSION could be called on a stream. Hmmmm.   Same comment as for TRUENAME, I guess. - The interaction of DIRECTORY is particularly interesting. Even if the truename   does not change, some file systems will treat DIRECTORY of foo.lisp.newest   differently depending on whether the stream to that file is still open. Some can   tell you the file is there but it's still open, while others will not admit its   existence until it's closed. I don't think we can get away without saying   something about this.Any operation for which the level of well-definedness of its meaning is not preservedby CLOSE is at least a candidate for making an out-and-out error since the behaviorafter CLOSE will not be portably defined. Actually, we can probably say "unspecified"in most cases rather than "undefined" since we can say the behavior is harmless, butit just may not be particularly meaningful...*start*00938 00024 USfReturn-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 17 OCT 88 12:37:01 PDTReceived: from decwrl.dec.com by SAIL.Stanford.EDU with TCP; 17 Oct 88  12:35:42 PDTReceived: by decwrl.dec.com (5.54.5/4.7.34)	id AA24044; Mon, 17 Oct 88 12:34:44 PDTDate: Mon, 17 Oct 88 12:34:44 PDTMessage-Id: <8810171934.AA24044@decwrl.dec.com>From: vanroggen%aitg.DEC@decwrl.dec.comTo: KMP@stony-brook.scrc.symbolics.comSubject: RE: Issue: CLOSED-STREAM-OPERATIONS (version 3)The problems you mention are part of the reason Kathy and I originallyproposed the "can't-do-anything-on-closed-streams" version of thisproposal.  (Although I hadn't included STREAMP in the list of can't-do's,since I hadn't thought of that predicate originally.)Anyone else have any comments?  I don't want to spend too much time on thisissue.*start*02232 00024 USfReturn-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 25 OCT 88 16:33:40 PDTReceived: from Xerox.COM by SAIL.Stanford.EDU with TCP; 25 Oct 88  16:32:03 PDTReceived: from Semillon.ms by ArpaGateway.ms ; 25 OCT 88 16:31:40 PDTDate: 25 Oct 88 16:31 PDTFrom: masinter.paSubject: RE: Issue: CLOSED-STREAM-OPERATIONS (version 3)In-reply-to: vanroggen%aitg.DEC@decwrl.dec.com's message of Mon, 17 Oct 88 12:34:44 PDTTo: vanroggen%aitg.DEC@decwrl.dec.comcc: cl-cleanup@sail.stanford.eduMessage-ID: <881025-163140-12090@Xerox>I think the goal is to standardly allow those operations that are usuallyimplemented and are useful.I thus think it is useful to address explicitly the questions Kent asks --I don't think we can or should finess them.I would prefer INPUT-STREAM-P and OUTPUT-STREAM-P to return false forstreams which do not admit input or output respectively, which, I think,includes closed streams.So:After a stream has been closed:(STREAMP closed-stream)	returns true(INPUT-STREAM-P closed-stream) returns false(OUTPUT-STREAM-P closed-stream) returns false(CLOSE stream) returns NIL (?)All of the other functions in the list are the ones that that accept astream and coerce it to a pathname work at least as specifically as theywould with the open stream. (This is subject to some further work on thepathname functions; the idea is that once the stream is CLOSEd that thestream object may have *more* specific pathname information associated withit than before, and that in some way the pathname used should bebest-effort name to get at the same data. )The point here is that if I want to write out some data and read it back inlater, I should be able to(let((saved-file (pathname (with-open-file (x pathname :direction :output)(print stuff x) x))))   (with-open-file (x saved-file :direction :input)       (read x)))and expect the second with-open-file to get at the same data that the firstone wrote.The operation of CLOSE on constructed streams (as constructed withWITH-OUTPUT-TO-STRING or MAKE-BROADCAST-STREAM) should be specified to haveno effect. *start*01725 00024 USfReturn-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 26 OCT 88 13:21:48 PDTReceived: from A.ISI.EDU by SAIL.Stanford.EDU with TCP; 26 Oct 88  13:20:09 PDTDate: 26 Oct 88 16:19 EDTSender: ROSENKING@A.ISI.EDUSubject: Issue: CLOSED-STREAM-OPERATIONFrom: ROSENKING@A.ISI.EDUTo: cl-cleanup@SAIL.STANFORD.EDUMessage-ID: <[A.ISI.EDU]26-Oct-88 16:19:06.ROSENKING>Status:	DraftIssue:			CLOSED-STREAM-OPERATIONSReferences:		CLOSE (CLtL, page 332 and ANSI Draft, page 6-40)Category:		CLARIFICATIONEdit History:		26-Aug-88, 	Version 1 by Chapman			08-Oct-88, 	Version 2 by Masinter			26-Oct-88, 	Version 3 by RosenkingRelated Issues:	STREAM-CAPABILITIES, STREAM-ACCESS, STREAM-INFOProblem Description:Based on the type of stream, and the implementation used, when a stream is closed  using the close operation it may return one ofseveral different values, including the stream name or T, or evenan error if it was a broadcast or concatenated stream in the MACimplementation which was already closed.Proposal:Require that CLOSE return the stream name at all times, of the form #<stream>, and that it is an error to perform any operation on a closed stream.Rationale:This will standardize the use of CLOSE on all implementations and require that only streams which are not closed may be closed.Current Practice:Depending upon the type of stream and implementation a variety of values may be returned, as stated above.Adoption Cost:None.Benefits:This clarification will assist users in writing portable code.Conversion Cost:None.Aesthetics:NoneDiscussion:*start*00845 00024 USfReturn-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 26 OCT 88 18:39:44 PDTReceived: from STONY-BROOK.SCRC.Symbolics.COM (SCRC-STONY-BROOK.ARPA) by SAIL.Stanford.EDU with TCP; 26 Oct 88  18:37:27 PDTReceived: from EUPHRATES.SCRC.Symbolics.COM by STONY-BROOK.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 482693; Wed 26-Oct-88 21:37:42 EDTDate: Wed, 26 Oct 88 21:37 EDTFrom: David A. Moon <Moon@STONY-BROOK.SCRC.Symbolics.COM>Subject: Issue: CLOSED-STREAM-OPERATIONTo: ROSENKING@A.ISI.EDUcc: cl-cleanup@SAIL.STANFORD.EDUIn-Reply-To: <[A.ISI.EDU]26-Oct-88 16:19:06.ROSENKING>Message-ID: <19881027013729.5.MOON@EUPHRATES.SCRC.Symbolics.COM>There was already a version 3 by VanRoggen.  Is yours really version 4?*start*02364 00024 USfReturn-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 26 OCT 88 18:52:03 PDTReceived: from STONY-BROOK.SCRC.Symbolics.COM (SCRC-STONY-BROOK.ARPA) by SAIL.Stanford.EDU with TCP; 26 Oct 88  18:50:39 PDTReceived: from EUPHRATES.SCRC.Symbolics.COM by STONY-BROOK.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 482696; Wed 26-Oct-88 21:50:52 EDTDate: Wed, 26 Oct 88 21:50 EDTFrom: David A. Moon <Moon@STONY-BROOK.SCRC.Symbolics.COM>Subject: Issue: CLOSED-STREAM-OPERATIONS (version 4)To: ROSENKING@A.ISI.EDUcc: cl-cleanup@SAIL.STANFORD.EDUIn-Reply-To: <[A.ISI.EDU]26-Oct-88 16:19:06.ROSENKING>Message-ID: <19881027015040.6.MOON@EUPHRATES.SCRC.Symbolics.COM>Note that I have corrected the misspelled issue name in the subject,and guessed that the version was really 4 rather than 3.  Alwayshaving stylized subject lines, free of typos, helps everyone copewith the enormous flood of mail in CL-Cleanup.    Date: 26 Oct 1988 16:19-EDT    From: ROSENKING@A.ISI.EDU    Require that CLOSE return the stream name at all times, of the form     #<stream>, and that it is an error to perform any operation on a closed stream.The last clause clearly cannot work, since certain operations such asTRUENAME are only valid on output streams -after- the stream has beenclosed, in some file systems (ones with version numbers that don'tchoose the version until after the file has been closed, for example.)Similarly, FILE-WRITE-DATE on an open output stream is really onlymeaningful after the stream has been closed, since the buffer forcinginherent in CLOSE sets the write date in some file systems.Also it contradicts CLtL p.332, which says "certain inquiry operations"can be performed after a stream has been closed (unfortunately itneglects to say which).My point here is that this file system stuff requires careful consideration,because there is so much variation in file systems, which in most cases arenot under the control of the Lisp implementors.  If there is insufficienttime for careful consideration, I would rather see Common Lisp left deliberately ambiguous or underspecified in this area.  That would bepreferable to specifying something which cannot be implemented orwhich creates unanticipated problems.*start*01213 00024 USaReturn-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 27 OCT 88 09:50:20 PDTReceived: from STONY-BROOK.SCRC.Symbolics.COM (SCRC-STONY-BROOK.ARPA) by SAIL.Stanford.EDU with TCP; 27 Oct 88  09:47:50 PDTReceived: from EUPHRATES.SCRC.Symbolics.COM by STONY-BROOK.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 482983; Thu 27-Oct-88 12:48:00 EDTReturn-path: <ROSENKING@A.ISI.EDU>Received: from A.ISI.EDU by STONY-BROOK.SCRC.Symbolics.COM via INTERNET with SMTP id 482885; 27 Oct 88 09:54:14 EDTDate: 27 Oct 88 09:50 EDTSender: ROSENKING@A.ISI.EDUSubject: Re: Issue: CLOSED-STREAM-OPERATIONFrom: ROSENKING@A.ISI.EDUTo: Moon@SCRC-STONY-BROOK.ARPAMessage-ID: <[A.ISI.EDU]27-Oct-88 09:50:16.ROSENKING>In-Reply-To: <19881027013729.5.MOON@EUPHRATES.SCRC.Symbolics.COM>Resent-To: CL-Cleanup@sail.stanford.eduResent-From: David A. Moon <Moon@STONY-BROOK.SCRC.Symbolics.COM>Resent-Date: Thu, 27 Oct 88 12:47 EDTResent-Message-ID: <19881027164739.9.MOON@EUPHRATES.SCRC.Symbolics.COM>I was unaware of VanRoggen's or any other version after 2. My version isseparate and hopefully unique.*start*01126 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 30 NOV 88 12:01:03 PSTReceived: from Xerox.COM by SAIL.Stanford.EDU with TCP; 30 Nov 88  11:58:48 PSTReceived: from Cabernet.ms by ArpaGateway.ms ; 30 NOV 88 11:31:31 PSTDate: 30 Nov 88 11:12 PSTFrom: masinter.paSubject: Re: Issue: CLOSED-STREAM-OPERATIONS (Versions 3vR, 3R, 4)In-reply-to: ROSENKING@A.ISI.EDU's message of 27 Oct 88 09:50 EDTTo: ROSENKING@A.ISI.EDUcc: cl-cleanup@sail.stanford.eduMessage-ID: <881130-113131-2391@Xerox>I'm sorry that you didn't get a copy of Walter's version 3. I am forwardingto you in a separate message all of the relevant mail on the topic thatdidn't explicitly include you in the cc list. (I guess we had no warningthat you were preparing a version 3.) You say "My version is separate and hopefully unique."I don't hope forunique versions; I hope for merged ones. Are you dissastified with Version4? (Frankly, I have not taken the time to review the differences betweenthe various versions.)*start*01355 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 30 NOV 88 12:22:13 PSTReceived: from Xerox.COM by SAIL.Stanford.EDU with TCP; 30 Nov 88  11:58:52 PSTReceived: from Semillon.ms by ArpaGateway.ms ; 30 NOV 88 11:56:41 PSTDate: 30 Nov 88 11:30 PSTFrom: masinter.paSubject: Re: Issue: CLOSED-STREAM-OPERATIONS (Versions 3vR, 3R)In-reply-to: ROSENKING@A.ISI.EDU's message of 27 Oct 88 09:50 EDTTo: ROSENKING@A.ISI.EDUcc: cl-cleanup@sail.stanford.eduMessage-ID: <881130-115641-2461@Xerox><<I thought for a minute that David Moon had actually produced a newversion 4, but I was mistaken; this message supersedes the previous one "Re: Issue: CLOSED-STREAM-OPERATIONS (Versions 3vR, 3R, 4)">>I'm sorry that you didn't get a copy of Walter's version 3. I haveforwarded to you, in a separate message, all of the relevant mail on thetopic that didn't explicitly include you in the cc list. (I guess we had nowarning that you were preparing a version 3.) You say "My version is separate and hopefully unique."I don't hope forunique versions; I hope for merged ones. Are you dissastified with Waltervan Roggen's Version 3? (Frankly, I have not taken the time to review thedifferences between the various versions.)*start*07873 00024 USfReturn-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 01 DEC 88 15:21:49 PSTReceived: from argus.stanford.edu by SAIL.Stanford.EDU with TCP; 1 Dec 88  15:20:01 PSTReceived: from Riverside.SCRC.Symbolics.COM (SCRC-RIVERSIDE.ARPA) by argus.stanford.edu with TCP; Thu, 1 Dec 88 15:12:32 PSTReceived: from BOBOLINK.SCRC.Symbolics.COM by Riverside.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 297792; Thu 1-Dec-88 15:20:35 ESTDate: Thu, 1 Dec 88 15:21 ESTFrom: Kent M Pitman <KMP@stony-brook.scrc.symbolics.com>Subject: Issue: CLOSED-STREAM-OPERATIONS (Version 4)To: CL-Cleanup@sail.stanford.eduMessage-Id: <881201152112.4.KMP@BOBOLINK.SCRC.Symbolics.COM>Ok, here's what I did in the proposal below: * Changes to proposal    - Elaborate on each issue. Say more than just "is valid".      Hopefully this will make any need for line-item veto easier.    - I changed the treatment of INPUT-STREAM-P and OUTPUT-STREAM-P      because I couldn't live with claiming that a closed stream was      no longer of the same type. (This is like saying that a dead      man is neither man nor woman. I've never bought into this      nonsense. You never know when you'll find out they were only       faking and there's no sense in revising your entire belief      system just to accomodate a bit which is really orthogonal.)      If Masinter thinks it's useful to be able to detect that these      streams can't have I/O done to them, I'm ammenable to adding      an OPEN-STREAM-P primitive.    - I clarified the treatment of PATHNAME and friends in a way      that might not have been compatible.   In general, read the Proposal carefully with a fresh eye. * Very minor cosmetic reformatting to most of sections. With the   exception of Aesthetics, where I turned "Yes" into a full sentence,   I didn't change the actual wording of any of other sections.-----Issue:          CLOSED-STREAM-OPERATIONSReferences:     CLOSE (CLtL p 332)Category:       CLARIFICATIONEdit history:   26-Aug-88, Version 1 by Chapman                 8-Oct-88, Version 2 by Masinter                13-Oct-88, Version 3 by van Roggen	         1-Dec-88, Version 4 by PitmanRelated Issues: STREAM-ACCESS, STREAM-INFOStatus:         For Internal Discussion Problem Description:  The description of CLOSE is not completely clear about the functions which are allowed to be performed on a closed stream.  On p332 it says:  ``The stream is closed. No further Input/output operations may be    performed on it. However, certain inquiry operations may still    be performed, ...''  but the list of inquiry operations is not specified.   At least one implementation interpreted the list to include at least  OUTPUT-STREAM-P, while another has disallowed that operation to be  performed on a closed stream.  Proposal (CLOSED-STREAM-FUNCTIONS:ALLOW-INQUIRY)  Clarify the behavior of the following functions on closed streams:  * STREAMP is unaffected by whether its stream argument is open or closed.   * INPUT-STREAM-P and OUTPUT-STREAM-P are unaffected by whether their    stream arguments are open or closed.     This is not the same as saying that once a stream is determined to be    an input-stream, it will always be. For example, if an implementation    provides an implementation-specific way to change the direction of a    stream, that implementation-dependent code may affect the output of    these functions. Similarly, in implementations where it is possible to    re-open a closed stream in some ways, the effect of so doing is not    prohibited from opening the stream with different direction, etc.    However, as long as only Common Lisp functions are used, INPUT-STREAM-P    and OUTPUT-STREAM-P of a stream will remain constant over time.   * If CLOSE is called on a stream which is open, it will return T.    However, if CLOSE is called on a stream which is closed, it    will succeed without error but the return value is not specified.   * PATHNAME is valid on either an open or closed stream. Since some    implementations cannot provide the truename of a file until the    file is closed, it would in principle be possible for PATHNAME in    some implementations to return more specific information after the    stream is closed. For consistency, however, PATHNAME is prohibited    from doing this. PATHNAME (which is valid only on file streams, of    course) must return the same pathname after a file is closed as it    did before.   * TRUENAME is valid on either an open or closed stream. Since some    implementations cannot provide the truename of a file until the    file is closed, it is permissible TRUENAME to return more specific    information after the stream is closed.   * MERGE-PATHNAMES, PATHNAME-HOST, PATHNAME-DEVICE, PATHNAME-DIRECTORY,    PATHNAME-NAME, PATHNAME-TYPE, PATHNAME-VERSION, NAMESTRING,     FILE-NAMESTRING, DIRECTORY-NAMESTRING, HOST-NAMESTRING,     ENOUGH-NAMESTRING, and OPEN are valid on either open or closed streams.    For any of these operations, using a stream, S, as an argument     where appropriate is equivalent to using (PATHNAME s). See the    description of PATHNAME above to understand the consequences of this.   * PROBE-FILE and DIRECTORY are valid on either open or closed streams.    For either of these operations, using a stream, S, as an argument     where appropriate is equivalent to using (PATHNAME s). See the    description of PATHNAME above to understand the consequences of this.    In this case of these operators however, closed stream may well be the    most reliable arguments in some cases, since treatment of open streams    to the file system may vary considerably between implementations.    For example, in some operating systems, open files are written under    temporary names and not renamed until close and/or are held invisible    until a close is performed. In general, any code with an intent to be    highly portable should tread lightly when using PROBE-FILE or    DIRECTORY.   * If proposal STREAM-ACCESS:PROVIDE is adopted, all of its functions    will work on closed streams. That is, the effect of calling any of    the operations introduced by that proposal on a stream is the same    whether the stream is open or closed.   * If proposal STREAM-INFO:ONE-DIMENSIONAL-FUNCTIONS is adopted, none    of its functions are required to work on closed streams. That is,    the effect of calling any of the operations introduced by that     proposal on a closed stream is undefined.Rationale:  One can consider many characteristics of a stream to be independent of the ability to do I/O.  Being able to determine a stream's direction and its name is often useful for debugging.  A number of the descriptions in CLtL imply (weakly) the ability to work on closed streams.  Functions such as OPEN and DIRECTORY don't really depend on the stream, but on the name of the stream. Current Practice:  At least two implementations differ in which functions are allowed to be performed on a closed stream. Cost to Implementors:  Unknown, but likely to be small in most implementations. A nontrivial amount of work may be necessary if the pathname information is held  externally and is normally deleted when the stream is closed.  The implementation will have to copy the information at some time for later inquiries.Cost to Users: None. Benefits:  These clarifications will assist users in writing portable code. Aesthetics:  Most people will probably see these clarifications as an improvement in aesthetics. Discussion: There are some separate, but related, issues regarding what CLOSE should do on composite streams or constructed streams.*start*01193 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 01 DEC 88 17:12:06 PSTReceived: from Xerox.COM by SAIL.Stanford.EDU with TCP; 1 Dec 88  17:09:51 PSTReceived: from Cabernet.ms by ArpaGateway.ms ; 01 DEC 88 16:58:43 PSTDate: 1 Dec 88 16:58 PSTFrom: masinter.paSubject: Re: Issue: CLOSED-STREAM-OPERATIONS (Version 4)In-reply-to: Kent M Pitman <KMP@stony-brook.scrc.symbolics.com>'s message of Thu, 1 Dec 88 15:21 ESTTo: Kent M Pitman <KMP@stony-brook.scrc.symbolics.com>cc: CL-Cleanup@sail.stanford.eduMessage-ID: <881201-165843-5438@Xerox>In the implementations I've been most familiar with, INPUT-STREAM-P andOUTPUT-STREAM-P are predicates on state rather than on "class". That is, a "stream" can have one of several states: closed, open for input,open for output, open for both input/output.CLOSE transitions a stream from one of the "open" states to one to theclosed state.Well, anyway, that's how I think of it. In Interlisp, OPENP was thepredicate, you could ask just (OPENP x) or (OPENP x 'INPUT) or (OPENP X'OUTPUT) or (OPENP X 'BOTH).*start*02274 00024 US Return-Path: <KMP@STONY-BROOK.SCRC.Symbolics.COM>Received: from STONY-BROOK.SCRC.Symbolics.COM ([128.81.41.144]) by Xerox.COM ; 01 DEC 88 17:41:10 PSTReceived: from BOBOLINK.SCRC.Symbolics.COM by STONY-BROOK.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 501451; Thu 1-Dec-88 20:41:44 ESTDate: Thu, 1 Dec 88 20:41 ESTFrom: Kent M Pitman <KMP@STONY-BROOK.SCRC.Symbolics.COM>Subject: Re: Issue: CLOSED-STREAM-OPERATIONS (Version 4)To: Masinter.PAcc: CL-Cleanup@SAIL.Stanford.EDUIn-Reply-To: <881201-165843-5438@Xerox>Message-ID: <881201204134.4.KMP@BOBOLINK.SCRC.Symbolics.COM>I'm probably at least as uncomfortable with your way of thinking about it asyou are with mine. However, I think they're both fairly arbitrary positionswhich can only be successfully argued for in terms of some set of pragmaticdetails which may vary between your environment and mine.I recommend, therefore, that we introduce OPEN-STREAM-P to detect whether astream is open, because I think we can agree on that much. I think we shouldsay that OPEN makes a stream which is open, that CLOSE closes a stream ifit's meaningful to do that -- we can probably define that for particular kindsof streams, like file streams, that it really must do a close while leavinganything we're unsure of undefined. OPEN-STREAM-P would not be a way to tellwhether CLOSE had been called, but rather whether open-stream operations werepermissible.Having OPEN-STREAM-P, I think the appropriate compromise to satisfy both yourculture and mine is to say that calling INPUT-STREAM-P and OUTPUT-STREAM-Pon a closed stream will return an undefined value (actually, we can even saythat the value will be one of T or NIL -- but we cannot be more specific aboutwhen it will be what, since we leave this up to an implementation). We shouldmake clear that the rationale is that there are different models of what closed stream direction is, which we have no reason to violate because inpractice there is no useful Common Lisp program which we anticipate being ableto write based on such a distinction given the existing primitives, and sothere's no reason to force implementations to gratuitously agree.If this is acceptable, and you want me to draft it up, let me know.*start*00787 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 02 DEC 88 10:21:15 PSTReceived: from Xerox.COM by SAIL.Stanford.EDU with TCP; 2 Dec 88  10:13:58 PSTReceived: from Semillon.ms by ArpaGateway.ms ; 02 DEC 88 09:46:10 PSTDate: 2 Dec 88 09:45 PSTFrom: masinter.paSubject: Re: Issue: CLOSED-STREAM-OPERATIONS (Version 4)In-reply-to: Kent M Pitman <KMP@STONY-BROOK.SCRC.Symbolics.COM>'s message of Fri, 2 Dec 88 05:35 ESTTo: Kent M Pitman <KMP@STONY-BROOK.SCRC.Symbolics.COM>cc: gsb@ALDERAAN.SCRC.Symbolics.COM, CL-Cleanup@SAIL.Stanford.EDUMessage-ID: <881202-094610-1204@Xerox>The proposal to add OPEN-STREAM-P is part of another issue, STREAM-ACCESS.*start*02268 00024 USaReturn-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 02 DEC 88 02:36:15 PSTReceived: from STONY-BROOK.SCRC.Symbolics.COM (SCRC-STONY-BROOK.ARPA) by SAIL.Stanford.EDU with TCP; 2 Dec 88  02:35:23 PSTReceived: from BOBOLINK.SCRC.Symbolics.COM by STONY-BROOK.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 501651; Fri 2-Dec-88 05:35:13 ESTDate: Fri, 2 Dec 88 05:35 ESTFrom: Kent M Pitman <KMP@STONY-BROOK.SCRC.Symbolics.COM>Subject: Re: Issue: CLOSED-STREAM-OPERATIONS (Version 4)To: gsb@ALDERAAN.SCRC.Symbolics.COMcc: CL-Cleanup@SAIL.Stanford.EDUIn-Reply-To: <19881202043914.5.GSB@GANG-GANG.SCRC.Symbolics.COM>Message-ID: <881202053502.0.KMP@BOBOLINK.SCRC.Symbolics.COM>[Added CL-Cleanup back.]    Date: Thu, 1 Dec 88 23:39 EST    From: Glenn S. Burke <gsb@ALDERAAN.SCRC.Symbolics.COM>    Subject: Re: Issue: CLOSED-STREAM-OPERATIONS (Version 4)    To: KMP@STONY-BROOK.SCRC.Symbolics.COM    In-Reply-To: <881201204134.4.KMP@BOBOLINK.SCRC.Symbolics.COM>    ... Keep in mind whatever things go on with the "aggregate" streams,    e.g. bidirectional in particular might have semantic problems with    open-stream-p. ...Actually, in Masinter's approach, you have the inverse problem withINPUT-STREAM-P. What does it return on an aggregrate output streamwhen some of the streams are closed and some are not.On the basis of this, I retract my previous suggestion that we getinvolved in OPEN-STREAM-P, and instead suggest that we just sayit's an error to call INPUT-STREAM-P or OUTPUT-STREAM-P (or WRITE or ...)on any stream which has been closed or on any aggregrate streamfor which a component stream has been closed. People won't be able topredicate this at runtime -- they'll just have to watch their controlflow and not let one of these things get into the hands of CLOSE.I guess that correctly sums up the status quo, so it can't be anyworse than what we've got now. And what we have now isn't that bad --every now and then someone complains that they wish they could tell ifa stream is open, but I've generally been able to look at their code andshow them how to rewrite it so that the issue didn't come up.*start*16736 00024 USaDate: 30 Nov 88 11:10 PSTFrom: masinter.paSubject: [vanroggen%aitg.DEC@decwrl.dec.com: Issue: CLOSED-STREAM-OPERATIONS (version 3)]To: ROSENKING@A.ISI.EDUcc: masinter.paI'm sorry you didn't get this mail.     ----- Begin Forwarded Messages -----Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 13 OCT 88 12:00:34 PDTReceived: from decwrl.dec.com by SAIL.Stanford.EDU with TCP; 13 Oct 88  12:00:37 PDTReceived: by decwrl.dec.com (5.54.5/4.7.34)	id AA13409; Thu, 13 Oct 88 11:58:56 PDTDate: Thu, 13 Oct 88 11:58:56 PDTMessage-Id: <8810131858.AA13409@decwrl.dec.com>From: vanroggen%aitg.DEC@decwrl.dec.comTo: cl-cleanup@sail.stanford.eduSubject: Issue: CLOSED-STREAM-OPERATIONS (version 3)Status: DRAFTIssue:        CLOSED-STREAM-OPERATIONSReferences:   CLOSE (CLtL p 332)Category:     CLARIFICATIONEdit history: 26-Aug-88, Version 1 by Chapman               8-Oct-88, Version 2 by Masinter              13-Oct-88, Version 3 by van Roggen Related Issues: STREAM-ACCESS, STREAM-INFO  Problem Description: The description of CLOSE is not completely clear about the functionswhich are allowed to be performed on a closed stream. On p332 it says:	"The stream is closed. No further Input/output operations may be	performed on it. However, certain inquiry operations may still	be performed, ..."but the list of inquiry operations is not specified. At least one implementation interpreted the list to includeat least OUTPUT-STREAM-P, while another has disallowed that operationto be performed on a closed stream.  Proposal (CLOSED-STREAM-FUNCTIONS:ALLOW-INQUIRY) Clarify that one may call the following functions on closed streams withouterror due to the stream being closed:  STREAMP, INPUT-STREAM-P, OUTPUT-STREAM-P, CLOSE, PATHNAME, TRUENAME,  MERGE-PATHNAMES, PATHNAME-HOST, PATHNAME-DEVICE, PATHNAME-DIRECTORY,  PATHNAME-NAME, PATHNAME-TYPE, PATHNAME-VERSION, NAMESTRING, FILE-NAMESTRING,  DIRECTORY-NAMESTRING, HOST-NAMESTRING, ENOUGH-NAMESTRING, OPEN,  PROBE-FILE, DIRECTORYIf proposal STREAM-ACCESS:PROVIDE is adopted, all of its functions will workon closed streams.If proposal STREAM-INFO:ONE-DIMENSIONAL-FUNCTIONS is adopted, none of itsfunctions are required to work on closed streams. Rationale: One can consider many characteristics of a stream to be independent ofthe ability to do I/O.  Being able to determine a stream's direction andits name is often useful for debugging.  A number of the descriptions inCLtL imply (weakly) the ability to work on closed streams.  Functionssuch as OPEN and DIRECTORY don't really depend on the stream, but onthe name of the stream. Current Practice: At least two implementations differ in which functions are allowed to beperformed on a closed stream. Cost to Implementors: Unknown, but likely to be small in most implementations.  A nontrivialamount of work may be necessary if the pathname information is heldexternally and is normally deleted when the stream is closed.  Theimplementation will have to copy the information at some time for laterinquiries.Cost to Users:None. Benefits: This clarification will assist users in writing portable code. Aesthetics: Yes. Discussion:There are some separate, but related, issues regarding what CLOSE shoulddo on composite streams or constructed streams.     ----- Next Message -----Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 13 OCT 88 12:46:23 PDTReceived: from STONY-BROOK.SCRC.Symbolics.COM (SCRC-STONY-BROOK.ARPA) by SAIL.Stanford.EDU with TCP; 13 Oct 88  12:46:38 PDTReceived: from BOBOLINK.SCRC.Symbolics.COM by STONY-BROOK.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 475724; Thu 13-Oct-88 15:45:08 EDTDate: Thu, 13 Oct 88 15:44 EDTFrom: Kent M Pitman <KMP@STONY-BROOK.SCRC.Symbolics.COM>Subject: Issue: CLOSED-STREAM-OPERATIONS (Version 2)To: CL-Cleanup@SAIL.Stanford.EDUMessage-ID: <881013154459.5.KMP@BOBOLINK.SCRC.Symbolics.COM>My notes from Fairfax meeting...Cleanup meeting: Responsibility for this issue was delegated to Jim Allard (@Gensym) and Dan Pierson.X3J13 meeting: RWK: Existing propsoal maximizes incompatibilty      [Barmar pointed out that this proposal doesn't force implementors       to change -- it just points out what's portable. KMP agrees but       doesn't know for sure if RWK bought this argument. In any case,       the point should be clarified to avoid further discussion.]     ----- Next Message -----Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 17 OCT 88 10:07:35 PDTReceived: from multimax.ARPA by SAIL.Stanford.EDU with TCP; 17 Oct 88  10:03:13 PDTReceived:  by multimax.ARPA (5.51/25-eef)	id AA00771; Mon, 17 Oct 88 13:02:12 EDTReceived: from localhost by mist.UUCP (3.2/4.7)	id AA11549; Mon, 17 Oct 88 12:16:30 EDTMessage-Id: <8810171616.AA11549@mist.UUCP>To: "vanroggen%aitg.DEC@decwrl.dec.com"@MULTIMAX.ENCORE.COMCc: cl-cleanup%sail.stanford.edu@MULTIMAX.ENCORE.COMSubject: Re: Issue: CLOSED-STREAM-OPERATIONS (version 3) In-Reply-To: Your message of Thu, 13 Oct 88 11:58:56 -0700.             <8810131858.AA13409@decwrl.dec.com> Date: Mon, 17 Oct 88 12:16:28 EDTFrom: Dan L. Pierson <pierson%mist@MULTIMAX.ENCORE.COM>Thanks Walter.  Since this looks good at a first glance, I'm notplanning another writeup.     ----- Next Message -----Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 17 OCT 88 12:15:03 PDTReceived: from STONY-BROOK.SCRC.Symbolics.COM (SCRC-STONY-BROOK.ARPA) by SAIL.Stanford.EDU with TCP; 17 Oct 88  12:13:07 PDTReceived: from BOBOLINK.SCRC.Symbolics.COM by STONY-BROOK.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 477479; Mon 17-Oct-88 15:11:57 EDTDate: Mon, 17 Oct 88 15:11 EDTFrom: Kent M Pitman <KMP@STONY-BROOK.SCRC.Symbolics.COM>Subject: Issue: CLOSED-STREAM-OPERATIONS (version 3)To: vanroggen%aitg.DEC@decwrl.dec.comcc: CL-Cleanup@SAIL.Stanford.EDUIn-Reply-To: <8810131858.AA13409@decwrl.dec.com>Message-ID: <881017151141.7.KMP@BOBOLINK.SCRC.Symbolics.COM>    Date: Thu, 13 Oct 88 11:58:56 PDT    From: vanroggen%aitg.DEC@decwrl.dec.com    ...    Issue:        CLOSED-STREAM-OPERATIONS    ...     Proposal (CLOSED-STREAM-FUNCTIONS:ALLOW-INQUIRY)     Clarify that one may call the following functions on closed streams without    error due to the stream being closed:This is not the same as saying they will continue to return the same values.For example... - perhaps CLOSE on a closed stream should return NIL, not T.  - perhaps some implementations would want INPUT-STREAM-P of closed streams to be NIL.   i think there's no good reason to have that be so, but it's an issue that would   have to be resolved and implementations would likely diverge in the absence of info   so it could lead to portability troubles if we don't clarify that if a stream was   INPUT-STREAM-P when open, it will be when closed, too. [we might acknowledge the   possibilty that a stream could be `re-opened' in an implementation-specific way,   in which case the way this function operated could change.]    (SETQ S (OPEN "file" :DIRECTION :INPUT))    (INPUT-STREAM-P S) => T    (CLOSE S) => T    (CLOSE S) => T ;NIL?    (INPUT-STREAM-P S) => T    (OPEN S :DIRECTION :OUTPUT) => ??    (INPUT-STREAM-P S) => ?? - I could imagine the pathname information for a pathname wanting to change from   the opened name to the truename upon close. eg, if you open .NEWEST, you might   know the truename only after you close. TRUENAME might therefore want to return   something different after CLOSE. Whether it should be permitted is something   -we- should decide, not something we should leave up to implementors ... at least   not without making it explicit that we're doing so. - Gack. I never noticed that PATHNAME-VERSION could be called on a stream. Hmmmm.   Same comment as for TRUENAME, I guess. - The interaction of DIRECTORY is particularly interesting. Even if the truename   does not change, some file systems will treat DIRECTORY of foo.lisp.newest   differently depending on whether the stream to that file is still open. Some can   tell you the file is there but it's still open, while others will not admit its   existence until it's closed. I don't think we can get away without saying   something about this.Any operation for which the level of well-definedness of its meaning is not preservedby CLOSE is at least a candidate for making an out-and-out error since the behaviorafter CLOSE will not be portably defined. Actually, we can probably say "unspecified"in most cases rather than "undefined" since we can say the behavior is harmless, butit just may not be particularly meaningful...     ----- Next Message -----Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 17 OCT 88 12:37:01 PDTReceived: from decwrl.dec.com by SAIL.Stanford.EDU with TCP; 17 Oct 88  12:35:42 PDTReceived: by decwrl.dec.com (5.54.5/4.7.34)	id AA24044; Mon, 17 Oct 88 12:34:44 PDTDate: Mon, 17 Oct 88 12:34:44 PDTMessage-Id: <8810171934.AA24044@decwrl.dec.com>From: vanroggen%aitg.DEC@decwrl.dec.comTo: KMP@stony-brook.scrc.symbolics.comSubject: RE: Issue: CLOSED-STREAM-OPERATIONS (version 3)The problems you mention are part of the reason Kathy and I originallyproposed the "can't-do-anything-on-closed-streams" version of thisproposal.  (Although I hadn't included STREAMP in the list of can't-do's,since I hadn't thought of that predicate originally.)Anyone else have any comments?  I don't want to spend too much time on thisissue.     ----- Next Message -----Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 25 OCT 88 16:33:40 PDTReceived: from Xerox.COM by SAIL.Stanford.EDU with TCP; 25 Oct 88  16:32:03 PDTReceived: from Semillon.ms by ArpaGateway.ms ; 25 OCT 88 16:31:40 PDTDate: 25 Oct 88 16:31 PDTFrom: masinter.paSubject: RE: Issue: CLOSED-STREAM-OPERATIONS (version 3)In-reply-to: vanroggen%aitg.DEC@decwrl.dec.com's message of Mon, 17 Oct 88 12:34:44 PDTTo: vanroggen%aitg.DEC@decwrl.dec.comcc: cl-cleanup@sail.stanford.eduMessage-ID: <881025-163140-12090@Xerox>I think the goal is to standardly allow those operations that are usuallyimplemented and are useful.I thus think it is useful to address explicitly the questions Kent asks --I don't think we can or should finess them.I would prefer INPUT-STREAM-P and OUTPUT-STREAM-P to return false forstreams which do not admit input or output respectively, which, I think,includes closed streams.So:After a stream has been closed:(STREAMP closed-stream)	returns true(INPUT-STREAM-P closed-stream) returns false(OUTPUT-STREAM-P closed-stream) returns false(CLOSE stream) returns NIL (?)All of the other functions in the list are the ones that that accept astream and coerce it to a pathname work at least as specifically as theywould with the open stream. (This is subject to some further work on thepathname functions; the idea is that once the stream is CLOSEd that thestream object may have *more* specific pathname information associated withit than before, and that in some way the pathname used should bebest-effort name to get at the same data. )The point here is that if I want to write out some data and read it back inlater, I should be able to(let((saved-file (pathname (with-open-file (x pathname :direction :output)(print stuff x) x))))   (with-open-file (x saved-file :direction :input)       (read x)))and expect the second with-open-file to get at the same data that the firstone wrote.The operation of CLOSE on constructed streams (as constructed withWITH-OUTPUT-TO-STRING or MAKE-BROADCAST-STREAM) should be specified to haveno effect.      ----- Next Message -----Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 26 OCT 88 13:21:48 PDTReceived: from A.ISI.EDU by SAIL.Stanford.EDU with TCP; 26 Oct 88  13:20:09 PDTDate: 26 Oct 88 16:19 EDTSender: ROSENKING@A.ISI.EDUSubject: Issue: CLOSED-STREAM-OPERATIONFrom: ROSENKING@A.ISI.EDUTo: cl-cleanup@SAIL.STANFORD.EDUMessage-ID: <[A.ISI.EDU]26-Oct-88 16:19:06.ROSENKING>Status:	DraftIssue:			CLOSED-STREAM-OPERATIONSReferences:		CLOSE (CLtL, page 332 and ANSI Draft, page 6-40)Category:		CLARIFICATIONEdit History:		26-Aug-88, 	Version 1 by Chapman			08-Oct-88, 	Version 2 by Masinter			26-Oct-88, 	Version 3 by RosenkingRelated Issues:	STREAM-CAPABILITIES, STREAM-ACCESS, STREAM-INFOProblem Description:Based on the type of stream, and the implementation used, when a stream is closed  using the close operation it may return one ofseveral different values, including the stream name or T, or evenan error if it was a broadcast or concatenated stream in the MACimplementation which was already closed.Proposal:Require that CLOSE return the stream name at all times, of the form #<stream>, and that it is an error to perform any operation on a closed stream.Rationale:This will standardize the use of CLOSE on all implementations and require that only streams which are not closed may be closed.Current Practice:Depending upon the type of stream and implementation a variety of values may be returned, as stated above.Adoption Cost:None.Benefits:This clarification will assist users in writing portable code.Conversion Cost:None.Aesthetics:NoneDiscussion:     ----- Next Message -----Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 26 OCT 88 18:39:44 PDTReceived: from STONY-BROOK.SCRC.Symbolics.COM (SCRC-STONY-BROOK.ARPA) by SAIL.Stanford.EDU with TCP; 26 Oct 88  18:37:27 PDTReceived: from EUPHRATES.SCRC.Symbolics.COM by STONY-BROOK.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 482693; Wed 26-Oct-88 21:37:42 EDTDate: Wed, 26 Oct 88 21:37 EDTFrom: David A. Moon <Moon@STONY-BROOK.SCRC.Symbolics.COM>Subject: Issue: CLOSED-STREAM-OPERATIONTo: ROSENKING@A.ISI.EDUcc: cl-cleanup@SAIL.STANFORD.EDUIn-Reply-To: <[A.ISI.EDU]26-Oct-88 16:19:06.ROSENKING>Message-ID: <19881027013729.5.MOON@EUPHRATES.SCRC.Symbolics.COM>There was already a version 3 by VanRoggen.  Is yours really version 4?     ----- Next Message -----Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 26 OCT 88 18:52:03 PDTReceived: from STONY-BROOK.SCRC.Symbolics.COM (SCRC-STONY-BROOK.ARPA) by SAIL.Stanford.EDU with TCP; 26 Oct 88  18:50:39 PDTReceived: from EUPHRATES.SCRC.Symbolics.COM by STONY-BROOK.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 482696; Wed 26-Oct-88 21:50:52 EDTDate: Wed, 26 Oct 88 21:50 EDTFrom: David A. Moon <Moon@STONY-BROOK.SCRC.Symbolics.COM>Subject: Issue: CLOSED-STREAM-OPERATIONS (version 4)To: ROSENKING@A.ISI.EDUcc: cl-cleanup@SAIL.STANFORD.EDUIn-Reply-To: <[A.ISI.EDU]26-Oct-88 16:19:06.ROSENKING>Message-ID: <19881027015040.6.MOON@EU*start*01093 00024 US Return-Path: <ROSENKING@A.ISI.EDU>Received: from A.ISI.EDU ([26.3.0.103]) by Xerox.COM ; 02 DEC 88 14:02:41 PSTDate: 2 Dec 88 17:00 ESTSender: ROSENKING@A.ISI.EDUSubject: Re: [vanroggen%aitg.DEC@decwrl.dec.com: Issue:...From: ROSENKING@A.ISI.EDUTo: masinter.paMessage-ID: <[A.ISI.EDU] 2-Dec-88 17:00:26.ROSENKING>In-Reply-To: <881130-111726-2365@Xerox>I agree with Walter's proposal, which negates the last clause in myproposal which Moon also said would not work. I accept this and agree with the list of appropriate functions which Walter has specified.There is still one issue which needs to be resolved, and this is statedin the first part of my proposal. I proposed that CLOSE be required toreturn the stream name of the form #<stream>, when it is appropriate forit to be called. This will satisfy the people who want a non-NIL value tobe returned and it will also provide the stream name for those who maywant to use it.Finally, in reaction to your original comment to me, this is a mergedand slightly extended version of CLOSE.   - Jeff*start*06108 00024 USfDate:  5 Dec 88 12:25 PSTSender: masinter.paSubject: Issue: CLOSED-STREAM-OPERATIONS (Version 4)To: X3J13@sail.stanford.eduFrom: CL-CLEANUP@Sail.Stanford.EduReply-to: CL-CLEANUP@Sail.Stanford.Educc: MasinterLine-fold: NOSome parts of the original issue were separated out as we havenot yet arrived at a recommendation.Forum:          CleanupIssue:          CLOSED-STREAM-OPERATIONSReferences:     CLOSE (CLtL p 332)Category:       CLARIFICATIONEdit history:   26-Aug-88, Version 1 by Chapman                 8-Oct-88, Version 2 by Masinter                13-Oct-88, Version 3 by van Roggen                 1-Dec-88, Version 4 by Pitman                 5-Dec-88, Version 5 by Masinter (separate other issues)Related Issues: STREAM-ACCESS, STREAM-INFO, INPUT-STREAM-P-CLOSED,			CLOSE-CONSTRUCTED-STREAMS, PATHNAME-STREAM Problem Description:  The description of CLOSE is not completely clear about the functions which are allowed to be performed on a closed stream.  On p332 it says:  ``The stream is closed. No further Input/output operations may be    performed on it. However, certain inquiry operations may still    be performed, ...''  but the list of inquiry operations is not specified. Proposal (CLOSED-STREAM-FUNCTIONS:ALLOW-INQUIRY)  Clarify the behavior of the following functions on closed streams:  * STREAMP is unaffected by whether its stream argument is open or closed.   * If CLOSE is called on a stream which is open, it will return T.    However, if CLOSE is called on a stream which is closed, it    will succeed without error but the return value is not specified.   * PATHNAME is valid on either an open or closed stream. Since some    implementations cannot provide the truename of a file until the    file is closed, it would in principle be possible for PATHNAME in    some implementations to return more specific information after the    stream is closed. For consistency, however, PATHNAME is prohibited    from doing this. PATHNAME must return the same pathname after a    file is closed as it did before. (The passed proposal in issue    PATHNAME-STREAM still stands.)   * TRUENAME is valid on either an open or closed stream. Since some    implementations cannot provide the truename of a file until the    file is closed, it is permissible TRUENAME to return more specific    information after the stream is closed.   * MERGE-PATHNAMES, PATHNAME-HOST, PATHNAME-DEVICE, PATHNAME-DIRECTORY,    PATHNAME-NAME, PATHNAME-TYPE, PATHNAME-VERSION, NAMESTRING,     FILE-NAMESTRING, DIRECTORY-NAMESTRING, HOST-NAMESTRING,     ENOUGH-NAMESTRING, and OPEN are valid on either open or closed streams.    For any of these operations, using a stream, S, as an argument     where appropriate is equivalent to using (PATHNAME s). See the    description of PATHNAME above to understand the consequences of this.   * PROBE-FILE and DIRECTORY are valid on either open or closed streams.    For either of these operations, using a stream, S, as an argument     where appropriate is equivalent to using (PATHNAME s). See the    description of PATHNAME above to understand the consequences of this.    In this case of these operators however, closed stream may well be the    most reliable arguments in some cases, since treatment of open streams    to the file system may vary considerably between implementations.    For example, in some operating systems, open files are written under    temporary names and not renamed until close and/or are held invisible    until a close is performed. In general, any code with an intent to be    highly portable should tread lightly when using PROBE-FILE or    DIRECTORY. Rationale:  One can consider many characteristics of a stream to be independent of the ability to do I/O.  Being able to determine a stream's direction and its name is often useful for debugging.  A number of the descriptions in CLtL imply (weakly) the ability to work on closed streams.  Functions such as OPEN and DIRECTORY don't really depend on the stream, but on the name of the stream. Current Practice:  At least two implementations differ in which functions are allowed to be performed on a closed stream. Cost to Implementors:  Unknown, but likely to be small in most implementations. A nontrivial amount of work may be necessary if the pathname information is held  externally and is normally deleted when the stream is closed.  The implementation will have to copy the information at some time for later inquiries.Cost to Users: Likely to be small; users of an implementation forced to change by this proposal might have to make some modifications to make their programs portable. Benefits:  These clarifications will assist users in writing portable code. Aesthetics:  Most people will probably see these clarifications as an improvement in aesthetics. Discussion: There are some separate, but related, issues regarding what CLOSE should do on composite streams or constructed streams such as created by MAKE-BROADCAST-STREAM. These issues will be addressed in a separate issue (CLOSE-CONSTRUCTED-STREAMS). There was some discussion on whether INPUT-STREAM-P and OUTPUT-STREAM-P should return "false" on a stream that had been closed. The issue STREAM-ACCESS contains a proposal to add a function OPEN-STREAM-P which might be useful for the same purpose. This issue was separated out into a separate issue (INPUT-STREAM-P-CLOSED). The other functions in proposal STREAM-ACCESS:PROVIDE should work on closed streams. The functions in STREAM-INFO:ONE-DIMENSIONAL-FUNCTIONS should not be requred to work on closed streams.        TITAN 
         TITAN 
         ; -(TEXTFONT 7 (TIMESROMAN 12) NIL (CLASSIC 10))           L                                                                                    c             m       1      	w                           m             *                     
       F              Z                   < z*start*06229 00024 US Date:  3 Feb 89 22:41 PSTFrom: masinter.paSubject: Issue: CLOSED-STREAM-OPERATIONS (Version 6)To: cl-cleanup@sail.stanford.educc: MasinterLine-fold: NOAt the January meeting, my notes are only "amended to return Ton closed streams" without an exact wording change. This is the issue as reworded. Do you see any need to remailthis to X3J13?Status:		Passed, Jan 89 X3J13Forum:          CleanupIssue:          CLOSED-STREAM-OPERATIONSReferences:     CLOSE (CLtL p 332)Category:       CLARIFICATIONEdit history:   26-Aug-88, Version 1 by Chapman                 8-Oct-88, Version 2 by Masinter                13-Oct-88, Version 3 by van Roggen                 1-Dec-88, Version 4 by Pitman                 5-Dec-88, Version 5 by Masinter (separate other issues)                 3-Feb-89, Version 6 by Masinter (as per Jan 89 X3J13)Related Issues: STREAM-ACCESS, STREAM-INFO, INPUT-STREAM-P-CLOSED,			CLOSE-CONSTRUCTED-STREAMS, PATHNAME-STREAM Problem Description:  The description of CLOSE is not completely clear about the functions which are allowed to be performed on a closed stream.  On p332 it says:  ``The stream is closed. No further Input/output operations may be    performed on it. However, certain inquiry operations may still    be performed, ...''  but the list of inquiry operations is not specified. Proposal (CLOSED-STREAM-FUNCTIONS:ALLOW-INQUIRY)  Clarify the behavior of the following functions on closed streams:  * STREAMP is unaffected by whether its stream argument is open or closed.   * CLOSE can be called on any stream, whether open or closed, and	will always return T.   * PATHNAME is valid on either an open or closed stream. Since some    implementations cannot provide the truename of a file until the    file is closed, it would in principle be possible for PATHNAME in    some implementations to return more specific information after the    stream is closed. For consistency, however, PATHNAME is prohibited    from doing this. PATHNAME must return the same pathname after a    file is closed as it did before. (The passed proposal in issue    PATHNAME-STREAM still stands.)   * TRUENAME is valid on either an open or closed stream. Since some    implementations cannot provide the truename of a file until the    file is closed, it is permissible TRUENAME to return more specific    information after the stream is closed.   * MERGE-PATHNAMES, PATHNAME-HOST, PATHNAME-DEVICE, PATHNAME-DIRECTORY,    PATHNAME-NAME, PATHNAME-TYPE, PATHNAME-VERSION, NAMESTRING,     FILE-NAMESTRING, DIRECTORY-NAMESTRING, HOST-NAMESTRING,     ENOUGH-NAMESTRING, and OPEN are valid on either open or closed streams.    For any of these operations, using a stream, S, as an argument     where appropriate is equivalent to using (PATHNAME s). See the    description of PATHNAME above to understand the consequences of this.   * PROBE-FILE and DIRECTORY are valid on either open or closed streams.    For either of these operations, using a stream, S, as an argument     where appropriate is equivalent to using (PATHNAME s). See the    description of PATHNAME above to understand the consequences of this.    In this case of these operators however, closed stream may well be the    most reliable arguments in some cases, since treatment of open streams    to the file system may vary considerably between implementations.    For example, in some operating systems, open files are written under    temporary names and not renamed until close and/or are held invisible    until a close is performed. In general, any code with an intent to be    highly portable should tread lightly when using PROBE-FILE or    DIRECTORY. Rationale:  One can consider many characteristics of a stream to be independent of the ability to do I/O.  Being able to determine a stream's direction and its name is often useful for debugging.  A number of the descriptions in CLtL imply (weakly) the ability to work on closed streams.  Functions such as OPEN and DIRECTORY don't really depend on the stream, but on the name of the stream. Current Practice:  At least two implementations differ in which functions are allowed to be performed on a closed stream. Cost to Implementors:  Unknown, but likely to be small in most implementations. A nontrivial amount of work may be necessary if the pathname information is held  externally and is normally deleted when the stream is closed.  The implementation will have to copy the information at some time for later inquiries.Cost to Users: Likely to be small; users of an implementation forced to change by this proposal might have to make some modifications to make their programs portable. Benefits:  These clarifications will assist users in writing portable code. Aesthetics:  Most people will probably see these clarifications as an improvement in aesthetics. Discussion: There are some separate, but related, issues regarding what CLOSE should do on composite streams or constructed streams such as created by MAKE-BROADCAST-STREAM. These issues will be addressed in a separate issue (CLOSE-CONSTRUCTED-STREAMS). There was some discussion on whether INPUT-STREAM-P and OUTPUT-STREAM-P should return "false" on a stream that had been closed. The issue STREAM-ACCESS contains a proposal to add a function OPEN-STREAM-P which might be useful for the same purpose. This issue was separated out into a separate issue (INPUT-STREAM-P-CLOSED). The other functions in proposal STREAM-ACCESS:PROVIDE should work on closed streams. The functions in STREAM-INFO:ONE-DIMENSIONAL-FUNCTIONS should not be requred to work on closed streams.     ----- End Forwarded Messages -----        TITAN 
          TITAN 
        ; -(TEXTFONT 7 (TIMESROMAN 12) NIL (CLASSIC 10))          ; -(TEXTFONT 7 (TIMESROMAN 12) NIL (CLASSIC 10))           b       .                                                              C              c             m       1      	                           m             *                     
       F              Z                    )      q  z*start*06134 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 03 FEB 89 22:43:42 PSTReceived: from Xerox.COM by SAIL.Stanford.EDU with TCP; 3 Feb 89  22:43:42 PSTReceived: from Semillon.ms by ArpaGateway.ms ; 03 FEB 89 22:42:11 PSTDate: 3 Feb 89 22:41 PSTFrom: masinter.paSubject: Issue: CLOSED-STREAM-OPERATIONS (Version 6)To: cl-cleanup@sail.stanford.educc: Masinter.paLine-fold: NOMessage-ID: <890203-224211-2829@Xerox>At the January meeting, my notes are only "amended to return Ton closed streams" without an exact wording change. This is the issue as reworded. Do you see any need to remailthis to X3J13?!Status:		Passed, Jan 89 X3J13Forum:          CleanupIssue:          CLOSED-STREAM-OPERATIONSReferences:     CLOSE (CLtL p 332)Category:       CLARIFICATIONEdit history:   26-Aug-88, Version 1 by Chapman                 8-Oct-88, Version 2 by Masinter                13-Oct-88, Version 3 by van Roggen                 1-Dec-88, Version 4 by Pitman                 5-Dec-88, Version 5 by Masinter (separate other issues)                 3-Feb-89, Version 6 by Masinter (as per Jan 89 X3J13)Related Issues: STREAM-ACCESS, STREAM-INFO, INPUT-STREAM-P-CLOSED,			CLOSE-CONSTRUCTED-STREAMS, PATHNAME-STREAM Problem Description:  The description of CLOSE is not completely clear about the functions which are allowed to be performed on a closed stream.  On p332 it says:  ``The stream is closed. No further Input/output operations may be    performed on it. However, certain inquiry operations may still    be performed, ...''  but the list of inquiry operations is not specified. Proposal (CLOSED-STREAM-FUNCTIONS:ALLOW-INQUIRY)  Clarify the behavior of the following functions on closed streams:  * STREAMP is unaffected by whether its stream argument is open or closed.   * CLOSE can be called on any stream, whether open or closed, and	will always return T.   * PATHNAME is valid on either an open or closed stream. Since some    implementations cannot provide the truename of a file until the    file is closed, it would in principle be possible for PATHNAME in    some implementations to return more specific information after the    stream is closed. For consistency, however, PATHNAME is prohibited    from doing this. PATHNAME must return the same pathname after a    file is closed as it did before. (The passed proposal in issue    PATHNAME-STREAM still stands.)   * TRUENAME is valid on either an open or closed stream. Since some    implementations cannot provide the truename of a file until the    file is closed, it is permissible TRUENAME to return more specific    information after the stream is closed.   * MERGE-PATHNAMES, PATHNAME-HOST, PATHNAME-DEVICE, PATHNAME-DIRECTORY,    PATHNAME-NAME, PATHNAME-TYPE, PATHNAME-VERSION, NAMESTRING,     FILE-NAMESTRING, DIRECTORY-NAMESTRING, HOST-NAMESTRING,     ENOUGH-NAMESTRING, and OPEN are valid on either open or closed streams.    For any of these operations, using a stream, S, as an argument     where appropriate is equivalent to using (PATHNAME s). See the    description of PATHNAME above to understand the consequences of this.   * PROBE-FILE and DIRECTORY are valid on either open or closed streams.    For either of these operations, using a stream, S, as an argument     where appropriate is equivalent to using (PATHNAME s). See the    description of PATHNAME above to understand the consequences of this.    In this case of these operators however, closed stream may well be the    most reliable arguments in some cases, since treatment of open streams    to the file system may vary considerably between implementations.    For example, in some operating systems, open files are written under    temporary names and not renamed until close and/or are held invisible    until a close is performed. In general, any code with an intent to be    highly portable should tread lightly when using PROBE-FILE or    DIRECTORY. Rationale:  One can consider many characteristics of a stream to be independent of the ability to do I/O.  Being able to determine a stream's direction and its name is often useful for debugging.  A number of the descriptions in CLtL imply (weakly) the ability to work on closed streams.  Functions such as OPEN and DIRECTORY don't really depend on the stream, but on the name of the stream. Current Practice:  At least two implementations differ in which functions are allowed to be performed on a closed stream. Cost to Implementors:  Unknown, but likely to be small in most implementations. A nontrivial amount of work may be necessary if the pathname information is held  externally and is normally deleted when the stream is closed.  The implementation will have to copy the information at some time for later inquiries.Cost to Users: Likely to be small; users of an implementation forced to change by this proposal might have to make some modifications to make their programs portable. Benefits:  These clarifications will assist users in writing portable code. Aesthetics:  Most people will probably see these clarifications as an improvement in aesthetics. Discussion: There are some separate, but related, issues regarding what CLOSE should do on composite streams or constructed streams such as created by MAKE-BROADCAST-STREAM. These issues will be addressed in a separate issue (CLOSE-CONSTRUCTED-STREAMS). There was some discussion on whether INPUT-STREAM-P and OUTPUT-STREAM-P should return "false" on a stream that had been closed. The issue STREAM-ACCESS contains a proposal to add a function OPEN-STREAM-P which might be useful for the same purpose. This issue was separated out into a separate issue (INPUT-STREAM-P-CLOSED). The other functions in proposal STREAM-ACCESS:PROVIDE should work on closed streams. The functions in STREAM-INFO:ONE-DIMENSIONAL-FUNCTIONS should not be requred to work on closed streams.     ----- End Forwarded Messages -----*start*00862 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 03 FEB 89 22:57:11 PSTReceived: from Xerox.COM by SAIL.Stanford.EDU with TCP; 3 Feb 89  22:57:33 PSTReceived: from Semillon.ms by ArpaGateway.ms ; 03 FEB 89 22:56:02 PSTDate: 3 Feb 89 22:55 PSTFrom: masinter.paSubject: Re: Issue: CLOSED-STREAM-OPERATIONS (Version 6)In-reply-to: masinter.pa's message of 3 Feb 89 22:41 PSTTo: cl-cleanup@sail.stanford.edu, maida@ibm.comMessage-ID: <890203-225602-2835@Xerox>One reason to send it out to X3J13 is to arbitrate on our notes. I noticethat Moon's notes say "Accepted with amendment that CLOSE of a closedstream returns NIL".Mary (or anyone else): do you have a record of the amendment & vote onissue CLOSED-STREAM-OPERATIONS?*start*01282 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 06 FEB 89 08:50:48 PSTReceived: from Think.COM by SAIL.Stanford.EDU with TCP; 6 Feb 89  08:50:55 PSTReceived: from fafnir.think.com by Think.COM; Mon, 6 Feb 89 11:37:49 ESTReturn-Path: <gls@Think.COM>Received: from verdi.think.com by fafnir.think.com; Mon, 6 Feb 89 11:46:23 ESTReceived: by verdi.think.com; Mon, 6 Feb 89 11:45:54 ESTDate: Mon, 6 Feb 89 11:45:54 ESTFrom: Guy Steele <gls@Think.COM>Message-Id: <8902061645.AA27985@verdi.think.com>To: masinter.paCc: cl-cleanup@sail.stanford.edu, maida@ibm.comIn-Reply-To: masinter.pa@xerox.com's message of 3 Feb 89 22:55 PST <890203-225602-2835@Xerox>Subject: Issue: CLOSED-STREAM-OPERATIONS (Version 6)   Date: 3 Feb 89 22:55 PST   From: masinter.pa@xerox.com   One reason to send it out to X3J13 is to arbitrate on our notes. I notice   that Moon's notes say "Accepted with amendment that CLOSE of a closed   stream returns NIL".   Mary (or anyone else): do you have a record of the amendment & vote on   issue CLOSED-STREAM-OPERATIONS?For what it is worth, my notes say "amended that CLOSE of a closedstream return NIL."--Guy*start*01374 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 06 FEB 89 09:03:03 PSTReceived: from STONY-BROOK.SCRC.Symbolics.COM (SCRC-STONY-BROOK.ARPA) by SAIL.Stanford.EDU with TCP; 6 Feb 89  09:02:13 PSTReceived: from EUPHRATES.SCRC.Symbolics.COM by STONY-BROOK.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 534092; Mon 6-Feb-89 11:57:44 ESTDate: Mon, 6 Feb 89 11:58 ESTFrom: David A. Moon <Moon@STONY-BROOK.SCRC.Symbolics.COM>Subject: Re: Issue: CLOSED-STREAM-OPERATIONS (Version 6)To: masinter.pacc: cl-cleanup@SAIL.STANFORD.EDU, maida@ibm.comIn-Reply-To: <890203-225602-2835@Xerox>Message-ID: <19890206165817.6.MOON@EUPHRATES.SCRC.Symbolics.COM>Line-fold: No    Date: 3 Feb 89 22:55 PST    From: masinter.pa@Xerox.COM    One reason to send it out to X3J13 is to arbitrate on our notes. I notice    that Moon's notes say "Accepted with amendment that CLOSE of a closed    stream returns NIL".I rechecked my original handwritten notes and they really do say that CLOSEof a closed stream returns NIL rather than T.  However, I don't care at allwhich it returns, and it may be that I wrote down the amendment incorrectly.    Mary (or anyone else): do you have a record of the amendment & vote on    issue CLOSED-STREAM-OPERATIONS?*start*02330 00024 US Return-Path: <KMP@STONY-BROOK.SCRC.Symbolics.COM>Received: from STONY-BROOK.SCRC.Symbolics.COM ([128.81.41.144]) by Xerox.COM ; 06 FEB 89 10:12:19 PSTReceived: from BOBOLINK.SCRC.Symbolics.COM by STONY-BROOK.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 534168; Mon 6-Feb-89 13:11:33 ESTDate: Mon, 6 Feb 89 13:11 ESTFrom: Kent M Pitman <KMP@STONY-BROOK.SCRC.Symbolics.COM>Subject: Issue: CLOSED-STREAM-OPERATIONS (Version 6)To: Masinter.PA, gls@Think.COMcc: cl-cleanup@sail.stanford.edu, maida@ibm.comIn-Reply-To: <8902061645.AA27985@verdi.think.com>Message-ID: <890206131107.0.KMP@BOBOLINK.SCRC.Symbolics.COM>    Date: Mon, 6 Feb 89 11:45:54 EST    From: Guy Steele <gls@Think.COM>       Date: 3 Feb 89 22:55 PST       From: masinter.pa@xerox.com       One reason to send it out to X3J13 is to arbitrate on our notes. I notice       that Moon's notes say "Accepted with amendment that CLOSE of a closed       stream returns NIL".       Mary (or anyone else): do you have a record of the amendment & vote on       issue CLOSED-STREAM-OPERATIONS?    For what it is worth, my notes say "amended that CLOSE of a closed    stream return NIL."    --GuyPersonally, I think this is -awful-. I think one ought not be able to dependon the result in this case because implementations might reasonably differabout whether the first CLOSE really closed the stream. As such, (LIST (CLOSE *TERMINAL-IO*) (CLOSE *TERMINAL-IO*))might reasonably return (T T) or (T NIL), for example, depending on whetherthe implementation represents the concept of `open-ness' for all streams.The same is true for string streams.The issue is even weirder for composite (eg, broadcast) streams where somestreams are initially open and others are not, since I think we have no clear theory of whether such a stream is opened or closed.I strongly suggest we consider reverting this decision in favor of eitherthe proposal as drafted, or some decision which is consistent with the modelI've cited above, or else that we bundle this stuff in with the issue whichis discussing the OPEN-STREAM-P operation since the issues are intimately related. It's my understanding that that issue is now called INPUT-STREAM-P-CLOSED and that there is no proposal written. Please correctme if that's not so.*start*06598 00024 US Return-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 14 FEB 89 16:36:56 PSTReceived: from Xerox.COM by SAIL.Stanford.EDU with TCP; 14 Feb 89  16:35:58 PSTReceived: from Semillon.ms by ArpaGateway.ms ; 14 FEB 89 16:22:17 PSTDate: 14 Feb 89 16:21 PSTFrom: masinter.paSubject: Issue: CLOSED-STREAM-OPERATIONS (Version 7)To: cl-cleanup@sail.stanford.eduLine-fold: NOMessage-ID: <890214-162217-10951@Xerox>I'm sorry for introducing version 6, which was incorrect.I believe this is closer to the wording we voted on.KMP points out that this may have been a bad amendment,which is separate from the issue of whether we've accuratelyreflected what was voted on. If the amendment is wrong, we could vote to reconsider &revoke the amendment. I'm not swayed strongly enough byKent's arguments to bring this issue up again myself,however.!Status:		Passed, as amended, Jan 89 X3J13Forum:          CleanupIssue:          CLOSED-STREAM-OPERATIONSReferences:     CLOSE (CLtL p 332)Category:       CLARIFICATIONEdit history:   26-Aug-88, Version 1 by Chapman                 8-Oct-88, Version 2 by Masinter                13-Oct-88, Version 3 by van Roggen                 1-Dec-88, Version 4 by Pitman                 5-Dec-88, Version 5 by Masinter (separate other issues)                 3-Feb-89, Version 6 by Masinter (as per Jan 89 X3J13)                 14-Feb-89, Version 7 by Masinter (correct error in 6)Related Issues: STREAM-ACCESS, STREAM-INFO, INPUT-STREAM-P-CLOSED,			CLOSE-CONSTRUCTED-STREAMS, PATHNAME-STREAM Problem Description:  The description of CLOSE is not completely clear about the functions which are allowed to be performed on a closed stream.  On p332 it says:  ``The stream is closed. No further Input/output operations may be    performed on it. However, certain inquiry operations may still    be performed, ...''  but the list of inquiry operations is not specified. Proposal (CLOSED-STREAM-FUNCTIONS:ALLOW-INQUIRY)  Clarify the behavior of the following functions on closed streams:  * STREAMP is unaffected by whether its stream argument is open or closed.   * If CLOSE is called on a stream which is open, it will return T.    However, if CLOSE is called on a stream which is closed, it    will succeed with out error but the return value will be NIL.   * PATHNAME is valid on either an open or closed stream. Since some    implementations cannot provide the truename of a file until the    file is closed, it would in principle be possible for PATHNAME in    some implementations to return more specific information after the    stream is closed. For consistency, however, PATHNAME is prohibited    from doing this. PATHNAME must return the same pathname after a    file is closed as it did before. (The passed proposal in issue    PATHNAME-STREAM still stands.)   * TRUENAME is valid on either an open or closed stream. Since some    implementations cannot provide the truename of a file until the    file is closed, it is permissible TRUENAME to return more specific    information after the stream is closed.   * MERGE-PATHNAMES, PATHNAME-HOST, PATHNAME-DEVICE, PATHNAME-DIRECTORY,    PATHNAME-NAME, PATHNAME-TYPE, PATHNAME-VERSION, NAMESTRING,     FILE-NAMESTRING, DIRECTORY-NAMESTRING, HOST-NAMESTRING,     ENOUGH-NAMESTRING, and OPEN are valid on either open or closed streams.    For any of these operations, using a stream, S, as an argument     where appropriate is equivalent to using (PATHNAME s). See the    description of PATHNAME above to understand the consequences of this.   * PROBE-FILE and DIRECTORY are valid on either open or closed streams.    For either of these operations, using a stream, S, as an argument     where appropriate is equivalent to using (PATHNAME s). See the    description of PATHNAME above to understand the consequences of this.    In this case of these operators however, closed stream may well be the    most reliable arguments in some cases, since treatment of open streams    to the file system may vary considerably between implementations.    For example, in some operating systems, open files are written under    temporary names and not renamed until close and/or are held invisible    until a close is performed. In general, any code with an intent to be    highly portable should tread lightly when using PROBE-FILE or    DIRECTORY. Rationale:  One can consider many characteristics of a stream to be independent of the ability to do I/O.  Being able to determine a stream's direction and its name is often useful for debugging.  A number of the descriptions in CLtL imply (weakly) the ability to work on closed streams.  Functions such as OPEN and DIRECTORY don't really depend on the stream, but on the name of the stream. Current Practice:  At least two implementations differ in which functions are allowed to be performed on a closed stream. Cost to Implementors:  Unknown, but likely to be small in most implementations. A nontrivial amount of work may be necessary if the pathname information is held  externally and is normally deleted when the stream is closed.  The implementation will have to copy the information at some time for later inquiries.Cost to Users: Likely to be small; users of an implementation forced to change by this proposal might have to make some modifications to make their programs portable. Benefits:  These clarifications will assist users in writing portable code. Aesthetics:  Most people will probably see these clarifications as an improvement in aesthetics. Discussion: There are some separate, but related, issues regarding what CLOSE should do on composite streams or constructed streams such as created by MAKE-BROADCAST-STREAM. These issues will be addressed in a separate issue (CLOSE-CONSTRUCTED-STREAMS). There was some discussion on whether INPUT-STREAM-P and OUTPUT-STREAM-P should return "false" on a stream that had been closed. The issue STREAM-ACCESS contains a proposal to add a function OPEN-STREAM-P which might be useful for the same purpose. This issue was separated out into a separate issue (INPUT-STREAM-P-CLOSED). The other functions in proposal STREAM-ACCESS:PROVIDE should work on closed streams. The functions in STREAM-INFO:ONE-DIMENSIONAL-FUNCTIONS should not be requred to work on closed streams.     ----- End Forwarded Messages -----     ----- End Forwarded Messages -----*start*02503 00024 US Return-Path: <KMP@STONY-BROOK.SCRC.Symbolics.COM>Received: from STONY-BROOK.SCRC.Symbolics.COM ([128.81.41.144]) by Xerox.COM ; 15 FEB 89 07:04:19 PSTReceived: from BOBOLINK.SCRC.Symbolics.COM by STONY-BROOK.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 539477; Wed 15-Feb-89 10:03:58 ESTDate: Wed, 15 Feb 89 10:03 ESTFrom: Kent M Pitman <KMP@STONY-BROOK.SCRC.Symbolics.COM>Subject: Issue: CLOSED-STREAM-OPERATIONS (Version 7)To: masinter.pacc: cl-cleanup@sail.stanford.eduIn-Reply-To: <890214-162217-10951@Xerox>Message-ID: <890215100339.3.KMP@BOBOLINK.SCRC.Symbolics.COM>What's weird about this whole thing is that CLOSE-CONSTRUCTED-STREAMtalks about the effect of most operations being `unspecified' afterclose. Unless you intend it to be an implication of CLOSE-CONSTRUCTED-STREAMthat you actually carry a CLOSED-P bit around in every stream so youcan tell if the stream is open or not and return the right value fromCLOSE, then it's a bad idea to legislate that CLOSE returns a certainvalue, because you can't really guarantee that value.If you do intend me to carry around a CLOSED-P bit, why bother toclaim that the effect of I/O to the stream after it's closed is `unspecified.' My assumption before was that it was unspecified incase I want to define it, but suddenly it sounds like I'm not reallyallowed to extend it -- I'm just permitted to optimize out the errorchecks for the sake of efficiency. If this is so, why not just put itin the domain of `should signal' so that at least the users could getsome mileage out of it because my implementation pretty much has itshands tied at this point.We get calls all the time from users who claim we're in violation ofthings that really CLtL leaves vague. This will be such a thing giventhe way it's all worded.Here I am implementing CLOSE. I -really- want to implement it correctly.I am willing to do anything necessary to make it return the right valueas long as what I do is something that is backed up in writing.Here you are designing CL -- creating the writing that will back me up.If you cannot show me how to write CLOSE in a way so that I can simplypoint to a sentence in the manual that explains off my behavior wheneveranyone complains so I can get them off the phone and get back to work,then you owe me a sentence in the manual that says that I'm entitled todo whatever I feel like and the user cannot depend on it.False security is worse than no security at all.*start*04858 00024 US GV-Info: X3J13-mailer@SAIL.Stanford.EDU at 16-Mar-89 11:08:05 from AGReturn-Path: <X3J13-mailer@SAIL.Stanford.EDU>Received: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 16 MAR 89 10:59:40 PSTReceived: from Xerox.COM by SAIL.Stanford.EDU with TCP; 16 Mar 89  10:44:15 PSTReceived: from Semillon.ms by ArpaGateway.ms ; 16 MAR 89 09:51:25 PSTDate: 16 Mar 89 09:43 PSTFrom: masinter.paSubject: Issue: CLOSED-STREAM-OPERATION (Version 7) To: x3j13@sail.stanford.eduline-fold: NOMessage-ID: <890316-095125-4330@Xerox>Version 5 of issue CLOSED-STREAM-OPERATION was brought up atthe January 1989 meeting.The proposal CLOSED-STREAM-FUNCTIONS:ALLOW-INQUIRY was amended atthat meeting; the amended version passed.Version 5 said "If CLOSE is called on a stream which is open, it will return T.    However, if CLOSE is called on a stream which is closed, it    will succeed without error but the return value is not specified."The amendment was to change the wording so that CLOSE wouldreturn NIL if given a closed stream, viz: " If CLOSE is called on a stream which is open, it will return T.    However, if CLOSE is called on a stream which is closed, it    will succeed with out error but the return value will be NIL."Kent Pitman has made an argument that the amendmentwas ill-considered.I find his argument convincing.I think procedurally we can vote to reconsider &revoke the amendment, i.e., revert to Version 5.Excerpts from the discussion:Return-Path: <KMP@STONY-BROOK.SCRC.Symbolics.COM>Received: from STONY-BROOK.SCRC.Symbolics.COM ([128.81.41.144]) by Xerox.COM ; 06 FEB 89 10:12:19 PSTReceived: from BOBOLINK.SCRC.Symbolics.COM by STONY-BROOK.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 534168; Mon 6-Feb-89 13:11:33 ESTDate: Mon, 6 Feb 89 13:11 ESTFrom: Kent M Pitman <KMP@STONY-BROOK.SCRC.Symbolics.COM>...I think one ought not be able to dependon the result in this case [of CLOSE of a closed stream] because implementations might reasonably differabout whether the first CLOSE really closed the stream. As such, (LIST (CLOSE *TERMINAL-IO*) (CLOSE *TERMINAL-IO*))might reasonably return (T T) or (T NIL), for example, depending on whetherthe implementation represents the concept of `open-ness' for all streams.The same is true for string streams.The issue is even weirder for composite (eg, broadcast) streams where somestreams are initially open and others are not, since I think we have no clear theory of whether such a stream is opened or closed....Return-Path: <KMP@STONY-BROOK.SCRC.Symbolics.COM>Received: from STONY-BROOK.SCRC.Symbolics.COM ([128.81.41.144]) by Xerox.COM ; 15 FEB 89 07:04:19 PSTReceived: from BOBOLINK.SCRC.Symbolics.COM by STONY-BROOK.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 539477; Wed 15-Feb-89 10:03:58 ESTDate: Wed, 15 Feb 89 10:03 ESTFrom: Kent M Pitman <KMP@STONY-BROOK.SCRC.Symbolics.COM>What's weird about this whole thing is that CLOSE-CONSTRUCTED-STREAMtalks about the effect of most operations being `unspecified' afterCLOSE. Unless you intend it to be an implication of CLOSE-CONSTRUCTED-STREAMthat you actually carry a CLOSED-P bit around in every stream so youcan tell if the stream is open or not and return the right value fromCLOSE, then it's a bad idea to legislate that CLOSE returns a certainvalue, because you can't really guarantee that value.If you do intend me to carry around a CLOSED-P bit, why bother toclaim that the effect of I/O to the stream after it's closed is `unspecified.' My assumption before was that it was unspecified incase I want to define it, but suddenly it sounds like I'm not reallyallowed to extend it -- I'm just permitted to optimize out the errorchecks for the sake of efficiency. If this is so, why not just put itin the domain of `should signal' so that at least the users could getsome mileage out of it because my implementation pretty much has itshands tied at this point.We get calls all the time from users who claim we're in violation ofthings that really CLtL leaves vague. This will be such a thing giventhe way it's all worded.Here I am implementing CLOSE. I -really- want to implement it correctly.I am willing to do anything necessary to make it return the right valueas long as what I do is something that is backed up in writing.Here you are designing CL -- creating the writing that will back me up.If you cannot show me how to write CLOSE in a way so that I can simplypoint to a sentence in the manual that explains off my behavior wheneveranyone complains so I can get them off the phone and get back to work,then you owe me a sentence in the manual that says that I'm entitled todo whatever I feel like and the user cannot depend on it.False security is worse than no security at all.End of message*start*01447 00024 US Date:  4 Apr 89 08:11 PDTSender: CL-Cleanup-mailer%SAIL.Stanford:EDU:XeroxFrom: KMP%STONY-BROOK.SCRC.Symbolics:COM:XeroxSubject: Issue: CLOSED-STREAM-OPERATIONSTo: CL-Cleanup%SAIL.Stanford:EDU:XeroxGVGVGVGVGVGVGVGVGVGVGVGVGVGVGVGVGVGVGVGVGVGVGVGVGVFrom: Kent M Pitman <KMP@STONY-BROOK.SCRC.Symbolics.COM>Subject: Issue: CLOSED-STREAM-OPERATIONSTo: CL-Cleanup@SAIL.Stanford.EDUReturn-Path: <CL-Cleanup-mailer@SAIL.Stanford.EDU>Redistributed: xerox-cl-cleanup^.paReceived: from SAIL.Stanford.EDU ([36.86.0.194]) by Xerox.COM ; 04 APR 89 08:10:32 PDTReceived: from STONY-BROOK.SCRC.Symbolics.COM by SAIL.Stanford.EDU with TCP; 4 Apr 89  08:09:00 PDTReceived: from BOBOLINK.SCRC.Symbolics.COM by STONY-BROOK.SCRC.Symbolics.COM via CHAOS with CHAOS-MAIL id 570864; Tue 4-Apr-89 11:09:01 EDTOriginal-Date: Tue, 4 Apr 89 11:08 EDTMessage-ID: <890404110837.3.KMP@BOBOLINK.SCRC.Symbolics.COM>GVGVGVGVGVGVGVGVGVGVGVGVGVGVGVGVGVGVGVGVGVGVGVGVGVMy notes say... A motion to reconsider this issue passed N-2. A motion to revoke version 7 and replace it with version 5 was made.  Walter van Roggen proposed we amend it to make all CLOSE return values  unspecified.  The motion to amend failed on a 3-4-N vote.  A recount was requested because people aren't permitted to abstain on  technical issues.  The motion still failed on a 6-8 vote. The original motion (to replace v7 with v5) passed unamended 12-0.